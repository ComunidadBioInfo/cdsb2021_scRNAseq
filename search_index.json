[["index.html", "An√°lisis de datos transcript√≥micos de c√©lula √∫nica (scRNA-seq) con R y Bioconductor Informaci√≥n del taller Formato del curso: en l√≠nea ¬øQui√©n es nuestra audiencia? Formulario de registro Instructores Ponentes e instructores invitados Ayudantes Temario C√≥digo de Conducta Pre-requisitos Horario M√∫sica para ejercicios Materiales Zoom Organizadores Patrocinadores Informaci√≥n sesi√≥n de R Licencia", " An√°lisis de datos transcript√≥micos de c√©lula √∫nica (scRNA-seq) con R y Bioconductor Leonardo Collado-Torres Lieber Institute for Brain Development, Johns Hopkins Medical Campus Informaci√≥n del taller 9-13 de agosto de 2021 ¬°Bienvenidxs al taller An√°lisis de datos transcript√≥micos de c√©lula √∫nica (scRNA-seq) con R y Bioconductor! En los √∫ltimos a√±os, la generaci√≥n y an√°lisis de transcriptomas de c√©lula √∫nica ha cobrado gran importancia para resolver preguntas biol√≥gicas. En este taller revisaremos los m√©todos m√°s recientes para analizar datos de single cell RNA-seq (transcript√≥mica en c√©lulas √∫nicas), usando paquetes de R especializados que est√°n disponibles libremente v√≠a Bioconductor. Este taller estar√° basado en el libro Orchestrating Single Cell Analysis with Bioconductor que fue publicado en Nature Methods y es de los art√≠culos con mayor publicidad en 2020 y 2021. Durante este taller aprender√°s las herramientas estad√≠sticas para analizar datos de transcript√≥mica en c√©lulas √∫nicas usando Bioconductor. Revisaremos qu√© es un an√°lisis de datos de c√©lula √∫nica, cu√°les son las principales diferencias entre el an√°lisis de transcriptomas de c√©lula √∫nica y en bulk, c√≥mo documentar tu an√°lisis y algunas herramientas para interpretar tus resultados. Formato del curso: en l√≠nea Este es un curso digital. Las sesiones y material del curso ser√°n presentados en l√≠nea. Esta modalidad incluir√° grabaciones de video o audio del material, intercambio de archivos y sesiones de discusi√≥n tem√°ticos, ejercicios de auto-evaluaci√≥n y acceso a los instructores para comentarios durante el curso. ¬øQui√©n es nuestra audiencia? Este curso est√° dirigido a personas que desean aprender c√≥mo analizar datos transcript√≥micos de c√©lula √∫nica usando paquetes de R/Bioconductor. Revisa los videos de CDSB2020 en YouTube o la p√°gina web de cdsb2020, que es similar al taller de este a√±o. Formulario de registro http://congresos.nnb.unam.mx/EBM2021/ Do you want to learn how to analyze #scRNAseq with @Bioconductor?Learn with @lcolladotor@yalbi_ibm @AnaBetty2304 @argininaa @naielisha @lawrah20 @roramirezf94 @jvelezmagic @KevsGenomic @mpadilla905Material adapted from OSCA @PeteHaitch et al#rstatshttps://t.co/MIfFmKt3Fq pic.twitter.com/nSPCmVEPAC ‚Äî ComunidadBioInfo (@CDSBMexico) July 2, 2021 Instructores Leonardo Collado-Torres Yalbi Balderas https://comunidadbioinfo.github.io/es/#people Ponentes e instructores invitados Ana Beatriz Villase√±or Altamirano Citlali Gil Aguillon Elisa M√°rquez Zavala Laura Lucila G√≥mez Romero Ricardo Ramirez Flores Ayudantes Jes√∫s V√©lez Santiago Kevin Emmanuel Meza Landeros M√≥nica Padilla G√°lvez Temario D√≠a 1 Introducci√≥n a R y RStudio Ejercicio usando usethis, here y postcards Introducci√≥n a RNA-seq de c√©lula √∫nica (scRNA-seq) con Bioconductor y al libro de OSCA D√≠a 2 Estructura e importe de datos Comunidades RLadies Control de calidad D√≠a 3 Normalizaci√≥n de datos Foto y actividades de la comunidad Selecci√≥n de genes D√≠a 4 Reducci√≥n de dimensiones Clustering Identificaci√≥n de genes marcadores D√≠a 5 Anotaci√≥n de clusters de c√©lulas An√°lisis de expresi√≥n diferencial Pl√°tica cient√≠fica del ponente invitadx C√≥digo de Conducta Seguiremos el c√≥digo de conducta de la CDSB M√©xico comunidadbioinfo.github.io/es/codigo-de-conducta/ adem√°s del c√≥digo de conducta de Bioconductor bioconductor.org/about/code-of-conduct/. Pre-requisitos De forma general, Computadora con al menos 8Gb de memoria y permisos de administrador para instalar paqueter√≠as de R. Tener instalado R y RStudio en su √∫ltima versi√≥n. Conocimientos b√°sicos de secuenciaci√≥n de transcriptomas. Conocimientos b√°sicos de RStudio (Creaci√≥n de Rscripts, manejo de la consola de RStudio, manejo del espacio de visualizaci√≥n). Conocimiento intermedio de R (Manejo de variables, lectura de archivos, creaci√≥n y manejo de data frames y listas, generaci√≥n de gr√°ficas b√°sicas, conocimiento sobre c√≥mo instalar paqueter√≠as desde CRAN y Bioconductor). M√°s espec√≠ficamente, computadora con al menos 8 GB de memoria RAM, aplicaci√≥n Zoom https://zoom.us/download, R versi√≥n 4.1 instalada de CRAN https://cran.r-project.org/ (ver video de https://youtu.be/6knyHlUe1cM sobre como instalar R en macOS o winOS), RStudio versi√≥n 1.4 https://www.rstudio.com/products/rstudio/download/#download, y los siguientes paquetes de R y Bioconductor: ## Para instalar paquetes if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) { install.packages(&quot;remotes&quot;) } ## Para instalar paquetes de Bioconductor remotes::install_cran(&quot;BiocManager&quot;) BiocManager::version() # El anterior comando debe mostrar que est√°s usando la versi√≥n 3.13 ## Instala los paquetes de R que necesitamos ## BiocManager::install(c(&quot;batchelor&quot;, &quot;BiocFileCache&quot;, &quot;BiocSingular&quot;, &quot;bluster&quot;, &quot;celldex&quot;, &quot;clusterExperiment&quot;, &quot;cowplot&quot;, &quot;dplyr&quot;, &quot;DropletUtils&quot;, &quot;EnsDb.Hsapiens.v86&quot;, &quot;ExperimentHub&quot;, &quot;fossil&quot;, &quot;gert&quot;, &quot;gh&quot;, &quot;here&quot;, &quot;iSEE&quot;, &quot;kableExtra&quot;, &quot;org.Mm.eg.db&quot;, &quot;patchwork&quot;, &quot;PCAtools&quot;, &quot;pheatmap&quot;, &quot;plotly&quot;, &quot;postcards&quot;, &quot;pryr&quot;, &quot;RColorBrewer&quot;, &quot;rsthemes&quot;, &quot;Rtsne&quot;, &quot;scater&quot;, &quot;scPipe&quot;, &quot;scran&quot;, &quot;scRNAseq&quot;, &quot;sessioninfo&quot;, &quot;Seurat&quot;, &quot;SingleCellExperiment&quot;, &quot;SingleR&quot;, &quot;suncalc&quot;, &quot;TENxPBMCData&quot;, &quot;usethis&quot;, &quot;uwot&quot;)) Horario Consulta el calendario de este curso en: http://bit.ly/calendarcdsb2021. Horario Tema Instructores D√≠a 1: Agosto 9, 2021 08:00-09:00 (opcional) Ayuda con instalaci√≥n de paquetes de R 09:00-09:30 Inauguraci√≥n EBM2021 Julio Collado Vides, Christian Sohlenkamp, Irma Mart√≠nez Flores, Shirley Alquicira Hern√°ndez 09:30-10:00 Bienvenida a la CDSB y revisi√≥n del c√≥digo de conducta Leonardo Collado-Torres 10:00-11:00 Introducci√≥n a R y RStudio Leonardo Collado-Torres 11:00-11:30 Descanso 11:30-14:00 Ejercicio usando usethis, here y postcards Citlali Gil Aguillon y Elisa M√°rquez Zavala 14:00-15:30 Descanso: comida 15:30-17:00 Introducci√≥n a RNA-seq de c√©lula √∫nica (scRNA-seq) con Bioconductor y al libro de OSCA Citlali Gil Aguillon y Elisa M√°rquez Zavala 17:00-18:00 (Invitada) Principios FAIR para software de investigaci√≥n Paula Andrea D√≠a 2: Agosto 10, 2021 08:00-09:00 (opcional) Ayuda con instalaci√≥n de paquetes de R 09:00-11:00 Estructura e importe de datos Citlali Gil Aguillon y Elisa M√°rquez Zavala 11:00-11:30 Descanso 11:30-12:00 Keynote: La comunidad R-Ladies Ana Beatriz Villase√±or Altamirano 12:00-14:00 Control de calidad Leonardo Collado-Torres 14:00-15:30 Descanso: comida 15:30-17:30 Control de calidad Leonardo Collado-Torres 17:30-18:00 (opcional) Interact√∫a con lxs instructores y ayudantes D√≠a 3: Agosto 11, 2021 08:00-09:00 (opcional) Ayuda con instalaci√≥n de paquetes de R 09:00-10:30 Normalizaci√≥n de datos Ana Beatriz Villase√±or Altamirano 10:30-11:00 Foto 11:00-11:30 Descanso 11:30-12:30 Selecci√≥n de genes Yalbi Balderas 12:30-14:00 Actividades para construir la comunidad Leonardo Collado-Torres 14:00-15:30 Descanso: comida 15:30-17:30 Selecci√≥n de genes Laura Lucila G√≥mez Romero 17:30-18:00 (opcional) Interact√∫a con lxs instructores y ayudantes D√≠a 4: Agosto 12, 2021 08:00-09:00 (opcional) Ayuda con instalaci√≥n de paquetes de R 09:00-11:00 Reducci√≥n de dimensiones Laura Lucila G√≥mez Romero 11:00-11:30 Descanso 11:30-14:00 Clustering Laura Lucila G√≥mez Romero 14:00-15:30 Descanso: comida 15:30-17:30 Identificaci√≥n de genes marcadores Yalbi Balderas 17:30-18:30 CDSB 2021: Evento social remoto D√≠a 5: Agosto 13, 2021 08:00-09:00 (opcional) Ayuda con instalaci√≥n de paquetes de R 09:00-10:30 Anotaci√≥n de clusters de c√©lulas Yalbi Balderas 10:30-11:00 Evaluaci√≥n del taller Irma Mart√≠nez Flores y Shirley Alquicira Hern√°ndez 11:00-11:30 Descanso 11:30-12:30 An√°lisis de expresi√≥n diferencial Leonardo Collado-Torres 12:30-14:00 Introducci√≥n a Seurat Kevin Emmanuel Meza Landeros 14:00-15:30 Descanso: comida 15:30-17:00 Pl√°tica cient√≠fica y sesi√≥n de preguntas Ricardo Ramirez Flores 17:00-17:30 Clausura y recordatorio de la CDSB 17:30-18:00 (opcional) Interact√∫a con lxs instructores y ayudantes M√∫sica para ejercicios Aqu√≠ est√°n las listas de canciones por si desean escuchar algo de m√∫sica mientras realizan ejercicios iTunes Spotify Materiales Descarga los materiales con usethis::use_course('comunidadbioinfo/cdsb2021_scRNAseq') o revisalos en l√≠nea v√≠a comunidadbioinfo.github.io/cdsb2021_scRNAseq. Zoom Las ligas de Zoom est√°n disponibles exclusivamente para lxs participantes de CDSB2021 v√≠a Slack. Te enviaremos una invitaci√≥n al correo electr√≥nico que usaste para registrate. Organizadores Comunidad de Desarrolladores de Software en Bioinform√°tica CDSB Red Mexicana de Bioinform√°tica RMB Nodo Nacional de Bioinform√°tica en la UNAM NNB-CCG Patrocinadores Agradecemos a nuestros patrocinadores: Informaci√≥n sesi√≥n de R Detalles de la sesi√≥n de R usada para crear este libro. El c√≥digo fuente est√° disponible v√≠a ComunidadBioInfo/cdsb2021_scRNAseq. options(width = 120) pkgs &lt;- installed.packages()[, &quot;Package&quot;] sessioninfo::session_info(pkgs, include_base = TRUE) ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## abind 1.4-5 2016-07-21 [1] RSPM (R 4.1.0) ## ade4 1.7-17 2021-06-17 [1] RSPM (R 4.1.0) ## annotate 1.70.0 2021-05-19 [1] Bioconductor ## AnnotationDbi 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter 1.16.0 2021-05-19 [1] Bioconductor ## AnnotationHub 3.0.1 2021-06-20 [1] Bioconductor ## AnVIL 1.4.1 2021-06-22 [2] Bioconductor ## ape 5.5 2021-04-25 [1] RSPM (R 4.1.0) ## askpass 1.1 2019-01-13 [2] RSPM (R 4.1.0) ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## backports 1.2.1 2020-12-09 [1] RSPM (R 4.1.0) ## base * 4.1.0 2021-07-29 [3] local ## base64enc 0.1-3 2015-07-28 [1] RSPM (R 4.1.0) ## batchelor 1.8.0 2021-05-19 [1] Bioconductor ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## benchmarkme 1.0.7 2021-03-21 [1] RSPM (R 4.1.0) ## benchmarkmeData 1.0.4 2020-04-23 [1] RSPM (R 4.1.0) ## BH 1.75.0-0 2021-01-11 [1] RSPM (R 4.1.0) ## Biobase 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocManager 1.30.16 2021-06-15 [1] RSPM (R 4.1.0) ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## BiocStyle 2.20.2 2021-06-17 [1] Bioconductor ## biocthis 1.2.0 2021-05-19 [1] Bioconductor ## BiocVersion 3.13.1 2021-03-19 [2] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## boot 1.3-28 2021-05-03 [3] CRAN (R 4.1.0) ## brew 1.0-6 2011-04-13 [2] RSPM (R 4.1.0) ## brio 1.1.2 2021-04-23 [2] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## Cairo 1.5-12.2 2020-07-07 [1] RSPM (R 4.1.0) ## callr 3.7.0 2021-04-20 [2] RSPM (R 4.1.0) ## caTools 1.18.2 2021-03-28 [1] RSPM (R 4.1.0) ## celldex 1.2.0 2021-05-20 [1] Bioconductor ## circlize 0.4.13 2021-06-09 [1] RSPM (R 4.1.0) ## class 7.3-19 2021-05-03 [3] CRAN (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## clipr 0.7.1 2020-10-08 [2] RSPM (R 4.1.0) ## clue 0.3-59 2021-04-16 [1] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## clusterExperiment 2.12.0 2021-05-19 [1] Bioconductor ## ClusterR 1.2.5 2021-05-21 [1] RSPM (R 4.1.0) ## codetools 0.2-18 2020-11-04 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## colourpicker 1.1.0 2020-09-14 [1] RSPM (R 4.1.0) ## commonmark 1.7 2018-12-01 [2] RSPM (R 4.1.0) ## compiler 4.1.0 2021-07-29 [3] local ## ComplexHeatmap 2.8.0 2021-05-19 [1] Bioconductor ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## cpp11 0.3.1 2021-06-25 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## credentials 1.3.1 2021-07-25 [2] RSPM (R 4.1.0) ## crosstalk 1.1.1 2021-01-12 [1] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## data.table 1.14.0 2021-02-21 [1] RSPM (R 4.1.0) ## datasets * 4.1.0 2021-07-29 [3] local ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## deldir 0.2-10 2021-02-16 [1] RSPM (R 4.1.0) ## DEoptimR 1.0-9 2021-05-24 [1] RSPM (R 4.1.0) ## desc 1.3.0 2021-03-05 [2] RSPM (R 4.1.0) ## devtools 2.4.2 2021-06-07 [2] RSPM (R 4.1.0) ## diffobj 0.3.4 2021-03-22 [2] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## docopt 0.7.1 2020-06-24 [2] RSPM (R 4.1.0) ## doParallel 1.0.16 2020-10-16 [1] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils 1.12.2 2021-07-22 [1] Bioconductor ## DT 0.18 2021-04-14 [1] RSPM (R 4.1.0) ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## EnsDb.Hsapiens.v86 2.99.0 2021-07-29 [1] Bioconductor ## ensembldb 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## ExperimentHub 2.0.0 2021-05-19 [1] Bioconductor ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## fitdistrplus 1.1-5 2021-05-28 [1] RSPM (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] RSPM (R 4.1.0) ## forcats 0.5.1 2021-01-27 [1] RSPM (R 4.1.0) ## foreach 1.5.1 2020-10-15 [1] RSPM (R 4.1.0) ## foreign 0.8-81 2020-12-22 [3] CRAN (R 4.1.0) ## formatR 1.11 2021-06-01 [1] RSPM (R 4.1.0) ## fossil 0.4.0 2020-03-23 [1] RSPM (R 4.1.0) ## fs 1.5.0 2020-07-31 [2] RSPM (R 4.1.0) ## futile.logger 1.4.3 2016-07-10 [1] RSPM (R 4.1.0) ## futile.options 1.0.1 2018-04-20 [1] RSPM (R 4.1.0) ## future 1.21.0 2020-12-10 [1] RSPM (R 4.1.0) ## future.apply 1.7.0 2021-01-04 [1] RSPM (R 4.1.0) ## genefilter 1.74.0 2021-05-19 [1] Bioconductor ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges 1.44.0 2021-05-19 [1] Bioconductor ## gert 1.3.1 2021-06-23 [2] RSPM (R 4.1.0) ## GetoptLong 1.0.5 2020-12-15 [1] RSPM (R 4.1.0) ## GGally 2.1.2 2021-06-21 [1] RSPM (R 4.1.0) ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] RSPM (R 4.1.0) ## ggridges 0.5.3 2021-01-08 [1] RSPM (R 4.1.0) ## gh 1.3.0 2021-04-30 [2] RSPM (R 4.1.0) ## gitcreds 0.1.1 2020-12-04 [2] RSPM (R 4.1.0) ## GlobalOptions 0.1.2 2020-06-10 [1] RSPM (R 4.1.0) ## globals 0.14.0 2020-11-22 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gmp 0.6-2 2021-01-07 [1] RSPM (R 4.1.0) ## goftest 1.2-2 2019-12-02 [1] RSPM (R 4.1.0) ## gplots 3.1.1 2020-11-28 [1] RSPM (R 4.1.0) ## graphics * 4.1.0 2021-07-29 [3] local ## grDevices * 4.1.0 2021-07-29 [3] local ## grid 4.1.0 2021-07-29 [3] local ## gridBase 0.4-7 2014-02-24 [1] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## gtools 3.9.2 2021-06-06 [1] RSPM (R 4.1.0) ## hash 2.2.6.1 2019-03-04 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## here 1.0.1 2020-12-13 [1] RSPM (R 4.1.0) ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## howmany 0.3-1 2012-06-01 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## htmlwidgets 1.5.3 2020-12-10 [1] RSPM (R 4.1.0) ## httpuv 1.6.1 2021-05-07 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## ica 1.0-2 2018-05-24 [1] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## ini 0.3.1 2018-05-20 [2] RSPM (R 4.1.0) ## interactiveDisplayBase 1.30.0 2021-05-19 [1] Bioconductor ## IRanges 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## iSEE 2.4.0 2021-05-19 [1] Bioconductor ## isoband 0.2.5 2021-07-13 [1] RSPM (R 4.1.0) ## iterators 1.0.13 2020-10-15 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## kableExtra 1.3.4 2021-02-20 [1] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## kernlab 0.9-29 2019-11-12 [1] RSPM (R 4.1.0) ## KernSmooth 2.23-20 2021-05-03 [3] CRAN (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## lambda.r 1.2.4 2019-09-18 [1] RSPM (R 4.1.0) ## later 1.2.0 2021-04-23 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## leiden 0.3.9 2021-07-27 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## listenv 0.8.0 2019-12-05 [1] RSPM (R 4.1.0) ## littler 0.3.13 2021-07-24 [2] RSPM (R 4.1.0) ## lmtest 0.9-38 2020-09-09 [1] RSPM (R 4.1.0) ## lobstr 1.1.1 2019-07-02 [1] RSPM (R 4.1.0) ## locfdr 1.1-8 2015-07-15 [1] RSPM (R 4.1.0) ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## lubridate 1.7.10 2021-02-26 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## maps 3.3.0 2018-04-03 [1] RSPM (R 4.1.0) ## markdown 1.1 2019-08-07 [2] RSPM (R 4.1.0) ## MASS 7.3-54 2021-05-03 [3] CRAN (R 4.1.0) ## Matrix 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## mbkmeans 1.8.0 2021-05-19 [1] Bioconductor ## mclust 5.4.7 2020-11-20 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## methods * 4.1.0 2021-07-29 [3] local ## mgcv 1.8-36 2021-06-01 [3] RSPM (R 4.1.0) ## mime 0.11 2021-06-23 [2] RSPM (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [1] RSPM (R 4.1.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## nlme 3.1-152 2021-02-04 [3] CRAN (R 4.1.0) ## NMF 0.23.0 2020-08-01 [1] RSPM (R 4.1.0) ## nnet 7.3-16 2021-05-03 [3] CRAN (R 4.1.0) ## openssl 1.4.4 2021-04-30 [2] RSPM (R 4.1.0) ## org.Hs.eg.db 3.13.0 2021-07-29 [1] Bioconductor ## org.Mm.eg.db 3.13.0 2021-07-29 [1] Bioconductor ## parallel 4.1.0 2021-07-29 [3] local ## parallelly 1.27.0 2021-07-19 [1] RSPM (R 4.1.0) ## patchwork 1.1.1 2020-12-17 [1] RSPM (R 4.1.0) ## pbapply 1.4-3 2020-08-18 [1] RSPM (R 4.1.0) ## PCAtools 2.4.0 2021-05-19 [1] Bioconductor ## pheatmap 1.0.12 2019-01-04 [1] RSPM (R 4.1.0) ## phylobase 0.8.10 2020-03-01 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pixmap 0.4-12 2021-01-29 [1] RSPM (R 4.1.0) ## pkgbuild 1.2.0 2020-12-15 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## pkgload 1.2.1 2021-04-06 [2] RSPM (R 4.1.0) ## pkgmaker 0.32.2 2020-10-20 [1] RSPM (R 4.1.0) ## plogr 0.2.0 2018-03-25 [1] RSPM (R 4.1.0) ## plotly 4.9.4.1 2021-06-18 [1] RSPM (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## polyclip 1.10-0 2019-03-14 [1] RSPM (R 4.1.0) ## postcards 0.2.2 2021-07-31 [1] RSPM (R 4.1.0) ## pracma 2.3.3 2021-01-23 [1] RSPM (R 4.1.0) ## praise 1.0.0 2015-08-11 [2] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## processx 3.5.2 2021-04-30 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## promises 1.2.0.1 2021-02-11 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## pryr 0.1.5 2021-07-26 [1] RSPM (R 4.1.0) ## ps 1.6.0 2021-02-28 [2] RSPM (R 4.1.0) ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.cache 0.15.0 2021-04-30 [1] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## RANN 2.6.1 2019-01-08 [1] RSPM (R 4.1.0) ## rapiclient 0.1.3 2020-01-17 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## rcmdcheck 1.3.3 2019-05-07 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RcppAnnoy 0.0.19 2021-07-30 [1] RSPM (R 4.1.0) ## RcppArmadillo 0.10.6.0.0 2021-07-16 [1] RSPM (R 4.1.0) ## RcppEigen 0.3.3.9.1 2020-12-17 [1] RSPM (R 4.1.0) ## RcppHNSW 0.3.0 2020-09-06 [1] RSPM (R 4.1.0) ## RcppProgress 0.4.2 2020-02-06 [1] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## registry 0.5-1 2019-03-05 [1] RSPM (R 4.1.0) ## rematch2 2.1.2 2020-05-01 [2] RSPM (R 4.1.0) ## remotes 2.4.0 2021-06-02 [1] RSPM (R 4.1.0) ## reshape 0.8.8 2018-10-23 [1] RSPM (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] RSPM (R 4.1.0) ## ResidualMatrix 1.2.0 2021-05-19 [1] Bioconductor ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## reticulate 1.20 2021-05-03 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## Rhtslib 1.24.0 2021-05-19 [1] Bioconductor ## rintrojs 0.3.0 2021-06-06 [1] RSPM (R 4.1.0) ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## rncl 0.8.4 2020-02-10 [1] RSPM (R 4.1.0) ## RNeXML 2.4.5 2020-06-18 [1] RSPM (R 4.1.0) ## rngtools 1.5 2020-01-23 [1] RSPM (R 4.1.0) ## robustbase 0.93-8 2021-06-02 [1] RSPM (R 4.1.0) ## ROCR 1.0-11 2020-05-02 [1] RSPM (R 4.1.0) ## roxygen2 7.1.1 2020-06-27 [2] RSPM (R 4.1.0) ## rpart 4.1-15 2019-04-12 [3] CRAN (R 4.1.0) ## rprojroot 2.0.2 2020-11-15 [2] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSpectra 0.16-0 2019-12-01 [1] RSPM (R 4.1.0) ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [2] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## rversions 2.1.1 2021-05-31 [2] RSPM (R 4.1.0) ## rvest 1.0.1 2021-07-26 [1] RSPM (R 4.1.0) ## S4Vectors 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater 1.20.1 2021-06-15 [1] Bioconductor ## scattermore 0.7 2020-11-24 [1] RSPM (R 4.1.0) ## scPipe 1.14.0 2021-05-19 [1] Bioconductor ## scran 1.20.1 2021-05-24 [1] Bioconductor ## scRNAseq 2.6.1 2021-05-25 [1] Bioconductor ## sctransform 0.3.2 2020-12-16 [1] RSPM (R 4.1.0) ## scuttle 1.2.1 2021-08-05 [1] Bioconductor ## selectr 0.4-2 2019-11-20 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## Seurat 4.0.3 2021-06-10 [1] RSPM (R 4.1.0) ## SeuratObject 4.0.2 2021-06-09 [1] RSPM (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] RSPM (R 4.1.0) ## shapefiles 0.7 2013-01-26 [1] RSPM (R 4.1.0) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.1.0) ## shinyAce 0.4.1 2019-09-24 [1] RSPM (R 4.1.0) ## shinydashboard 0.7.1 2018-10-17 [1] RSPM (R 4.1.0) ## shinyjs 2.0.0 2020-09-09 [1] RSPM (R 4.1.0) ## shinyWidgets 0.6.0 2021-03-15 [1] RSPM (R 4.1.0) ## SingleCellExperiment 1.14.1 2021-05-21 [1] Bioconductor ## SingleR 1.6.1 2021-05-20 [1] Bioconductor ## sitmo 2.0.1 2019-01-07 [1] RSPM (R 4.1.0) ## snow 0.4-3 2018-09-14 [1] RSPM (R 4.1.0) ## softImpute 1.4-1 2021-05-09 [1] RSPM (R 4.1.0) ## sourcetools 0.1.7 2018-04-25 [1] RSPM (R 4.1.0) ## sp 1.4-5 2021-01-10 [1] RSPM (R 4.1.0) ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## spatial 7.3-14 2021-05-03 [3] CRAN (R 4.1.0) ## spatstat.core 2.3-0 2021-07-16 [1] RSPM (R 4.1.0) ## spatstat.data 2.1-0 2021-03-21 [1] RSPM (R 4.1.0) ## spatstat.geom 2.2-2 2021-07-12 [1] RSPM (R 4.1.0) ## spatstat.sparse 2.0-0 2021-03-16 [1] RSPM (R 4.1.0) ## spatstat.utils 2.2-0 2021-06-14 [1] RSPM (R 4.1.0) ## splines 4.1.0 2021-07-29 [3] local ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stats * 4.1.0 2021-07-29 [3] local ## stats4 4.1.0 2021-07-29 [3] local ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## styler 1.5.1 2021-07-13 [1] RSPM (R 4.1.0) ## SummarizedExperiment 1.22.0 2021-05-19 [1] Bioconductor ## suncalc 0.5.0 2019-04-03 [1] RSPM (R 4.1.0) ## survival 3.2-11 2021-04-26 [3] CRAN (R 4.1.0) ## svglite 2.0.0 2021-02-20 [1] RSPM (R 4.1.0) ## sys 3.4 2020-07-23 [2] RSPM (R 4.1.0) ## systemfonts 1.0.2 2021-05-11 [1] RSPM (R 4.1.0) ## tcltk 4.1.0 2021-07-29 [3] local ## tensor 1.5 2012-05-05 [1] RSPM (R 4.1.0) ## TENxPBMCData 1.10.0 2021-05-20 [1] Bioconductor ## testthat 3.0.4 2021-07-01 [2] RSPM (R 4.1.0) ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyr 1.1.3 2021-03-03 [1] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## tinytex 0.33 2021-08-05 [1] RSPM (R 4.1.0) ## tools 4.1.0 2021-07-29 [3] local ## usethis 2.0.1 2021-02-10 [2] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## utils * 4.1.0 2021-07-29 [3] local ## uuid 0.1-4 2020-02-26 [1] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## waldo 0.2.5 2021-03-08 [2] RSPM (R 4.1.0) ## webshot 0.5.2 2019-11-22 [1] RSPM (R 4.1.0) ## whisker 0.4 2019-08-28 [2] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## xopen 1.0.0 2018-09-17 [2] RSPM (R 4.1.0) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zinbwave 1.14.1 2021-05-25 [1] Bioconductor ## zip 2.2.0 2021-05-31 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Fecha de la √∫ltima actualizaci√≥n de esta p√°gina: 2021-08-09 22:09:55. Licencia This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],["inauguraci√≥n-cdsb2021.html", "Inauguraci√≥n CDSB2021", " Inauguraci√≥n CDSB2021 "],["introducci√≥n-a-r-y-rstudio.html", "1 Introducci√≥n a R y RStudio 1.1 R 1.2 GitHub 1.3 RStudio 1.4 Material del curso 1.5 Detalles de la sesi√≥n de R Patrocinadores", " 1 Introducci√≥n a R y RStudio Instructor: Leonardo Collado Torres 1.1 R R: es gratis, de acceso libre, utilizado para muchos campos de trabajo, fuerte en la bioinform√°tica a trav√©s de Bioconductor Instalaci√≥n a trav√©s de CRAN: https://cran.r-project.org/ Para explorar que se puede hacer con R: R Weekly https://rweekly.org/ R Bloggers https://www.r-bloggers.com/ Twitter https://twitter.com/search?q=%23rstats&amp;src=typed_query Twitter en espa√±ol https://twitter.com/search?q=%23rstatsES&amp;src=typed_query TidyTuesday https://twitter.com/search?q=%23TidyTuesday&amp;src=typed_query DatosDeMiercoles https://twitter.com/search?q=%23datosdemiercoles&amp;src=typed_query Para pedir ayuda hay muchas opciones https://lcolladotor.github.io/bioc_team_ds/how-to-ask-for-help.html Material en el que estoy involucrado: https://twitter.com/lcolladotor https://www.youtube.com/c/LeonardoColladoTorres/playlists LIBD rstats club https://docs.google.com/spreadsheets/d/1is8dZSd0FZ9Qi1Zvq1uRhm-P1McnJRd_zxdAfCRoMfA/edit?usp=sharing https://twitter.com/CDSBMexico, https://twitter.com/LIBDrstats, https://twitter.com/Bioconductor https://comunidadbioinfo.github.io/ YouTube CDSB: https://www.youtube.com/channel/UCHCdYfAXVzJIUkMoMSGiZMw Orchestrating Spatially Resolved Transcriptomics Analysis with Bioconductor https://lmweber.org/OSTA-book/ Thank you @Bioconductor for welcoming me &amp; providing me a foundation &amp; platform for my careerGracias BioC por darme una oportunidad y plataforma para desarrollar mi carreraTime to pass it on/Toca ense√±ar y crecer la bola de nieve ‚ùÑÔ∏è @CDSBMexico üá≤üáΩ#BioC2021 #rstats #rstatsES https://t.co/8cDXP4Pf2W pic.twitter.com/rpQgH8UsWW ‚Äî üá≤üáΩ Leonardo Collado-Torres (@lcolladotor) August 5, 2021 1.2 GitHub Permite compartir c√≥digo Se complementa con Git que es para tener un control de versiones de tu c√≥digo https://github.com/ComunidadBioInfo/cdsb2020/blob/master/presentaciones_flujos-de-trabajo/Introduccion-al-flujo-de-trabajo-orientado-a-proyectos.pdf Puedes tener p√°ginas web est√°ticas https://pages.github.com/ https://github.com/ComunidadBioInfo/cdsb2021_scRNAseq/. En especial https://github.com/ComunidadBioInfo/cdsb2021_scRNAseq/tree/gh-pages se convierte en https://comunidadbioinfo.github.io/cdsb2021_scRNAseq/ P√°gina personal: https://github.com/lcolladotor/lcolladotor.github.com se convierte en http://lcolladotor.github.io/. Est√° todo hecho con https://github.com/lcolladotor/lcolladotorsource Tip: usen el mismo nombre de usuario en GitHub, Twitter, Gmail, etc. How to be a Modern Scientist: https://lcolladotor.github.io/bioc_team_ds/how-to-be-a-modern-scientist.html 1.3 RStudio RStudio Desktop es gratis http://www.rstudio.com/products/rstudio/download/preview/ Nos ayuda a realizar muchas cosas con R de forma m√°s r√°pida Demo rsthemes remotes::install_github(c( &quot;gadenbuie/rsthemes&quot; )) remotes::install_cran(&quot;suncalc&quot;) rsthemes::install_rsthemes(include_base16 = TRUE) usethis::edit_r_profile() ## From https://www.garrickadenbuie.com/project/rsthemes/ if (interactive() &amp;&amp; requireNamespace(&quot;rsthemes&quot;, quietly = TRUE)) { # Set preferred themes if not handled elsewhere.. rsthemes::set_theme_light(&quot;Solarized Light {rsthemes}&quot;) # light theme rsthemes::set_theme_dark(&quot;base16 Monokai {rsthemes}&quot;) # dark theme rsthemes::set_theme_favorite(c( &quot;Solarized Light {rsthemes}&quot;, &quot;base16 Monokai {rsthemes}&quot;, &quot;One Dark {rsthemes}&quot; )) # Whenever the R session restarts inside RStudio... setHook(&quot;rstudio.sessionInit&quot;, function(isNewSession) { # Automatically choose the correct theme based on time of day ## Used rsthemes::geolocate() once rsthemes::use_theme_auto(lat = 39.2891, lon = -76.5583) }, action = &quot;append&quot;) } ## https://blog.rstudio.com/2013/06/10/rstudio-cran-mirror/ options(repos = c(CRAN = &quot;https://cloud.r-project.org&quot;)) Es actualizado con bastante frecuencia RStudio cheatsheets https://www.rstudio.com/resources/cheatsheets/ https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf RStudio projects: usalos para organizar tu c√≥digo https://github.com/ComunidadBioInfo/cdsb2020/blob/master/presentaciones_flujos-de-trabajo/Trabajando-con-proyectos.pdf usethis::create_project(&quot;~/Desktop/cdsb2021_scRNAseq_notas&quot;) ## Inicien un archivo para sus notas usethis::use_r(&quot;01-notas.R&quot;) O por ejemplo el archivo 01-visualizar-mtcars.R ## Creemos el archivo R/01-visualizar-mtcars.R usethis::use_r(&quot;01-visualizar-mtcars.R&quot;) con el siguiente contenido: ## Cargar paquetes que usaremos en este c√≥digo library(&quot;sessioninfo&quot;) library(&quot;here&quot;) library(&quot;ggplot2&quot;) ## Hello world print(&quot;Soy Leo&quot;) ## Crear directorio para las figuras dir.create(here::here(&quot;figuras&quot;), showWarnings = FALSE) ## Hacer una imagen de ejemplo pdf(here::here(&quot;figuras&quot;, &quot;mtcars_gear_vs_mpg.pdf&quot;), useDingbats = FALSE ) ggplot(mtcars, aes(group = gear, y = mpg)) + geom_boxplot() dev.off() ## Para reproducir mi c√≥digo options(width = 120) sessioninfo::session_info() Configura usethis con GitHub v√≠a https://usethis.r-lib.org/articles/articles/git-credentials.html ## Para poder conectar tu compu con GitHub usethis::create_github_token() ## Abrir√° una p√°gina web, escoje un nombre √∫nico ## y luego da click en el bot√≥n verde al final. Despu√©s copia el token ## (son 40 caracteres) gitcreds::gitcreds_set() ## Ojo, copia el token, no tu password de git! ## Si no, terminaras en la situaci√≥n descrita en ## https://github.com/r-lib/usethis/issues/1347 ## Configura tu usuario de GitHub usethis::edit_git_config() # [user] # name = Leonardo Collado Torres # email = lcolladotor@gmail.com ## Para inicializar el repositorio de Git usethis::use_git() ## Para conectar tu repositorio local de Git con los servidores de GitHub usethis::use_github() Resultado ejemplo: https://github.com/lcolladotor/cdsb2021_scRNAseq_notas. El que hice en vivo est√° disponible v√≠a https://github.com/lcolladotor/cdsb2021_scRNAseq_notas_en_vivo (o https://github.com/lcolladotor/rnaseq_2021_notas_en_vivo para un ejemplo de febrero 2021). Una vez que termines, agrega la liga al repositorio con tus notas del curso en el Google Sheet del curso. (De ser necesario, pide permisos para editar el archivo.) 1.4 Material del curso Pueden descargar la versi√≥n est√°tica con usethis::use_course('ComunidadBioInfo/cdsb2021_scRNAseq') Pueden verlo en l√≠nea a trav√©s de ComunidadBioInfo.github.io/cdsb2021_scRNAseq Pueden clonarlo desde GitHub de tal forma que podr√°n actualizarlo f√°cilmente usando git pull git clone https://github.com/ComunidadBioInfo/cdsb2021_scRNAseq.git ## Si tienen su SSH key configurarda pueden usar ## Info sobre SSH keys de GitHub: ## https://docs.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent git clone git@github.com:ComunidadBioInfo/cdsb2021_scRNAseq.git O desde R con: ## Opci√≥n m√°s nueva: library(&quot;gert&quot;) repo &lt;- git_clone( &quot;https://github.com/ComunidadBioInfo/cdsb2021_scRNAseq&quot;, &quot;~/Desktop/cdsb2021_scRNAseq&quot; ) setwd(repo) ## Otra opci√≥n: git2r::clone( &quot;https://github.com/ComunidadBioInfo/cdsb2021_scRNAseq&quot;, &quot;~/Desktop/cdsb2021_scRNAseq&quot; ) 1.5 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:09:55 UTC&quot; proc.time() ## user system elapsed ## 0.476 0.151 0.497 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["ejercicio-usando-usethis-here-y-postcards.html", "2 Ejercicio usando usethis, here y postcards 2.1 here 2.2 usethis 2.3 Vinculando RStudio con Git y GitHub 2.4 Ejercicio postcards 2.5 Detalles de la sesi√≥n de R Patrocinadores", " 2 Ejercicio usando usethis, here y postcards Instructoras: Elisa M√°rquez Zavala, Citlali Gil Aguillon Contenido adaptado del Curso de RNASeq de Leonardo Collado Torres 2.1 here Este paquete es bastante √∫til El directorio que toma como base ser√° en el que nos encontremos al momento de cargar el paquete here, heuristicamente busca la ra√≠z del proyecto y se posiciona en √©l. # se descarg√≥ previamente, as√≠ que solo se carga library(&quot;here&quot;) # busca la raiz del proyecto en el que se encuentre En ciertas ocasiones puede haber algun error, ya que puede chocar con otros paquetes (como plyr). para evitar esto podemos usar here::here (que b√°sicamente aclara que la funci√≥n solicitada es del paquete here) here::here() Podemos checar en qu√© directorio nos encontramos con getwd(), si no es el que deseamos podemos cambiarlo con setwd() getwd() # regresa la path en donde nos encontramos setwd(&quot;direccion/deseada&quot;) # nos lleva a la path indicada Pero con here podemos no especificar la path getwd() # para checar en donde nos encontramos here::here() # para checar d√≥nde te encuentras # nos movemos al subdirectorio R setwd(here::here(&quot;R&quot;)) # podemos cambiar de directorio, aun as√≠ `here est√° en la ra√≠z A continuaci√≥n ofrecemos algunos ejemplos de c√≥mo podr√≠a emplearse here::here # como ejemplo: vamos a guardar datos en archivo y cargarlos a &lt;- 1 c &lt;- 23 save(a, c, file = here::here(&quot;datos-prueba.RData&quot;)) # rm(a,c) load(here::here(&quot;datos-prueba.RData&quot;)) # creamos un directorio dir.create(here::here(&quot;subdirectorio&quot;), showWarnings = FALSE) # podemos crear un archivo, indicando el subdirectorio, (en este caso el primer argumento) file.create(here::here(&quot;subdirectorio&quot;, &quot;nombrearchivo&quot;)) # abrimos el nuevo archivo creado file.show(here::here(&quot;subdirectorio&quot;, &quot;nombrearchivo&quot;)) # podemos editarlo!! # por ejemplo si quisieramos ver nuestros archivos del directorio list.files(here::here(), recursive = TRUE) 2.2 usethis manual de usuario usethis puede ser m√°s amigable, por ejemplo para la creaci√≥n de nuevos archivos .R es capaz de agruparlos en la carpeta R (dando un orden al proyecto) usethis::use_r(&quot;notas-prueba.R&quot;) # no importando en qu√© path estemos En el siguiente ejercicio veremos algunos usos de usethis 2.3 Vinculando RStudio con Git y GitHub Ahora vamos a vincular nuestro proyecto de Rstudio con Github, esto es muy util para tener un control de nuestros archivos, poder compartirlos o usar el de otrxs 2.3.1 Prerrequisitos Debemos tener una cuenta de Github. Si no tienes este es el momento para crear una cuenta! https://docs.github.com/es/github/getting-started-with-github/signing-up-for-github/signing-up-for-a-new-github-account Tambi√©n debemos instalar git en nuestras computadoras ya que el paquete gitcreds lo requiere https://git-scm.com/book/en/v2/Getting-Started-Installing-Git Despues de instalar git debemor reiniciar nuestro RStudio para que pueda anexarse Y la instalaci√≥n de los siguientes paquetes: # paquetes que vamos a requerir install.packages(c(&quot;gitcreds&quot;, &quot;gert&quot;, &quot;gh&quot;)) # cargarlos de manera separada library(&quot;gitcreds&quot;) library(&quot;gert&quot;) library(&quot;gh&quot;) 2.3.2 Creando token de acceso personal (PAT) Para conectar nuestro repositorio de Rstudio con Github solicitamos un token, esto para que github otorgue permiso a nuestra computadora Emplearemos el siguiente bloque de c√≥digo para solicitar dicho token (elige un nombre significativo) Otra manera de solicitar el token es ingresando a https://github.com/settings/tokens, esta opci√≥n no dar√° una recomendaci√≥n de los par√°metros a seleccionar El par√°metro de expiraci√≥n del token puede cambiarse para que no expire (por seguridad no lo recomienda Github), de otra manera considera su tiempo de vigencia Una vez generado el token debes guardarlo, pues no volver√° a aparecer. Siempre puedes volver a generar uno nuevo (no olvides borrar el token anterior) # Para iniciar conexi√≥n con GitHub usethis::create_github_token() # redirige a github donde eligiras nombre especifico del token # copia el token para despu√©s ingresarlo con gitcreds_set() gitcreds::gitcreds_set() # aqu√≠ colocas el token (NO tu contrase√±a de github!!!) NOTA: en el comando gitcreds::gitcreds_set() NO debemos poner nuestro token entre parentesis, sino que al ejecutar el comando la misma funci√≥n nos pedir√° ingresar el token El siguiente paso ser√° configurar nuestro usuario de github en el archivo .gitconfig # Configurar usuario de gitHub usethis::edit_git_config() # que abre el archivo .gitconfig # colocaremos nombre y correo de cuenta de github. SOLO borrar los # y respetar los demas espacios # [user] # name = N O M B R E # email = correodeGithub 2.3.3 Inicializar repositorio de Git y Github Ahora vamos a inicializar el repositorio en Git (de manera local en tu computadora) y enseguida solicitamos que se conecte con los servidores de Github # inicializar el repositorio de Git usethis::use_git() # # conectar tu repositorio local de Git con los servidores de GitHub usethis::use_github() Git es el software mientras que GitHub es la plataforma web (basada en Git) que permite la colaboraci√≥n LISTO!! Comando √∫til para checar configuraci√≥n gh::gh_whoami() # para checar c√≥mo qued√≥ la configuraci√≥n 2.3.4 Probar otros comandos de gert Una vez que ya vinculamos nuestro repositorio con github podemos seguir actualizandolo. Vamos a checar brevemente algunos de los comandos que son √∫tiles para ello: Checaremos git_add, git_commit, git_log y git_push # escribimos un nuevo archivo, volvemos a usar here::here para especificar path writeLines(&quot;hola&quot;, here::here(&quot;R&quot;, &quot;prueba-here.R&quot;)) # otra manera es usar use_r usethis::use_r(&quot;archivo-prueba-github.R&quot;) # a√±ade archivo al directorio R del proyecto actual # Por ejemplo podr√≠amos probar a√±adir algo nuevo gert::git_add(&quot;R/archivo-prueba-github.R&quot;) # a√±adimos commit de lo que se hizo gert::git_commit(&quot;se subio archivo prueba&quot;) # nos da info de los commits gert::git_log() # sube tus cambios del repo local a los de github gert::git_push() # COMANDO IMPORTANTE Puede ser m√°s amigable usar el recuadro de Git que aparece en RStudio para hacer todo lo anterior! Recuerden subir sus repositorios al Google Sheet 2.4 Ejercicio postcards Similar a https://pages.github.com/ postcards tiene 4 templados de p√°ginas web https://github.com/seankross/postcards Tu p√°gina web debe describir decir algo sobre ti, tus intereses, y tus proyectos adem√°s de c√≥mo contactarte Ejemplo https://amy-peterson.github.io/ v√≠a https://github.com/amy-peterson/amy-peterson.github.com http://jtleek.com/ v√≠a https://github.com/jtleek/jtleek.github.io http://aejaffe.com/ v√≠a https://github.com/andrewejaffe/andrewejaffe.github.io 2.4.1 Crear el repositorio Podemos crearlo desde RStudio o desde github.com (opci√≥n 1) Desde RStudio ¬°Cuidado!: Antes de crear un proyecto, revisen d√≥nde est√°n parados (getwd()) en su directorio y d√≥nde quieren que se cree ## Creen el RStudio project. Es MUY importante que el usuario debe sea igual que en github usethis::create_project(&quot;Su_Usuario.github.io&quot;) Nuevo proyecto : git user ## Configura Git y GitHub # Con use_git() preguntar√° si desean hacer un commit, y despu√©s pedir√° reiniciar Rstudio para que obtengan un nuevo bot√≥n llamado &quot;git()&quot; usethis::use_git() Nuevo bot√≥n button_git usethis::use_github() Creen su templado usando postcards. Va a crear un archivo index.Rmd ## Solo uno de estos, de acuerdo al templado que m√°s les gust√≥ postcards::create_postcard(template = &quot;jolla&quot;) postcards::create_postcard(template = &quot;jolla-blue&quot;) postcards::create_postcard(template = &quot;trestles&quot;) postcards::create_postcard(template = &quot;onofre&quot;) (opci√≥n 2) Desde github Creen un nuevo repositorio, p√∫blico y sin archivo README en https://github.com/new llamado ‚Äúusuario.github.io‚Äù con su nombre exacto en github ¬°Cuidado! El repositorio debe ser p√∫blico y sin README Creen un nuevo proyecto en RStudio: File &gt; New_project &gt; New directory &gt; Postcards Website Elijan el templado que m√°s les gust√≥ Ya con el proyecto creado, hay que configurar git y github ## Configura Git y GitHub # Con use_git() preguntar√° si desean hacer un commit, y despu√©s pedir√° reiniciar Rstudio para que obtengan un nuevo bot√≥n llamado &quot;git()&quot; usethis::use_git() Nuevo bot√≥n: button_git Ahora que tienen el bot√≥n Git, hagan click y en la esquina derecha habr√° un s√≠mbolo con dos rect√°ngulos morados y un rombo blanco, denle click. button_branch Ahora el bot√≥n Add Remote y ah√≠ podr√°n nombrar este acceso remoto como gusten, y agregar la URL de su repositorio en github. Da click en Add y despu√©s asignen el nombre de rama master Ahora pueden crear la rama, y sobreescribir el acceso cuando se los pregunte. 2.4.2 Modificar y subir a github nuestro postcard Ya que hayan creado con cualquiera de las 2 opciones anteriores pueden continuar: Llenen su informaci√≥n usando el formato Markdown. Por ejemplo https://github.com/andrewejaffe/andrewejaffe.github.io/blob/master/index.Rmd#L17-L31. Agreguen sus perfiles estilo https://github.com/andrewejaffe/andrewejaffe.github.io/blob/master/index.Rmd#L7-L12 Den click en el bot√≥n azul de knit en RStudio. Es equivalente a rmarkdown::render(\"index.Rmd\"). Esto crear√° el archivo index.html. Hagan un commit para guardar los archivos nuevos incluyendo index.html y luego un push para subir los archivos a GitHub con alguna de las siguientes dos maneras: (opci√≥n 1) Bot√≥n de Git * Para guardar los archivos nuevos, incluyendo index.html, debemos hacer un commit. Podemos hacerlo con el nuevo bot√≥n de git, primero seleccionando los archivos: add_file Cuando hayamos seleccionado todos los archivos, veremos que la columna Status cambia a una ‚ÄúA‚Äù de agregado o added y podemos darle al bot√≥n Commit justo arriba de Status. Esto abrir√° una nueva pesta√±a donde podremos poner un mensaje sobre nuestro commit y despu√©s darle al bot√≥n Commit. button_git Una vez terminado, en esa misma pantalla podemos darle un push para subir los archivos a GitHub con el bot√≥n de Push con una flecha verde arriba de Commit message. (opcion 2) L√≠nea de comandos Otra manera de hacer es v√≠a l√≠nea de comandos, primero pueden agregar los archivos con gert::git_add() o hacer directamente un commit de todos los archivos y luego un pull: ## Guardamos los archivos nuevos con el commit gert::git_commit_all(&quot;mensaje sobre el commit&quot;) ## Subimos los archivos a github gert::git_push (extra) . Pueden copiar y pegar emojis en sus p√°ginas o utilizar fontawesome para agregar diferentes s√≠mbolos (como github o twitter): En c√≥digo YAML # Utlilizando `r fontawesome::fa(&quot;font-awesome-logo-full&quot;, fill = &quot;forestgreen&quot;)` en c√≥digo YAML y_fawesome Se ve as√≠: fawesome En el texto # Utlilizando `r fontawesome::fa(&quot;font-awesome-logo-full&quot;, fill = &quot;forestgreen&quot;)` en el texto tfawesome (opcional). Anuncien su nueva p√°gina web en Twitter usando el hashtag #rstats y/o etiquen al autor de postcards https://twitter.com/seankross. Pueden despu√©s incluir su p√°gina web en su introducci√≥n en el canal #bienvenida del Slack de la CDSB ^^. Recuerden subir sus repositorios al Google Sheet 2.5 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:09:56 UTC&quot; proc.time() ## user system elapsed ## 0.664 0.108 0.643 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["introducci√≥n-a-rna-seq-de-c√©lula-√∫nica-scrna-seq-con-bioconductor-y-al-libro-de-osca.html", "3 Introducci√≥n a RNA-seq de c√©lula √∫nica (scRNA-seq) con Bioconductor y al libro de OSCA 3.1 Bioconductor 3.2 Introducci√≥n a RNA-seq de c√©lula √∫nica (scRNA-seq) con Bioconductor y al libro de OSCA 3.3 Detalles de la sesi√≥n de R Patrocinadores", " 3 Introducci√≥n a RNA-seq de c√©lula √∫nica (scRNA-seq) con Bioconductor y al libro de OSCA Instructoras: Elisa M√°rquez Zavala, Citlali Gil Aguillon Contenido adaptado del Curso de RNASeq de Leonardo Collado Torres y de Original Notes in English 3.1 Bioconductor CRAN, the R package repository: https://cran.r-project.org/ CRAN task views: https://cran.r-project.org/web/views/ ‚ÄúBioconductor proporciona herramientas para el an√°lisis y la comprensi√≥n de datos gen√≥micos de alto rendimiento. Bioconductor utiliza el lenguaje de programaci√≥n estad√≠stico R y es de c√≥digo abierto y desarrollo abierto. Tiene dos lanzamientos cada a√±o y una comunidad de usuarios activa. Bioconductor tambi√©n est√° disponible como AMI (Imagen de m√°quina de Amazon) e im√°genes de Docker.‚Äù https://www.bioconductor.org/ Where do I start using Bioconductor? http://lcolladotor.github.io/2014/10/16/startbioc/#.XqxNGRNKiuo B√°sicamente es un repositorio con reglas o est√°ndares para el an√°lisis y la comprensi√≥n de datos gen√≥micos de alto rendimiento. Para conocer sobre Bioconductor podemos ir a: https://www.bioconductor.org/ y dar click en About 3.1.1 Equipos y consejos Es conformado por diversos equipos y consejos (Asesores cient√≠ficos, t√©cnicos y de la comunidad). Por ejemplo Leonardo Collado. Cient√≠ficos : Proporciona orientaci√≥n externa y supervisi√≥n de la direcci√≥n cient√≠fica del proyecto y est√° compuesto por l√≠deres en el an√°lisis estad√≠stico de datos gen√≥micos. T√©cnicos: Desarrollar estrategias para asegurar que la parte t√©cnica de la infraestructura sea apropiada a largo plazo (manejo de paquetes, sitio web, slack, etc) Comunidad : Empoderar a las comunidades de usuarios y desarrolladores mediante la coordinaci√≥n de actividades de capacitaci√≥n y divulgaci√≥n. Dentro del equipo core que mantiene a Bioconductor y apoya con las dudas (https://www.bioconductor.org/about/core-team/) hay gente a la que Bioconductor le paga por mantener los repositorios, lo cual lo hace diferente de CRAN. El tener gente que oficialmente sabe c√≥mo ayudarte y tiene el tiempo para hacerlo crea una mejor experiencia para los usuarios y los desarrolladores. 3.1.2 Encontrando paquetes de Bioconductor Tipos de paquetes Hay 4 tipos de paquetes que aceptan Software: tipo principal de paquete BioC, en su mayor√≠a aportado por el usuario. Es un paquete con un tipo de an√°lisis espec√≠fico. Algunos los hacen gente pagada directamente por Bioconductor Annotation: facilita la interacci√≥n con bases de datos gen√≥micas muy utilizadas Experiment: contienen datos para alg√∫n art√≠culo o datos que se usan en ejemplos m√°s exhaustivos, en su mayor√≠a aportados por el usuario. ~&lt;5 Mb Workflows: demuestran como puedes usar varios paquetes de Bioconductor para ciertos tipos de an√°lisis Para descubrir paquetes: Software: http://bioconductor.org/packages/release/bioc/ Annotation: http://bioconductor.org/packages/release/data/annotation/ Experiment Data: http://bioconductor.org/packages/release/data/experiment/ Workflows: http://bioconductor.org/packages/release/workflows/ Las listas de cada tipo de paquete se ven algo as√≠: Package Maintainer Title Nombre del paquete Qui√©n lo mantiene T√≠tulo completo recount3 Leonardo Collado-Torres Explore and download data from the recount3 project Paquetes de R de Leo: https://lcolladotor.github.io/pkgs/ Sin embargo, estas listas no son muy amigables si queremos explorar por lo que podemos usar biocViews Encontrando paquetes a trav√©s de biocViews: http://bioconductor.org/packages/release/BiocViews.html#___Software Estructura tipo √°rbol Son 4 √°rboles principales: software, annotation, experiment, workflow Dentro de cada √°rbol, un paquete puede ser parte de varias ramas, por ejemplo, recount3 est√° dentro de todas estas ramas: Software AssayDomain GeneExpression BiologicalQuestion DifferentialExpression Coverage Infrastructure DataImport Technology Sequencing RNASeq Tiene una b√∫squeda de texto simple Ejemplo: Software ‚Üí WorkflowStep ‚Üí Visualization ‚Üí http://bioconductor.org/packages/release/BiocViews.html#___Visualization (486 paquetes en BioC 3.11 abril-octubre 2020, 506 en BioC 3.12 octubre 2020-abril 2021, 529 en BioC 3.13 agosto 2021) 3.1.3 Estructura de un paquete de BioC Usa https://bioconductor.org/packages/&lt;pkg_name&gt; Ejemplo: https://bioconductor.org/packages/recount Otro ejemplo: https://bioconductor.org/packages/SummarizedExperiment Badges (etiquetas): r√°pidamente podemos evaluar como est√° : ¬øEn qu√© plataformas funciona? : ¬øQu√© tan descargado es? : ¬øSe han hecho preguntas del paquete en los √∫ltimos 6 meses? (respondidas/hechas) : ¬øCu√°nto tiempo lleva en Bioconductor? : ¬øFunciona en las m√°quinas de bioconductor? : ¬øCu√°ndo fue la √∫ltima vez que lo actualizaron? : N√∫mero de dependencias recursivas necesarias para instalar el paquete Parr√°fo de descripci√≥n del paquete C√≥mo citar al paquete de Bioconductor C√≥mo instalarlo. M√°s detalles en http://bioconductor.org/install/ Documentaci√≥n Una l√≠ga por cada vignette en formato PDF o HTML. Es la documentaci√≥n principal! Una vignette es donde lxs autores del paquete explican c√≥mo usar las diferentes funciones del paquete y en qu√© orden Detalles T√©rminos de biocViews C√≥mo se relaciona a otros paquetes (depends, imports, linking to, suggests, depends on me, ‚Ä¶) URL: donde puedes encontrar el c√≥digo fuente (nos puede dar m√°s infor) BugReports: donde puedes pedir ayuda M√°s detalles sobre el paquete Estad√≠sticas de descargas 3.1.4 Las dos ramas de Bioconductor: release y devel Dos ramas release, actualmente 3.13 devel, actualmente 3.14 Bioconductor version 3.14 (Development) https://bioconductor.org/packages/devel/BiocViews.html#___Software Ejemplo: http://bioconductor.org/packages/devel/bioc/html/recount.html Bioconductor tiene es actualizado cada 6 meses (abril y octubre). R lo actualizan 1 vez al a√±o (abril). Todo el software lo prueban en macOS, Windows y linux Ejemplo: http://bioconductor.org/checkResults/release/bioc-LATEST/recount/ y http://bioconductor.org/checkResults/devel/bioc-LATEST/recount/ Resumen BioC 3.13 http://bioconductor.org/news/bioc_3_13_release/ Blog post en LIBD rstats club: Quick overview on the new Bioconductor 3.8 release http://research.libd.org/rstatsclub/2018/11/02/quick-overview-on-the-new-bioconductor-3-8-release/ 3.1.5 Cursos y eventos http://bioconductor.org/help/events/ http://bioconductor.org/help/course-materials/ BioC2021: conferencia principal anual https://bioc2021.bioconductor.org/ Talleres del BioC2019: https://rebrand.ly/biocworkshops2019 Teach online data science, bioinformatics, or other computational skills interactively using the Orchestra platform:https://t.co/r4aJ2xAZbh Nearly 50 workshop environments preloaded with #jupyter, #rstudio, #shell. #rstats, or #python.@NIHSTRIDES @NIHDataScience @Bioconductor pic.twitter.com/HyWVLBJxGU ‚Äî Sean Davis (@seandavis12) January 10, 2021 Talleres de la CDSB, como los talleres de CDSB 2020: https://comunidadbioinfo.github.io/post/cdsb2020-building-workflows-with-rstudio-and-scrnaseq-with-bioconductor/#.XmJT-Z-YU1I 3.1.6 Comunidad Slack: https://bioc-community.herokuapp.com/ Sitio web de ayuda: https://support.bioconductor.org/ Usa la(s) etiqueta(s) adecuada(s) para que lxs autores de los paquetes reciban email de forma autom√°tica Pueden revisar ese sitio web y usarlo para aprender c√≥mo en https://lcolladotor.github.io/bioc_team_ds/helping-others.html#bioconductor-support-practice-grounds Twitter: https://twitter.com/bioconductor 3.2 Introducci√≥n a RNA-seq de c√©lula √∫nica (scRNA-seq) con Bioconductor y al libro de OSCA link a diapositivas 3.3 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:09:57 UTC&quot; proc.time() ## user system elapsed ## 0.445 0.118 0.436 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["estructura-e-importe-de-datos.html", "4 Estructura e importe de datos 4.1 Detalles de la sesi√≥n de R Patrocinadores", " 4 Estructura e importe de datos TODO 4.1 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:09:57 UTC&quot; proc.time() ## user system elapsed ## 0.435 0.119 0.420 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["control-de-calidad.html", "5 Control de calidad 5.1 Diapositivas de Peter Hickey 5.2 Ejercicio: entendiendo addPerCellQC 5.3 Gr√°ficas sobre medidas de control de calidad (QC) 5.4 Eliminar c√©lulas de baja calidad 5.5 Ejercicio: filtrado de c√©lulas 5.6 Datos de Grun et al 5.7 Gr√°ficas de QC extra 5.8 Ejercicio: ERCC Grun et al 5.9 Identificando droplets vac√≠os con datos de PBMC 5.10 Ejercicio: detecci√≥n de droplets vac√≠os 5.11 Filtrado de expresi√≥n mitocondrial adicional 5.12 Ejercicio avanzado 5.13 Discusi√≥n ¬øConviene eliminar datos? 5.14 Explorando datos de forma interactiva con iSEE 5.15 Detalles de la sesi√≥n de R Patrocinadores", " 5 Control de calidad Instructor: Leonardo Collado Torres ## Paquetes de este cap√≠tulo library(&quot;scRNAseq&quot;) ## para descargar datos de ejemplo library(&quot;AnnotationHub&quot;) ## para obtener informaci√≥n de genes library(&quot;scater&quot;) ## para gr√°ficas y control de calidad library(&quot;BiocFileCache&quot;) ## para descargar datos library(&quot;DropletUtils&quot;) ## para detectar droplets library(&quot;Matrix&quot;) ## para leer datos en formatos comprimidos 5.1 Diapositivas de Peter Hickey Ve las diapositivas aqu√≠ 5.2 Ejercicio: entendiendo addPerCellQC ## Datos library(&quot;scRNAseq&quot;) sce.416b &lt;- LunSpikeInData(which = &quot;416b&quot;) ## snapshotDate(): 2021-05-18 ## see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation ## downloading 1 resources ## retrieving 1 resource ## loading from cache ## see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation ## downloading 1 resources ## retrieving 1 resource ## loading from cache ## see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation ## downloading 1 resources ## retrieving 1 resource ## loading from cache ## snapshotDate(): 2021-05-18 ## see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation ## downloading 1 resources ## retrieving 1 resource ## loading from cache ## snapshotDate(): 2021-05-18 ## downloading 1 resources ## retrieving 1 resource ## loading from cache ## require(&quot;ensembldb&quot;) sce.416b$block &lt;- factor(sce.416b$block) # Descarga los archivos de anotaci√≥n de la base de datos de Ensembl # correspondientes usando los recursos disponibles v√≠a AnnotationHub library(&quot;AnnotationHub&quot;) ah &lt;- AnnotationHub() ## snapshotDate(): 2021-05-18 query(ah, c(&quot;Mus musculus&quot;, &quot;Ensembl&quot;, &quot;v97&quot;)) ## AnnotationHub with 1 record ## # snapshotDate(): 2021-05-18 ## # names(): AH73905 ## # $dataprovider: Ensembl ## # $species: Mus musculus ## # $rdataclass: EnsDb ## # $rdatadateadded: 2019-05-02 ## # $title: Ensembl 97 EnsDb for Mus musculus ## # $description: Gene and protein annotations for Mus musculus based on Ensem... ## # $taxonomyid: 10090 ## # $genome: GRCm38 ## # $sourcetype: ensembl ## # $sourceurl: http://www.ensembl.org ## # $sourcesize: NA ## # $tags: c(&quot;97&quot;, &quot;AHEnsDbs&quot;, &quot;Annotation&quot;, &quot;EnsDb&quot;, &quot;Ensembl&quot;, &quot;Gene&quot;, ## # &quot;Protein&quot;, &quot;Transcript&quot;) ## # retrieve record with &#39;object[[&quot;AH73905&quot;]]&#39; # Obt√©n la posici√≥n del cromosoma para cada gen ens.mm.v97 &lt;- ah[[&quot;AH73905&quot;]] ## loading from cache location &lt;- mapIds( ens.mm.v97, keys = rownames(sce.416b), keytype = &quot;GENEID&quot;, column = &quot;SEQNAME&quot; ) ## Warning: Unable to map 563 of 46604 requested IDs. # Identifica los genes mitocondriales is.mito &lt;- which(location == &quot;MT&quot;) library(&quot;scater&quot;) sce.416b &lt;- addPerCellQC(sce.416b, subsets = list(Mito = is.mito) ) ## Si quieres guarda los resultados de addPerCellQC() para responder ## las preguntas del ejercicio. Eventualmente si necesitaremos los ## resultados de addPerCellQC() para las secciones posteriores a este ## ejercicio. ¬øQu√© cambi√≥ en nuestro objeto sce despu√©s de addPerCellQC? 1 Haz una gr√°fica de boxplots del n√∫mero de genes por bloque (block) de c√©lulas. 2 5.3 Gr√°ficas sobre medidas de control de calidad (QC) plotColData(sce.416b, x = &quot;block&quot;, y = &quot;detected&quot;) plotColData(sce.416b, x = &quot;block&quot;, y = &quot;detected&quot;) + scale_y_log10() plotColData(sce.416b, x = &quot;block&quot;, y = &quot;detected&quot;, other_fields = &quot;phenotype&quot; ) + scale_y_log10() + facet_wrap(~phenotype) 5.3.1 Ejercicio: gr√°ficas QC ERCC Adapta el c√≥digo de las gr√°ficas anteriores para otra variable de control de calidad. Por ejemplo, escribe el c√≥digo para reproducir las siguientes gr√°ficas. Basado en las gr√°ficas encuentra la variable de colData(sce.416b) que contiene la informaci√≥n que queremos gr√°ficar. ¬°No hay que reemplazar todo lo que diga phenotype Tengo cuidado con las transformaciones de valores en el eje Y. No aplican para todo tipo de datos. 5.4 Eliminar c√©lulas de baja calidad # Valores de l√≠mite ejemplo qc.lib &lt;- sce.416b$sum &lt; 100000 qc.nexprs &lt;- sce.416b$detected &lt; 5000 qc.spike &lt;- sce.416b$altexps_ERCC_percent &gt; 10 qc.mito &lt;- sce.416b$subsets_Mito_percent &gt; 10 discard &lt;- qc.lib | qc.nexprs | qc.spike | qc.mito # Obtenemos un resumen del n√∫mero de c√©lulas # eliminadas por cada filtro DataFrame( LibSize = sum(qc.lib), NExprs = sum(qc.nexprs), SpikeProp = sum(qc.spike), MitoProp = sum(qc.mito), Total = sum(discard) ) ## DataFrame with 1 row and 5 columns ## LibSize NExprs SpikeProp MitoProp Total ## &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; ## 1 3 0 19 14 33 ## Usando isOutlier() para determinar los valores de corte qc.lib2 &lt;- isOutlier(sce.416b$sum, log = TRUE, type = &quot;lower&quot;) qc.nexprs2 &lt;- isOutlier(sce.416b$detected, log = TRUE, type = &quot;lower&quot; ) qc.spike2 &lt;- isOutlier(sce.416b$altexps_ERCC_percent, type = &quot;higher&quot; ) qc.mito2 &lt;- isOutlier(sce.416b$subsets_Mito_percent, type = &quot;higher&quot; ) discard2 &lt;- qc.lib2 | qc.nexprs2 | qc.spike2 | qc.mito2 # Extraemos los l√≠mites de valores (thresholds) attr(qc.lib2, &quot;thresholds&quot;) ## lower higher ## 434082.9 Inf attr(qc.nexprs2, &quot;thresholds&quot;) ## lower higher ## 5231.468 Inf # Obtenemos un resumen del n√∫mero de c√©lulas # eliminadas por cada filtro DataFrame( LibSize = sum(qc.lib2), NExprs = sum(qc.nexprs2), SpikeProp = sum(qc.spike2), MitoProp = sum(qc.mito2), Total = sum(discard2) ) ## DataFrame with 1 row and 5 columns ## LibSize NExprs SpikeProp MitoProp Total ## &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; ## 1 4 0 1 2 6 ## M√°s pruebas plotColData(sce.416b, x = &quot;block&quot;, y = &quot;detected&quot;, other_fields = &quot;phenotype&quot; ) + scale_y_log10() + facet_wrap(~phenotype) ## Determino el bloque (batch) de muestras batch &lt;- paste0(sce.416b$phenotype, &quot;-&quot;, sce.416b$block) ## Versi√≥n de isOutlier() que toma en cuenta los bloques de muestras qc.lib3 &lt;- isOutlier(sce.416b$sum, log = TRUE, type = &quot;lower&quot;, batch = batch ) qc.nexprs3 &lt;- isOutlier(sce.416b$detected, log = TRUE, type = &quot;lower&quot;, batch = batch ) qc.spike3 &lt;- isOutlier(sce.416b$altexps_ERCC_percent, type = &quot;higher&quot;, batch = batch ) qc.mito3 &lt;- isOutlier(sce.416b$subsets_Mito_percent, type = &quot;higher&quot;, batch = batch ) discard3 &lt;- qc.lib3 | qc.nexprs3 | qc.spike3 | qc.mito3 # Extraemos los l√≠mites de valores (thresholds) attr(qc.lib3, &quot;thresholds&quot;) ## induced CBFB-MYH11 oncogene expression-20160113 ## lower 461073.1 ## higher Inf ## induced CBFB-MYH11 oncogene expression-20160325 ## lower 399133.7 ## higher Inf ## wild type phenotype-20160113 wild type phenotype-20160325 ## lower 599794.9 370316.5 ## higher Inf Inf attr(qc.nexprs3, &quot;thresholds&quot;) ## induced CBFB-MYH11 oncogene expression-20160113 ## lower 5399.24 ## higher Inf ## induced CBFB-MYH11 oncogene expression-20160325 ## lower 6519.74 ## higher Inf ## wild type phenotype-20160113 wild type phenotype-20160325 ## lower 7215.887 7586.402 ## higher Inf Inf # Obtenemos un resumen del n√∫mero de c√©lulas # eliminadas por cada filtro DataFrame( LibSize = sum(qc.lib3), NExprs = sum(qc.nexprs3), SpikeProp = sum(qc.spike3), MitoProp = sum(qc.mito3), Total = sum(discard3) ) ## DataFrame with 1 row and 5 columns ## LibSize NExprs SpikeProp MitoProp Total ## &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt; ## 1 5 4 6 2 9 5.5 Ejercicio: filtrado de c√©lulas ¬øFue necesario qc.lib para crear discard? 3 ¬øC√∫al filtro fue m√°s estricto? ¬ødiscard o discard2? 4 Al considerar el grupo de cada muestra (batch), ¬ødescartamos m√°s c√©lulas usando un valor de l√≠mite autom√°tico? 5 5.6 Datos de Grun et al ¬øQu√© patr√≥n revela esta gr√°fica? sce.grun &lt;- GrunPancreasData() ## snapshotDate(): 2021-05-18 ## see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation ## downloading 1 resources ## retrieving 1 resource ## loading from cache ## snapshotDate(): 2021-05-18 ## see ?scRNAseq and browseVignettes(&#39;scRNAseq&#39;) for documentation ## loading from cache sce.grun &lt;- addPerCellQC(sce.grun) ## ¬øQu√© patr√≥n revela esta gr√°fica? plotColData(sce.grun, x = &quot;donor&quot;, y = &quot;altexps_ERCC_percent&quot;) ## Warning: Removed 10 rows containing non-finite values (stat_ydensity). ## Warning: Removed 10 rows containing missing values (position_quasirandom). ¬øC√∫al de las siguientes gr√°ficas identifica mejor las c√©lulas de baja calidad? ## isOutlier() puede ayudarnos cuando un grupo de muestras ## tuvo m√°s problemas que el resto discard.ercc &lt;- isOutlier(sce.grun$altexps_ERCC_percent, type = &quot;higher&quot;, batch = sce.grun$donor ) ## Warning in .get_med_and_mad(metric, batch = batch, subset = subset, ## share.medians = share.medians, : missing values ignored during outlier detection discard.ercc2 &lt;- isOutlier( sce.grun$altexps_ERCC_percent, type = &quot;higher&quot;, batch = sce.grun$donor, subset = sce.grun$donor %in% c(&quot;D17&quot;, &quot;D2&quot;, &quot;D7&quot;) ) ## Warning in .get_med_and_mad(metric, batch = batch, subset = subset, ## share.medians = share.medians, : missing values ignored during outlier detection ## isOutlier() tomando en cuenta el batch plotColData( sce.grun, x = &quot;donor&quot;, y = &quot;altexps_ERCC_percent&quot;, colour_by = data.frame(discard = discard.ercc) ) ## Warning: Removed 10 rows containing non-finite values (stat_ydensity). ## Warning: Removed 10 rows containing missing values (position_quasirandom). ## isOutlier() tomando en cuenta batch y muestras que fallaron plotColData( sce.grun, x = &quot;donor&quot;, y = &quot;altexps_ERCC_percent&quot;, colour_by = data.frame(discard = discard.ercc2) ) ## Warning: Removed 10 rows containing non-finite values (stat_ydensity). ## Warning: Removed 10 rows containing missing values (position_quasirandom). 5.7 Gr√°ficas de QC extra Otras gr√°ficas que podemos hacer. # Agregamos informaci√≥n sobre que c√©lulas # tienen valores extremos sce.416b$discard &lt;- discard2 # Haz esta gr√°fica para cada medida de # control de calidad (QC) plotColData( sce.416b, x = &quot;block&quot;, y = &quot;sum&quot;, colour_by = &quot;discard&quot;, other_fields = &quot;phenotype&quot; ) + facet_wrap(~phenotype) + scale_y_log10() # Otra gr√°fica de diagn√≥stico √∫til plotColData( sce.416b, x = &quot;sum&quot;, y = &quot;subsets_Mito_percent&quot;, colour_by = &quot;discard&quot;, other_fields = c(&quot;block&quot;, &quot;phenotype&quot;) ) + facet_grid(block ~ phenotype) 5.8 Ejercicio: ERCC Grun et al Adapta el c√≥digo de sce.416b para los datos de Grun et al y reproduce la imagen siguiente. F√≠jate en que variables de colData() estamos graficando. ¬øExiste la variable discard en colData()? ¬øQu√© variable tiene valores de D10, D17, D2, D3 y D7? 5.9 Identificando droplets vac√≠os con datos de PBMC Descripci√≥n gr√°fica la tecnolog√≠a Next GEM de 10x Genomics. Fuente: 10x Genomics. Opciones algor√≠tmicas para detecar los droplets vac√≠os. Fuente: Lun et al, Genome Biology, 2019. ## Descarguemos los datos library(&quot;BiocFileCache&quot;) bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath( bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot; ) ) ## adding rname &#39;http://cf.10xgenomics.com/samples/cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&#39; untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc4k&quot;)) ## Leamos los datos en R library(&quot;DropletUtils&quot;) library(&quot;Matrix&quot;) fname &lt;- file.path(tempdir(), &quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;) sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE) bcrank &lt;- barcodeRanks(counts(sce.pbmc)) # Mostremos solo los puntos √∫nicos para acelerar # el proceso de hacer esta gr√°fica uniq &lt;- !duplicated(bcrank$rank) plot( bcrank$rank[uniq], bcrank$total[uniq], log = &quot;xy&quot;, xlab = &quot;Rank&quot;, ylab = &quot;Total UMI count&quot;, cex.lab = 1.2 ) ## Warning in xy.coords(x, y, xlabel, ylabel, log): 1 y value &lt;= 0 omitted from ## logarithmic plot abline( h = metadata(bcrank)$inflection, col = &quot;darkgreen&quot;, lty = 2 ) abline( h = metadata(bcrank)$knee, col = &quot;dodgerblue&quot;, lty = 2 ) legend( &quot;bottomleft&quot;, legend = c(&quot;Inflection&quot;, &quot;Knee&quot;), col = c(&quot;darkgreen&quot;, &quot;dodgerblue&quot;), lty = 2, cex = 1.2 ) Encontremos los droplets vac√≠os usando emptyDrops(). ## Usemos DropletUtils para encontrar los droplets set.seed(100) e.out &lt;- emptyDrops(counts(sce.pbmc)) # Revisa ?emptyDrops para una explicaci√≥n de porque hay valores NA summary(e.out$FDR &lt;= 0.001) ## Mode FALSE TRUE NA&#39;s ## logical 989 4300 731991 set.seed(100) limit &lt;- 100 all.out &lt;- emptyDrops(counts(sce.pbmc), lower = limit, test.ambient = TRUE) # Idealmente, este histograma deber√≠a verse uniforme. # Picos grandes cerca de cero indican que los _barcodes_ # con un n√∫mero total de cuentas menor a &quot;lower&quot; no son # de origen ambiental. hist(all.out$PValue[all.out$Total &lt;= limit &amp; all.out$Total &gt; 0], xlab = &quot;P-value&quot;, main = &quot;&quot;, col = &quot;grey80&quot; ) 5.10 Ejercicio: detecci√≥n de droplets vac√≠os ¬øPor qu√© emptyDrops() regresa valores NA? 6 ¬øLos valores p son iguales entre e.out y all.out? 7 ¬øSon iguales si obtienes el subconjunto de valores que no son NA? 8 5.11 Filtrado de expresi√≥n mitocondrial adicional Despu√©s de filtar los droplets, el filtrado por expresi√≥n mitocondrial nos va a ayudar a eliminar c√©lulas de baja calidad. sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)] is.mito &lt;- grep(&quot;^MT-&quot;, rowData(sce.pbmc)$Symbol) sce.pmbc &lt;- addPerCellQC(sce.pbmc, subsets = list(MT = is.mito)) discard.mito &lt;- isOutlier(sce.pmbc$subsets_MT_percent, type = &quot;higher&quot;) plot( sce.pmbc$sum, sce.pmbc$subsets_MT_percent, log = &quot;x&quot;, xlab = &quot;Total count&quot;, ylab = &quot;Mitochondrial %&quot; ) abline(h = attr(discard.mito, &quot;thresholds&quot;)[&quot;higher&quot;], col = &quot;red&quot;) 5.12 Ejercicio avanzado Volvamos a crear sce.pbmc para poder usar plotColData() y visualizar la relaci√≥n entre total y los niveles de expresi√≥n mitocondrial (en porcentaje) separando lo que pensamos que son droplets vac√≠os y las c√©lulas de acuerdo a los resultados que ya calculamos de emptyDrops(). El resultado final se ver√° como en la siguiente imagen. No podemos usar nuestro objeto sce.pbmc porque ya eliminamos los droplets vac√≠os al correr sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)]. Por eso tendremos que volver a usar sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE). Una vez que hayamos vuelto a hacer sce.pbmc, tenemos que guardar en ese objeto los resultados de emptyDrops(). Por ejemplo, con sce.pbmc$is_cell &lt;- e.out$FDR &lt;= 0.001. Como e.out$FDR tiene muchos NA, nos conviene filtrar esos datos. Tendremos que volver a correr addPerCellQC() y guardar los resultados en nuestro objeto sce.pbmc. Al final usaremos plotColData() junto con facet_grid(~ sce.pbmc$is_cell). 5.13 Discusi√≥n ¬øConviene eliminar datos? # Eliminemos las c√©lulas de calidad baja # al quedarnos con las columnas del objeto sce que NO # queremos descartar (eso hace el !) filtered &lt;- sce.416b[, !discard2] # Alternativamente, podemos marcar # las c√©lulas de baja calidad marked &lt;- sce.416b marked$discard &lt;- discard2 ¬øC√∫al de estos objetos es m√°s grande? 9 ¬øC√∫al prefieres usar? 10 5.13.1 Un nuevo paquete: ExperimentSubset En BioC2021 presentaron ExperimentSubset que provee otro camino para resolver este dilema. Descripci√≥n gr√°fica de ExperimentSubset. Fuente: vignette ExperimentSubset. 5.14 Explorando datos de forma interactiva con iSEE #rstats / @Bioconductor congrats winners of the 1st Shiny Contest: iSEE https://t.co/oHgGkWqRsJ https://t.co/vZLFvcMBIS ! ‚Äî Bioconductor (@Bioconductor) April 7, 2019 http://bioconductor.org/packages/release/bioc/html/iSEE.html http://bioconductor.org/packages/release/bioc/vignettes/iSEE/inst/doc/basic.html ## Hagamos un objeto sencillo de tipo RangedSummarizedExperiment library(&quot;SummarizedExperiment&quot;) ## ?SummarizedExperiment ## De los ejemplos en la ayuda oficial ## Creamos los datos para nuestro objeto de tipo SummarizedExperiment ## para 200 genes a lo largo de 6 muestras nrows &lt;- 200 ncols &lt;- 6 ## N√∫meros al azar de cuentas set.seed(20210223) counts &lt;- matrix(runif(nrows * ncols, 1, 1e4), nrows) ## Informaci√≥n de nuestros genes rowRanges &lt;- GRanges( rep(c(&quot;chr1&quot;, &quot;chr2&quot;), c(50, 150)), IRanges(floor(runif(200, 1e5, 1e6)), width = 100), strand = sample(c(&quot;+&quot;, &quot;-&quot;), 200, TRUE), feature_id = sprintf(&quot;ID%03d&quot;, 1:200) ) names(rowRanges) &lt;- paste0(&quot;gene_&quot;, seq_len(length(rowRanges))) ## Informaci√≥n de nuestras muestras colData &lt;- DataFrame( Treatment = rep(c(&quot;ChIP&quot;, &quot;Input&quot;), 3), row.names = LETTERS[1:6] ) ## Juntamos ahora toda la informaci√≥n en un solo objeto de R rse &lt;- SummarizedExperiment( assays = SimpleList(counts = counts), rowRanges = rowRanges, colData = colData ) ## Exploremos el objeto resultante rse ## class: RangedSummarizedExperiment ## dim: 200 6 ## metadata(0): ## assays(1): counts ## rownames(200): gene_1 gene_2 ... gene_199 gene_200 ## rowData names(1): feature_id ## colnames(6): A B ... E F ## colData names(1): Treatment ## Explora el objeto rse de forma interactiva library(&quot;iSEE&quot;) if (interactive()) { iSEE::iSEE(rse) } 5.14.1 Ejercicio iSEE con sce.416b Repitamos la imagen que hicimos anteriormente. ## Explora el objeto sce.416b de forma interactiva if (interactive()) { iSEE::iSEE(sce.416b, appTitle = &quot;sce.416b&quot;) } 5.14.2 Datos de LIBD de Tran et al Datos de Tran et al, bioRxiv, 2020. C√≥digo de R para el sitio web: https://github.com/LieberInstitute/10xPilot_snRNAseq-human/tree/master/shiny_apps/tran2021_AMY. 5.14.3 M√°s detalles de iSEE Notas en ingl√©s. 5.15 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:14:03 UTC&quot; proc.time() ## user system elapsed ## 217.461 5.062 245.697 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## AnnotationHub * 3.0.1 2021-06-20 [1] Bioconductor ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocManager 1.30.16 2021-06-15 [1] RSPM (R 4.1.0) ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## BiocVersion 3.13.1 2021-03-19 [2] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## Cairo 1.5-12.2 2020-07-07 [1] RSPM (R 4.1.0) ## circlize 0.4.13 2021-06-09 [1] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## clue 0.3-59 2021-04-16 [1] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## codetools 0.2-18 2020-11-04 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## colourpicker 1.1.0 2020-09-14 [1] RSPM (R 4.1.0) ## ComplexHeatmap 2.8.0 2021-05-19 [1] Bioconductor ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## doParallel 1.0.16 2020-10-16 [1] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils * 1.12.2 2021-07-22 [1] Bioconductor ## DT 0.18 2021-04-14 [1] RSPM (R 4.1.0) ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## ExperimentHub 2.0.0 2021-05-19 [1] Bioconductor ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## foreach 1.5.1 2020-10-15 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## GetoptLong 1.0.5 2020-12-15 [1] RSPM (R 4.1.0) ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] RSPM (R 4.1.0) ## GlobalOptions 0.1.2 2020-06-10 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## htmlwidgets 1.5.3 2020-12-10 [1] RSPM (R 4.1.0) ## httpuv 1.6.1 2021-05-07 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## interactiveDisplayBase 1.30.0 2021-05-19 [1] Bioconductor ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## iSEE * 2.4.0 2021-05-19 [1] Bioconductor ## iterators 1.0.13 2020-10-15 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## later 1.2.0 2021-04-23 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## Matrix * 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## mgcv 1.8-36 2021-06-01 [3] RSPM (R 4.1.0) ## mime 0.11 2021-06-23 [2] RSPM (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [1] RSPM (R 4.1.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## nlme 3.1-152 2021-02-04 [3] CRAN (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## promises 1.2.0.1 2021-02-11 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## rintrojs 0.3.0 2021-06-06 [1] RSPM (R 4.1.0) ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scRNAseq * 2.6.1 2021-05-25 [1] Bioconductor ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## shape 1.4.6 2021-05-19 [1] RSPM (R 4.1.0) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.1.0) ## shinyAce 0.4.1 2019-09-24 [1] RSPM (R 4.1.0) ## shinydashboard 0.7.1 2018-10-17 [1] RSPM (R 4.1.0) ## shinyjs 2.0.0 2020-09-09 [1] RSPM (R 4.1.0) ## shinyWidgets 0.6.0 2021-03-15 [1] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: Ahora tenemos m√°s informaci√≥n en colData(sce.416b)‚Ü©Ô∏é with(colData(sce.416b), boxplot(detected ~ block))‚Ü©Ô∏é S√≠, usando table(qc.lib , qc.spike) y table(qc.lib , qc.mito).‚Ü©Ô∏é discard de table(discard, discard2)‚Ü©Ô∏é S√≠, usando table(discard, discard2, discard3)‚Ü©Ô∏é Debajo de lower son considerados droplets vac√≠os. Solo se usan para la correci√≥n estad√≠stica de pruebas m√∫ltiples.‚Ü©Ô∏é No, debido a los NAs.‚Ü©Ô∏é S√≠: identical(e.out$PValue[!is.na(e.out$FDR)], all.out$PValue[!is.na(e.out$FDR)]).‚Ü©Ô∏é marked es m√°s grande que filtered‚Ü©Ô∏é Yo prefiero usar marked si tengo suficiente memoria para usarlo.‚Ü©Ô∏é "],["normalizaci√≥n-de-datos.html", "6 Normalizaci√≥n de datos 6.1 Material 6.2 Motivaci√≥n 6.3 Datos 6.4 Normalizaci√≥n por escalamiento (scaling normalization) 6.5 Normalizaci√≥n por decircunvoluci√≥n (deconvolution) 6.6 Transformaci√≥n logat√≠tmica 6.7 Otras normalizaciones 6.8 Notas finales 6.9 Adicionales 6.10 Agradecimientos 6.11 Detalles de la sesi√≥n de R Patrocinadores", " 6 Normalizaci√≥n de datos Instructora: Ana Beatriz Villase√±or Altamirano 6.1 Material Diapositivas de Peter Hickey: Ve las diapositivas aqu√≠ Cap√≠tulo de OSCA: Ve el cap√≠tulo del libro OSCA aqu√≠ 6.2 Motivaci√≥n Al igual que otras tecnolog√≠as, single-cell RNA-seq (scRNA-seq) tiene errores sistem√°ticos y es importante conocerlos. Dentro de los m√°s comunes se encuentran la captura de cDNA y la amplificaci√≥n de PCR que se lleva acabo por c√©lula. Tener poco material de inicio dificulta lograr una preparaci√≥n de libreria consistente dando lugar a errores sistem√°ticos. Figura tomada de [1] La normalizaci√≥n tiene como objetivo remover est√°s diferencias sistem√°ticas para que no interfieran cuando comparamos los perfiles de expresi√≥n entre c√©lulas. Al normalizar los datos, las diferencias observadas entre poblaciones c√©lulares o condiciones son debido a la biolog√≠a y no por factores t√©cnicos. 6.2.1 Ejercicio: Conceptos b√°sicos Da ejemplos de sesgos t√©cnicos (TIP: ¬øQu√© es RPKM?). ¬øQu√© es correci√≥n por lote (batch effect correction)? Da un ejemplo. ¬øCu√°les son las diferencias entre correci√≥n por lote y normalizaci√≥n? 6.3 Datos Usaremos el dataset de Zeisel. Tipos celulares en cerebro de rat√≥n (oligodendrocitos, microglias, neuronas, etc.) Procesado con STRT-seq (similar a CEL-seq), un sistema de microfluio. 3005 c√©lulas y 18441 genes Contiene UMIs library(&quot;scRNAseq&quot;) sce.zeisel &lt;- ZeiselBrainData(ensembl = TRUE) sce.zeisel ## class: SingleCellExperiment ## dim: 18441 3005 ## metadata(0): ## assays(1): counts ## rownames(18441): ENSMUSG00000029669 ENSMUSG00000046982 ... ## ENSMUSG00000064337 ENSMUSG00000065947 ## rowData names(2): featureType originalName ## colnames(3005): 1772071015_C02 1772071017_G12 ... 1772066098_A12 ## 1772058148_F03 ## colData names(10): tissue group # ... level1class level2class ## reducedDimNames(0): ## mainExpName: endogenous ## altExpNames(2): ERCC repeat 6.3.1 Ejercicio: QC ¬øCu√°ntos genes son mitocondriales? (TIP: is.mito) ¬øCu√°ntos genes tienen: bajas cuentas de librer√≠a, bajos features, alto porcentaje de expresi√≥n de ERCC, alto porcentaje de genes MT? ¬øCu√°ntas c√©lulas descartamos? (TIP: perCellQCMetrics y quickPerCellQC) Gr√°fica los resultados 6.4 Normalizaci√≥n por escalamiento (scaling normalization) La normalizaci√≥n por escalamiento es la estrategia m√°s simple y usada. Representa el estimado del sesgo relativo en cada c√©lula. Se realiza dividiendo todas las cuentas de cada c√©lula por un factor de escalamiento espec√≠fico para cada una. Este factor de escalamiento se le conoce como Library Size factor. \\[ CuentasNormalizadas = Cuentas / Library Size factor\\] Suposici√≥n: Cualquier sesgo espec√≠fico en cada c√©lula (e.j. eficiencia en la captura o en la amplificaci√≥n) afecta a todos los genes de igual manera a trav√©s de escalar por el promedio esperado de cuentas para dicha c√©lula. Los valores de expresi√≥n normalizados pueden ser usados por an√°lisis posteriores como clustering o reducci√≥n de dimenciones. 6.4.1 Tama√±o de biblioteca (Library Size) Tama√±o de biblioteca (Library Size): La suma total de las cuentas a tr√°ves de todos los genes en una c√©lula. \\[Library Size_{cell} = \\sum_{n=1}^{j} gene\\] Donde \\(j\\) es el n√∫mero total de genes y \\(gene\\) es el n√∫mero de cuentas por gen para cada c√©lula. El valor de library size es el que asumimos que escala con cualquier sesgo espec√≠fico en cada c√©lula. Para escalar los datos ocuparemos un factor de escalamiento llamado Library Size factor. \\[ Library Size \\propto Library Size factor \\] Se calcula usando library size: \\[ Library Size factor = {Library Size} / {mean(Library Size)}\\] Y se define de tal manera que el promedio de Library Size factor en todas las c√©lulas es igual a 1. \\[ mean(Library Size factor) = 1 \\] Lo que nos permite que los valores normalizados est√°n en la misma escala y pueden ser √∫tiles para la interpretaci√≥n. # Estimar tama√±os de librer√≠as lib.sf.zeisel &lt;- librarySizeFactors(sce.zeisel) # Examina la distribuci√≥n de los tama√±os de librer√≠as # que acabamos de estimar summary(lib.sf.zeisel) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.1754 0.5682 0.8669 1.0000 1.2758 4.0651 hist(log10(lib.sf.zeisel), xlab = &quot;Log10[Library Size factor]&quot;, col = &quot;grey80&quot;) 6.4.2 Ejercicio: library Size Revisa los detalles (Details) en ?scater::librarySizeFactors Calcula library Size ls.zeisel ¬øSon id√©nticos ls.zeisel y lib.sf.zeisel? ¬øSon proporcionales? Calcula lib.sf.zeisel de forma manual. TIP: Checa el c√≥digo fuente 6.4.3 Puntos finales Normalizar por Library Size factor asume que no hay desigualdad en la cantidad de genes differencialmente expresados (DE) entre dos c√©lulas. Es decir, que para cada grupo de genes sobre-expresados, debe existir un grupo de genes sub-expresados en la misma magnitud, cuando esto no pasa se le conoce como sesgo de composici√≥n (Ve√°se a continuaci√≥n). Para an√°lisis exploratorios, la precisi√≥n de la normalizaci√≥n no es un punto mayor a considerar. El sesgo por composici√≥n normalmente no afecta la separaci√≥n de los clusters, solo la magnitud. La normalizaci√≥n por Library Size factor suele ser suficiente en algunas ocasiones donde se busca identificar clusters y los marcadores de los clusters. 6.5 Normalizaci√≥n por decircunvoluci√≥n (deconvolution) Un sesgo t√©cnico que es importante considerar es el sesgo de composici√≥n de RNA (transcriptoma). Supongamos que un gen X (o grupo de genes) se expresa en mayor cantidad en la c√©lula A comparado a la c√©lula B. Esto significa que m√°s recursos fueron tomados por el gen X, disminuyendo la covertura de los dem√°s. ¬øQu√© pasa si escalamos por tama√±o de biblioteca? Figura tomada de [2] Este problema ha sido estudiado en bulk RNA-seq, DESeq2::estimateSizeFactorsFromMatrix() y edgeR::calcNormFactors(), contemplan este sesgo. Se assume que la mayor√≠a de genes no estar√°n DE entre las muestras (en nuestro caso c√©lulas) y cualquier diferencia entre los genes non-DE representa un sesgo el cual se remueve (calculando un factor de normalizaci√≥n). Sin embargo, single-cell RNA-seq tiene muchas cuentas bajas y ceros debido a limitaciones en la tecnolog√≠a y no necesariamente indica ausencia de expresi√≥n. El m√©todo de scran resuelve este problema juntando las cuentas de varias c√©lulas (pool) para incrementar el tama√±o de las cuentas y obtener un factor de estimaci√≥n que remueva el sesgo de composici√≥n de manera m√°s precisa. Este factor calculado con las cuentas pool se les regresa individualmente a cada c√©lula mediante decircunvoluci√≥n (deconvolution). Utilizando este factor se normalizan los datos con scran::calculateSumFactors(). # Normalizaci√≥n por decircunvoluci√≥n (deconvolution) library(&quot;scran&quot;) # Pre-clustering set.seed(100) clust.zeisel &lt;- quickCluster(sce.zeisel) # Calcula factores de tama√±o para la decircunvoluci√≥n (deconvolution) deconv.sf.zeisel &lt;- calculateSumFactors(sce.zeisel, clusters = clust.zeisel, min.mean = 0.1) # Examina la distribuci√≥n de los factores de tama√±o summary(deconv.sf.zeisel) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.1282 0.4859 0.8248 1.0000 1.3194 4.6521 hist(log10(deconv.sf.zeisel), xlab = &quot;Log10[Deconvolution size factor]&quot;, col = &quot;grey80&quot; ) plot(lib.sf.zeisel, deconv.sf.zeisel, xlab = &quot;Library size factor&quot;, ylab = &quot;Deconvolution size factor&quot;, log = &quot;xy&quot;, pch = 16 ) abline(a = 0, b = 1, col = &quot;red&quot;) 6.5.1 Ejercicios: deconvolution ¬øC√∫antos clusters r√°pidos obtuvimos? ¬øC√∫antas c√©lulas por cluster obtuvimos? ¬øC√∫antos clusters r√°pidos obtendr√≠amos si cambiamos el tama√±o m√≠nimo a 200? Usa 100 como la semilla (seed). ¬øC√∫antas l√≠neas ves en la gr√°fica? 6.5.2 Puntos finales La normalizaci√≥n por decircunvoluci√≥n (deconvolution) mejora los resultados para an√°lisis posteriores de una manera m√°s precisa que los m√©todos para bulk RNA-seq. scran algunas veces alcula factores negativos o ceros lo cual altera la matrix de expresi√≥n normalizada. ¬°Checa los factores que calculas! summary(deconv.sf.zeisel) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.1282 0.4859 0.8248 1.0000 1.3194 4.6521 Si obtienes factores negativos intenta variar el n√∫mero de clusters, checa si incrementar el n√∫mero de c√©lulas por cluster te dan factores positivos. 6.6 Transformaci√≥n logat√≠tmica 6.6.1 Motivaci√≥n ¬øQu√© gen es m√°s interesante? Gen X: el promedio de expresi√≥n en el tipo celular A: 50 y B: 10 Gen Y: el promedio de expresi√≥n en el tipo celular A: 1100 y B: 1000 50 - 10 ## [1] 40 1100 - 1000 ## [1] 100 log(50) - log(10) ## [1] 1.609438 log(1100) - log(1000) ## [1] 0.09531018 Una vez calculados los factores de normalizaci√≥n con computeSumFactors(), podemos calular las cuentas en escala logaritmica usando logNormCounts(). Estos valores resultantes son valores de expresi√≥n normalizados transformados en escala logar√≠tmica. # Normalization # set.seed(100) # clust.zeisel &lt;- quickCluster(sce.zeisel) # sce.zeisel &lt;- computeSumFactors(sce.zeisel, cluster=clust.zeisel, min.mean=0.1) # Log transformation sce.zeisel &lt;- scater::logNormCounts(sce.zeisel) assayNames(sce.zeisel) ## [1] &quot;counts&quot; &quot;logcounts&quot; 6.6.2 Ejercicio: Transformaci√≥n logat√≠tmica ¬øQu√© es una pseudo-cuenta? ¬øPorqu√© se usa? ¬øQu√© valor de pseudo-cuenta usa logNormCounts()? ¬øQu√© es la opci√≥n downsample=TRUE? 6.7 Otras normalizaciones Te invitamos a leer m√°s sobre otras formas de normalizar, un lugar para empezar lo puedes encontrar en el curso del Sanger Institute. Si estas interesad@ en diferencias en el contenido total de RNA en cada c√©lula checa la normalizaci√≥n por spike-ins. La cual asume que los spike-ins fueron a√±adidos en un nivel constante en cada c√©lula. Si tienes resultados donde el library size est√° asociado a tus datos a pesar de haber normalizado checa la opci√≥n de downsample=TRUE dentro de la funci√≥n de logNormCounts(). 6.7.1 Seurat La normalizaci√≥n de Seurat con NormalizeData() (tomado de aqu√≠): Dividir cada c√©lula por el n√∫mero total de mol√©culas medidas en la c√©lula. - ¬øSer√° library size? Multiplicar ese n√∫mero por un scaling factor (e.j. 10000) Sumar 1 y tomar el logaritmo natural. library(&quot;Seurat&quot;) # Create a Seurat obj sce &lt;- sce.zeisel sce &lt;- removeAltExps(sce) seurat.zeisel &lt;- as.Seurat(sce, counts = &quot;counts&quot;, data = NULL) seurat.zeisel ## An object of class Seurat ## 18441 features across 2815 samples within 1 assay ## Active assay: endogenous (18441 features, 0 variable features) # Normalize using Seurat function seurat.zeisel &lt;- NormalizeData(seurat.zeisel, normalization.method = &quot;LogNormalize&quot;) # Compare Total counts per cell after normalization ls.seurat &lt;- colSums(seurat.zeisel[[SingleCellExperiment::mainExpName(x = sce)]]@data) ## Relacionado a ## https://github.com/satijalab/seurat/blob/9b3892961c9e1bf418af3bbb1bc79950adb481d7/R/objects.R#L1041-L1046 ## donde podemos ver como Seurat convierte el objeto de SingleCellExperiment ## a un objeto de Seurat summary(ls.seurat) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 1460 2942 3693 3534 4097 4778 hist(ls.seurat) # Trying to replicate it ls.zeisel &lt;- colSums(counts(sce.zeisel)) summary(ls.zeisel) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 2623 8497 12964 14955 19080 60792 step1 &lt;- t(counts(sce.zeisel)) / ls.zeisel # matrix(2,2,2,2) /c(1,2) step2 &lt;- step1 * 10000 step3 &lt;- t(log1p(step2)) ls.steps &lt;- colSums(step3) summary(ls.steps) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 1460 2942 3693 3534 4097 4778 plot(ls.seurat, ls.steps) # Compare with deconv normalization ls.log &lt;- colSums(logcounts(sce.zeisel)) plot(ls.seurat, ls.log) Nota: scanpy ocupa un factor de normalizaci√≥n igual que Seurat. 6.8 Notas finales 6.8.1 Ejercicio: Conceptos b√°sicos Da ejemplos de sesgos t√©cnicos (TIP: ¬øQu√© es RPKM?). ‚ÄúTechnical biases tend to affect genes in a similar manner, or at least in a manner related to their biophysical properties (e.g., length, GC content)‚Äù - hbctraining Algunos ejemplos de los sesgos t√©cnicos que se contemplan son la profundidad de secuenciaci√≥n y la longitud del gen. Profundidad de secuenciaci√≥n: Es necesario contemplarlo para comparar entre muestras, en este caso c√©lulas. Figura tomada de [2] Longitud del gen: Es necesario contemplarlo para comparar entre genes. Figura tomada de [2] ¬øQu√© es correci√≥n por lote (batch effect correction)? Da un ejemplo. ‚ÄúLarge single-cell RNA sequencing (scRNA-seq) projects usually need to generate data across multiple batches due to logistical constraints. However, the processing of different batches is often subject to uncontrollable differences, e.g., changes in operator, differences in reagent quality. This results in systematic differences in the observed expression in cells from different batches, which we refer to as ‚Äúbatch effects‚Äù. Batch effects are problematic as they can be major drivers of heterogeneity in the data, masking the relevant biological differences and complicating interpretation of the results\" -OSCA ¬øCu√°les son las diferencias entre correci√≥n por lote y normalizaci√≥n? ‚ÄúNormalization occurs regardless of the batch structure and only considers technical biases, while batch correction - as the name suggests - only occurs across batches and must consider both technical biases and biological differences. Technical biases tend to affect genes in a similar manner, or at least in a manner related to their biophysical properties (e.g., length, GC content), while biological differences between batches can be highly unpredictable‚Äù -OSCA 6.8.2 Ejercicio: QC ¬øCu√°ntos genes son mitocondriales? (recuerdas is.mito) length(is.mito) ## [1] 34 ¬øCu√°ntos genes tienen: bajas cuentas de librer√≠a, bajos features, alto porcentaje de expresi√≥n de ERCC, alto porcentaje de genes MT? ¬øCu√°ntas c√©lulas descartamos? (TIP: perCellQCMetrics y quickPerCellQC) colSums(as.data.frame(qc)) ## low_lib_size low_n_features high_altexps_ERCC_percent ## 0 3 66 ## high_subsets_Mt_percent discard ## 128 190 Gr√°fica los resultados # Plots colData(unfiltered) &lt;- cbind(colData(unfiltered), stats) unfiltered$discard &lt;- qc$discard gridExtra::grid.arrange( plotColData(unfiltered, y = &quot;sum&quot;, colour_by = &quot;discard&quot;) + scale_y_log10() + ggtitle(&quot;Cuentas Totales&quot;), plotColData(unfiltered, y = &quot;detected&quot;, colour_by = &quot;discard&quot;) + scale_y_log10() + ggtitle(&quot;Features (genes) detectados&quot;), plotColData(unfiltered, y = &quot;altexps_ERCC_percent&quot;, colour_by = &quot;discard&quot; ) + ggtitle(&quot;ERCC %&quot;), plotColData(unfiltered, y = &quot;subsets_Mt_percent&quot;, colour_by = &quot;discard&quot; ) + ggtitle(&quot;Mito %&quot;), ncol = 2 ) 6.8.3 Ejercicio: library Size Revisa los detalles (Details) en ?scater::librarySizeFactors Calcula library size ls.zeisel ls.zeisel &lt;- colSums(counts(sce.zeisel)) summary(ls.zeisel) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 2623 8497 12964 14955 19080 60792 hist(log10(ls.zeisel), xlab = &quot;Log10[Library size]&quot;, col = &quot;grey80&quot;) ¬øSon id√©nticos ls.zeisel y lib.sf.zeisel? identical(lib.sf.zeisel, ls.zeisel) ## [1] FALSE ¬øSon proporcionales? # Checamos proporcionalidad plot( ls.zeisel, lib.sf.zeisel, log = &quot;xy&quot;, main = &quot;Proporcionalidad&quot;, xlab = &quot;Library size&quot;, ylab = &quot; Library size factor&quot; ) Calcula lib.sf.zeisel de forma manual. TIP: Checa el c√≥digo fuente ## Ahora asegurate que su media sea 1 (unity mean) lib_size_factors &lt;- ls.zeisel / mean(ls.zeisel) summary(lib_size_factors) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.1754 0.5682 0.8669 1.0000 1.2758 4.0651 identical(lib_size_factors, lib.sf.zeisel) ## [1] TRUE 6.8.4 Ejercicios: deconvolution ¬øC√∫antos clusters r√°pidos obtuvimos? levels(clust.zeisel) ## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot; &quot;10&quot; &quot;11&quot; &quot;12&quot; ¬øC√∫antas c√©lulas por cluster obtuvimos? cells_cluster &lt;- sort(table(clust.zeisel)) cells_cluster ## clust.zeisel ## 12 7 4 6 10 1 3 11 2 8 5 9 ## 113 123 140 224 231 243 252 259 281 300 324 325 barplot(cells_cluster) ¬øC√∫antos clusters r√°pidos obtendr√≠amos si cambiamos el tama√±o m√≠nimo a 200? Usa 100 como la semilla (seed). set.seed(100) sort(table(quickCluster(sce.zeisel, min.size = 200))) ## ## 5 9 6 1 3 10 2 4 8 7 ## 224 231 236 243 252 259 281 324 325 440 ¬øC√∫antas l√≠neas ves en la gr√°fica? plot(lib.sf.zeisel, deconv.sf.zeisel, xlab = &quot;Library size factor&quot;, ylab = &quot;Deconvolution size factor&quot;, log = &quot;xy&quot;, pch = 16, col = as.integer(factor(sce.zeisel$level1class)) ) abline(a = 0, b = 1, col = &quot;red&quot;) abline(a = -.2, b = 0.95, col = &quot;red&quot;) abline(a = 0.08, b = 1, col = &quot;red&quot;) 6.8.5 Ejercicio: Transformaci√≥n logat√≠tmica ¬øQu√© es una pseudo-cuenta? Un n√∫mero que se agrega para poder sacar el logar√≠tmo ¬øPorqu√© se usa? Por que log(0) = -Inf y produce error m√°s adelante. ¬øQu√© valor de pseudo-cuenta usa logNormCounts()? pseudo.count = 1 ¬øQu√© es la opci√≥n downsample=TRUE? OSCA: Downsampling. Para cuando existe un efecto en los valores que se asocia a la library size a pesar de haber nomalizado. Funciones interesantes para despu√©s de normalizar # sce.zeisel &lt;- runPCA(sce.zeisel) # plotPCA(sce.zeisel, colour_by = &quot;level1class&quot;) # plotRLE(sce.zeisel, exprs_values = &quot;logcounts&quot;, colour_by = &quot;level1class&quot;) 6.9 Adicionales [1] 2018 BioInfoSummer Workshop [2] HBC training 6.10 Agradecimientos Este curso est√° basado en el libro Orchestrating Single Cell Analysis with Bioconductor de Aaron Lun, Robert Amezquita, Stephanie Hicks y Raphael Gottardo, adem√°s del curso de scRNA-seq para WEHI creado por Peter Hickey. Y en el material de la comunidadbioinfo/cdsb2020 con el permiso de Leonardo Collado-Torres. 6.11 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:15:33 UTC&quot; proc.time() ## user system elapsed ## 80.963 5.254 89.812 options(width = 120) sessioninfo::session_info() ## Registered S3 method overwritten by &#39;cli&#39;: ## method from ## print.boxx spatstat.geom ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## abind 1.4-5 2016-07-21 [1] RSPM (R 4.1.0) ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## AnnotationHub 3.0.1 2021-06-20 [1] Bioconductor ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocManager 1.30.16 2021-06-15 [1] RSPM (R 4.1.0) ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## BiocVersion 3.13.1 2021-03-19 [2] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## codetools 0.2-18 2020-11-04 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## data.table 1.14.0 2021-02-21 [1] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## deldir 0.2-10 2021-02-16 [1] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## ExperimentHub 2.0.0 2021-05-19 [1] Bioconductor ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## fitdistrplus 1.1-5 2021-05-28 [1] RSPM (R 4.1.0) ## future 1.21.0 2020-12-10 [1] RSPM (R 4.1.0) ## future.apply 1.7.0 2021-01-04 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] RSPM (R 4.1.0) ## ggridges 0.5.3 2021-01-08 [1] RSPM (R 4.1.0) ## globals 0.14.0 2020-11-22 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## goftest 1.2-2 2019-12-02 [1] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## here 1.0.1 2020-12-13 [1] RSPM (R 4.1.0) ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## htmlwidgets 1.5.3 2020-12-10 [1] RSPM (R 4.1.0) ## httpuv 1.6.1 2021-05-07 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## ica 1.0-2 2018-05-24 [1] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## interactiveDisplayBase 1.30.0 2021-05-19 [1] Bioconductor ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## KernSmooth 2.23-20 2021-05-03 [3] CRAN (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## later 1.2.0 2021-04-23 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## leiden 0.3.9 2021-07-27 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## listenv 0.8.0 2019-12-05 [1] RSPM (R 4.1.0) ## lmtest 0.9-38 2020-09-09 [1] RSPM (R 4.1.0) ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## MASS 7.3-54 2021-05-03 [3] CRAN (R 4.1.0) ## Matrix 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## mgcv 1.8-36 2021-06-01 [3] RSPM (R 4.1.0) ## mime 0.11 2021-06-23 [2] RSPM (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [1] RSPM (R 4.1.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## nlme 3.1-152 2021-02-04 [3] CRAN (R 4.1.0) ## parallelly 1.27.0 2021-07-19 [1] RSPM (R 4.1.0) ## patchwork 1.1.1 2020-12-17 [1] RSPM (R 4.1.0) ## pbapply 1.4-3 2020-08-18 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## plotly 4.9.4.1 2021-06-18 [1] RSPM (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## polyclip 1.10-0 2019-03-14 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## promises 1.2.0.1 2021-02-11 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## RANN 2.6.1 2019-01-08 [1] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RcppAnnoy 0.0.19 2021-07-30 [1] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## reticulate 1.20 2021-05-03 [1] RSPM (R 4.1.0) ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## ROCR 1.0-11 2020-05-02 [1] RSPM (R 4.1.0) ## rpart 4.1-15 2019-04-12 [3] CRAN (R 4.1.0) ## rprojroot 2.0.2 2020-11-15 [2] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scattermore 0.7 2020-11-24 [1] RSPM (R 4.1.0) ## scran * 1.20.1 2021-05-24 [1] Bioconductor ## scRNAseq * 2.6.1 2021-05-25 [1] Bioconductor ## sctransform 0.3.2 2020-12-16 [1] RSPM (R 4.1.0) ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## Seurat * 4.0.3 2021-06-10 [1] RSPM (R 4.1.0) ## SeuratObject * 4.0.2 2021-06-09 [1] RSPM (R 4.1.0) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## spatstat.core 2.3-0 2021-07-16 [1] RSPM (R 4.1.0) ## spatstat.data 2.1-0 2021-03-21 [1] RSPM (R 4.1.0) ## spatstat.geom 2.2-2 2021-07-12 [1] RSPM (R 4.1.0) ## spatstat.sparse 2.0-0 2021-03-16 [1] RSPM (R 4.1.0) ## spatstat.utils 2.2-0 2021-06-14 [1] RSPM (R 4.1.0) ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## survival 3.2-11 2021-04-26 [3] CRAN (R 4.1.0) ## tensor 1.5 2012-05-05 [1] RSPM (R 4.1.0) ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyr 1.1.3 2021-03-03 [1] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## zoo 1.8-9 2021-03-09 [1] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["selecci√≥n-de-genes.html", "7 Selecci√≥n de genes 7.1 Diapositivas de Peter Hickey 7.2 Motivaci√≥n 7.3 Selecci√≥n de features (genes) 7.4 Dataset ilustrativo: PBMC4k 10X sin filtrar 7.5 Cuantificando la varianza por gen 7.6 Coeficiente de variaci√≥n de las cuentas 7.7 Varianza de los log-counts vs coeficiente de variaci√≥n 7.8 Detalles de la sesi√≥n de R Patrocinadores", " 7 Selecci√≥n de genes Instructora: Yalbi I. Balderas-Mart√≠nez 7.1 Diapositivas de Peter Hickey Ver las diapositivas originales aqu√≠ 7.2 Motivaci√≥n Usualmente usamos datos scRNA-seq para caracterizar la heterogeneidad entre c√©lulas Para hacer esto, usamos m√©todos como el clustering y la reducci√≥n de dimensionalidad Esto involucra resumir las diferencias por gen en una sola medida de (dis)similitud entre un par de c√©lulas ¬øCu√°les genes deber√≠amos usar para calcular esta medida de (dis)similitud? 7.3 Selecci√≥n de features (genes) La elecci√≥n de los features tiene un mayor impacto en qu√© tan similares decidimos que son las c√©lulas ‚ûï Features que contienen informaci√≥n √∫til biol√≥gica ‚ûñ Features que contienen ruido aleatorio üëâ Efectos laterales al reducir la dimensionalidad de los datos Deseamos seleccionar los genes altamente variables (High Variable Genes HVGs). Genes con una variaci√≥n incrementada en comparaci√≥n con otros genes que est√°n siendo afectados por ruido t√©cnico u otra variaci√≥n biol√≥gica que no es de nuestro inter√©s. 7.4 Dataset ilustrativo: PBMC4k 10X sin filtrar 7.4.1 Descargar datos # Usemos datos de pbmc4k library(BiocFileCache) bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath(bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot; )) untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc4k&quot;)) library(DropletUtils) library(Matrix) fname &lt;- file.path(tempdir(), &quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;) sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE) sce.pbmc ## class: SingleCellExperiment ## dim: 33694 737280 ## metadata(1): Samples ## assays(1): counts ## rownames(33694): ENSG00000243485 ENSG00000237613 ... ENSG00000277475 ## ENSG00000268674 ## rowData names(2): ID Symbol ## colnames(737280): AAACCTGAGAAACCAT-1 AAACCTGAGAAACCGC-1 ... ## TTTGTCATCTTTAGTC-1 TTTGTCATCTTTCCTC-1 ## colData names(2): Sample Barcode ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0): Dataset ‚ÄúC√©lulas mononucleares humanas de sangre perif√©rica‚Äù de 10X Genomics Descripci√≥n aqu√≠ 11 7.4.2 Anotaci√≥n # Anotaci√≥n de los genes library(scater) rownames(sce.pbmc) &lt;- uniquifyFeatureNames( rowData(sce.pbmc)$ID, rowData(sce.pbmc)$Symbol ) library(EnsDb.Hsapiens.v86) location &lt;- mapIds(EnsDb.Hsapiens.v86, keys = rowData(sce.pbmc)$ID, column = &quot;SEQNAME&quot;, keytype = &quot;GENEID&quot; ) # Detecci√≥n de _droplets_ con c√©lulas set.seed(100) e.out &lt;- emptyDrops(counts(sce.pbmc)) sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)] 7.4.3 Control de calidad # Control de calidad stats &lt;- perCellQCMetrics(sce.pbmc, subsets = list(Mito = which(location == &quot;MT&quot;)) ) high.mito &lt;- isOutlier(stats$subsets_Mito_percent, type = &quot;higher&quot; ) sce.pbmc &lt;- sce.pbmc[, !high.mito] # Normalizaci√≥n de los datos library(scran) set.seed(1000) clusters &lt;- quickCluster(sce.pbmc) sce.pbmc &lt;- computeSumFactors(sce.pbmc, cluster = clusters) sce.pbmc &lt;- logNormCounts(sce.pbmc) 7.5 Cuantificando la varianza por gen 7.5.1 Varianza de los log-counts El enfoque m√°s simple para cuantificar la variaci√≥n per-feature es simplemente calcular la varianza de los log-counts ‚ûï Selecci√≥n del feature basado en los log-counts (que ser√°n usadas en los an√°lisis m√°s adelante) ‚ö†Ô∏è La transformaci√≥n log no logra la estabilizaci√≥n de la varianza perfecta, as√≠ que se requiere modelar la relaci√≥n de la varianza-media de los features. 7.5.2 Enfoque simple Calcular la varianza de los log-counts para cada gen (ignorando grupos experimentales) Ordenar los genes del m√°s-al-menos variable 7.5.3 Un enfoque m√°s sofisticado Calcular la varianza de los log-counts para cada gen (ignorando grupos experimentales) Modelar la relaci√≥n de la media de la varianza de los log-counts para estimar la variaci√≥n t√©cnica Estimar la varianza biol√≥gica sustrayendo la varianza t√©cnica de la varianza total Ordenar los genes de la variable de mayor-a-menor biol√≥gicamente 7.5.4 Supuestos # Varianza de las log-counts library(scran) dec.pbmc &lt;- modelGeneVar(sce.pbmc) ü§ì El supuesto es que a cualquier abundancia dada, la abundancia de los perfiles de expresi√≥n de la mayor√≠a de los genes est√°n dominados por el ruido aleatorio t√©cnico ü§ì Por lo consiguiente, una tendencia representa un estimado del ruido t√©cnico como una funci√≥n de la abundancia ü§ì Podemos entonces descomponer la varianza total de cada gen en un componente t√©cnico y uno biol√≥gico ü§ì Genes con una gran varianza biol√≥gica son considerados interesantes 7.5.5 Visualizando la media y varianza # Visualicemos la relaci√≥n entre la media y la varianza fit.pbmc &lt;- metadata(dec.pbmc) plot(fit.pbmc$mean, fit.pbmc$var, xlab = &quot;Mean of log-expression&quot;, ylab = &quot;Variance of log-expression&quot; ) curve(fit.pbmc$trend(x), col = &quot;dodgerblue&quot;, add = TRUE, lwd = 2) 7.5.6 Ordenando genes interesantes # Ordenemos por los genes m√°s interesantes para checar # los datos dec.pbmc[order(dec.pbmc$bio, decreasing = TRUE), ] ## DataFrame with 33694 rows and 6 columns ## mean total tech bio p.value FDR ## &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; ## LYZ 1.95605 5.05854 0.835343 4.22320 1.10535e-270 2.17412e-266 ## S100A9 1.93416 4.53551 0.835439 3.70007 2.71038e-208 7.61579e-205 ## S100A8 1.69961 4.41084 0.824342 3.58650 4.31574e-201 9.43181e-198 ## HLA-DRA 2.09785 3.75174 0.831239 2.92050 5.93943e-132 4.86761e-129 ## CD74 2.90176 3.36879 0.793188 2.57560 4.83932e-113 2.50486e-110 ## ... ... ... ... ... ... ... ## TMSB4X 6.08142 0.441718 0.679215 -0.237497 0.992447 1 ## PTMA 3.82978 0.486454 0.731275 -0.244821 0.990002 1 ## HLA-B 4.50032 0.486130 0.739577 -0.253447 0.991376 1 ## EIF1 3.23488 0.482869 0.768946 -0.286078 0.995135 1 ## B2M 5.95196 0.314948 0.654228 -0.339280 0.999843 1 7.6 Coeficiente de variaci√≥n de las cuentas El coeficiente de variaci√≥n de las cuentas al cuadrado (CV2) es una alternativa a la varianza de los log-counts üëâ Se calcula usando las cuentas en lugar de los log-counts ü§ì CV es la tasa de la desviaci√≥n est√°ndar a la media y est√° muy relacionada con el par√°metro de dispersi√≥n de la distribuci√≥n binomial negativa usada en edgeR y DESeq2 7.6.1 Coeficiente de variaci√≥n # Coeficiente de variaci√≥n dec.cv2.pbmc &lt;- modelGeneCV2(sce.pbmc) ü§ì Modela la relaci√≥n de la media de la varianza cuando se considera la relevancia de cada gen ü§ì Asume que la mayor√≠a de los genes contienen ruido aleatorio y que la tendencia captura la mayor√≠a de la variaci√≥n t√©cnica ü§ì Genes con un gran CV2 que se desv√≠an fuertemente de la tendencia es probable que representen genes afectados por la estructura biol√≥gica ü§ì Usa la tasa (en lugar de la diferencia) del CV2 a la tendencia 7.6.2 Visualizando el coeficiente de variaci√≥n 7.6.3 Genes por coeficiente de variaci√≥n # Ordenemos por los genes m√°s interesantes para checar # los datos dec.cv2.pbmc[order(dec.cv2.pbmc$ratio, decreasing = TRUE ), ] ## DataFrame with 33694 rows and 6 columns ## mean total trend ratio p.value FDR ## &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; ## PPBP 2.2437397 132.364 0.803689 164.696 0 0 ## PRTFDC1 0.0658743 3197.564 20.266829 157.773 0 0 ## HIST1H2AC 1.3731487 175.035 1.176934 148.721 0 0 ## FAM81B 0.0477082 3654.419 27.902078 130.973 0 0 ## PF4 1.8333127 109.451 0.935484 116.999 0 0 ## ... ... ... ... ... ... ... ## AC023491.2 0 NaN Inf NaN NaN NaN ## AC233755.2 0 NaN Inf NaN NaN NaN ## AC233755.1 0 NaN Inf NaN NaN NaN ## AC213203.1 0 NaN Inf NaN NaN NaN ## FAM231B 0 NaN Inf NaN NaN NaN 7.7 Varianza de los log-counts vs coeficiente de variaci√≥n Generalmente se usa la varianza de los log-counts Ambas son medidas efectivas para cuantificar la variaci√≥n en la expresi√≥n g√©nica CV2 tiende a tener otorgar rangos altos en abundancias bajas de genes altamente variables √âstos son dirigidos por una sobreregulaci√≥n en subpoblaciones raras Puede asignar un alto rango a genes que no son de nuestro inter√©s con varianza baja absoluta La variaci√≥n descrita por el CV2 de las cuentas es menos relevante para los procedimientos que operan en los log-counts 7.8 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:17:42 UTC&quot; proc.time() ## user system elapsed ## 126.739 3.218 128.331 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils * 1.12.2 2021-07-22 [1] Bioconductor ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## EnsDb.Hsapiens.v86 * 2.99.0 2021-07-29 [1] Bioconductor ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## Matrix * 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scran * 1.20.1 2021-05-24 [1] Bioconductor ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: Zheng, G. X. Y. et al.¬†Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017).‚Ü©Ô∏é "],["reducci√≥n-de-dimensiones.html", "8 Reducci√≥n de dimensiones 8.1 Diapositivas de Peter Hickey 8.2 Motivaci√≥n 8.3 Reducci√≥n de dimensionalidad 8.4 Dataset ilustrativo: Zeisel 8.5 Dataset ilustrativo: 10x PBMC4k no filtradas 8.6 An√°lisis de Componentes Principales 8.7 Reducci√≥n de dimensionalidad para visualizaci√≥n 8.8 Donde estamos 8.9 Detalles de la sesi√≥n de R Patrocinadores", " 8 Reducci√≥n de dimensiones Instructora: Laura G√≥mez-Romero 8.1 Diapositivas de Peter Hickey Contenido adaptado de: aqu√≠ 8.2 Motivaci√≥n El siguiente paso en el an√°lisis de scRNA-seq usualmente consiste en identificar grupos de c√©lulas ‚Äúsimilares‚Äù Por ejemplo: un an√°lisis de clustering busca identificar c√©lulas con un perfil transcript√≥mico similar al calcular distancias entre ellas Si tuvi√©ramos un dataset con dos genes podr√≠amos hacer una gr√°fica de dos dimensiones para identificar clusters de c√©lulas Pero‚Ä¶ tenemos decenas de miles de genes : Reducci√≥n de dimensionalidad 8.3 Reducci√≥n de dimensionalidad Es poible porque la expresi√≥n de diferentes genes estar√° correlacionada si estos genes son afectados por el mismo proceso biol√≥gico. Por lo tanto, no necesitamos almacenar informaci√≥n independiente para genes individuales. Podemos comprimir m√≥ltiples ‚Äúfeatures‚Äù (genes) en una √≥nica dimensi√≥n. Ventajas: Reduce trabajo computacional en an√°lisis posteriores Reduce el ruido al ‚Äúpromediar‚Äù m√∫tiples genes obteniendo una representaci√≥n m√≥s precisa de los patrones en los datos Permite una graficaci√≥n efectiva en dos dimensiones 8.4 Dataset ilustrativo: Zeisel library(scRNAseq) sce.zeisel &lt;- ZeiselBrainData(ensembl = TRUE) Estudio de tipos celulares en el cerebro de rat√≥n (oligodendrocitos, microglia, neuronas, etc) procesados con el sistema STRT-seq (similar a CEL-Seq) Descripci√≥n aqu√≠ Zeisel, A. et al.¬†Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq. Science 347, 1138-1142 (2015) # Quality control library(scater) is.mito &lt;- which(rowData(sce.zeisel)$featureType == &quot;mito&quot;) stats &lt;- perCellQCMetrics(sce.zeisel, subsets = list(Mt = is.mito) ) qc &lt;- quickPerCellQC(stats, percent_subsets = c(&quot;altexps_ERCC_percent&quot;, &quot;subsets_Mt_percent&quot;) ) sce.zeisel &lt;- sce.zeisel[, !qc$discard] # normalization library(scran) set.seed(1000) clusters &lt;- quickCluster(sce.zeisel) sce.zeisel &lt;- computeSumFactors(sce.zeisel, cluster = clusters ) sce.zeisel &lt;- logNormCounts(sce.zeisel) # variance-modelling dec.zeisel &lt;- modelGeneVarWithSpikes( sce.zeisel, &quot;ERCC&quot; ) 8.5 Dataset ilustrativo: 10x PBMC4k no filtradas library(BiocFileCache) bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath(bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot; )) untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc4k&quot;)) library(DropletUtils) library(Matrix) fname &lt;- file.path(tempdir(), &quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;) sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE) Dataset ‚ÄúC√©lulas mononucleares humanas de sangre perif√©rica‚Äù de 10X Genomics Descripci√≥n aqu√≠ Zheng, G. X. Y. et al.¬†Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017) # gene-annotation library(scater) rownames(sce.pbmc) &lt;- uniquifyFeatureNames( rowData(sce.pbmc)$ID, rowData(sce.pbmc)$Symbol ) library(EnsDb.Hsapiens.v86) location &lt;- mapIds(EnsDb.Hsapiens.v86, keys = rowData(sce.pbmc)$ID, column = &quot;SEQNAME&quot;, keytype = &quot;GENEID&quot; ) # cell-detection set.seed(100) e.out &lt;- emptyDrops(counts(sce.pbmc)) sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)] # quality-control stats &lt;- perCellQCMetrics(sce.pbmc, subsets = list(Mito = which(location == &quot;MT&quot;)) ) high.mito &lt;- isOutlier(stats$subsets_Mito_percent, type = &quot;higher&quot; ) sce.pbmc &lt;- sce.pbmc[, !high.mito] # normalization library(scran) set.seed(1000) clusters &lt;- quickCluster(sce.pbmc) sce.pbmc &lt;- computeSumFactors(sce.pbmc, cluster = clusters) sce.pbmc &lt;- logNormCounts(sce.pbmc) # variance modelling set.seed(1001) dec.pbmc &lt;- modelGeneVarByPoisson(sce.pbmc) top.pbmc &lt;- getTopHVGs(dec.pbmc, prop = 0.1) 8.6 An√°lisis de Componentes Principales PCA es el arma principal de la reducci√≥n de dimensionalidad PCA descubre las combinaciones (lineales) de ‚Äúfeatures‚Äù que capturan la cantidad m√°s grande de variaci√≥n In PCA, la primer combinaci√≥n lineal (componente principal) se elige tal que permite capturar la mayor varianza a trav√©s de las c√©lulas. El siguiente PC se elige tal que es ‚Äúortogonal‚Äù al primero y captura la cantidad m√°s grande de la variaci√≥n restante, y as√≠ sucesivamente‚Ä¶ 8.6.1 PCA aplicado a datos de scRNA-seq Podemos realizar reducci√≥n de dimensionalidad al aplicar PCA en la matriz de cuentas transformadas (log-counts matrix) y restringiendo los an√°lisis posteriores a los primeros PCs (top PCs) Esto puede reducir nuestro dataset de 20,000 dimensiones a, digamos, 10, sin perder demasiada informaci√≥n La t√©cnica de PCA tiene muchas propiedades te√≥ricas bien estudiadas. Hay varias formas r√°pidas de realizar PCA en datasets grandes. 8.6.2 Suposiciones de PCA aplicadas a los datos de scRNA-seq Los procesos biol√≥gicos afectan m√∫ltiples genes en una manera coordinada Los primeros PCs probablemente representan la estructura biol√≥gica dado que m√°s variaci√≥n puede ser capturada considerando el comportamiento correlacionado de muchos genes Se espera que el ruido t√©cnico azaroso afecte cada gen independientemente Consideraci√≥n: Los primeros PCs capturar√°n ‚Äúbatch effects‚Äù (efectos de lote) que afectan muchos genes en una manera coordinada library(scran) top.zeisel &lt;- getTopHVGs(dec.zeisel, n = 2000) library(scater) set.seed(100) sce.zeisel &lt;- runPCA(sce.zeisel, subset_row = top.zeisel ) Por default, runPCA() usa un m√©todo r√°pido aproximado que realiza simulaciones, por lo tanto, es necesario ‚Äòconfigurar la semilla‚Äô para obtener resultados reproducibles 8.6.3 Eligiendo el n√∫mero de PCs Esta elecci√≥n en an√°loga a la elecci√≥n del numero de HVGs. Elegir m√°s PCs evitar√° descartar se√±al biol√≥gica a expensas de retener m√°s ruido Es com√∫n seleccionar un n√∫mero de PCs ‚Äúrazonable‚Äù pero arbitrario (10-50), continuar con el an√°lisis y regresar para checar la robustez de los resultados en cierto rango de valores Ahora exploraremos algunas estrategias guiadas por los datos (data-driven) para hacer esta selecci√≥n 8.6.3.1 Usando el punto del codo library(PCAtools) percent.var &lt;- attr(reducedDim(sce.zeisel), &quot;percentVar&quot;) chosen.elbow &lt;- PCAtools::findElbowPoint(percent.var) plot(percent.var, xlab = &quot;PC&quot;, ylab = &quot;Variance explained (%)&quot;) abline(v = chosen.elbow, col = &quot;red&quot;) Una heur√≠stica simple es elegir el n√∫mero de PCs basado en el porcentaje de varianza explicado por PCs sucesivos 8.6.3.2 Basados en la estructura de la poblaci√≥n choices &lt;- getClusteredPCs(reducedDim(sce.zeisel)) chosen.clusters &lt;- metadata(choices)$chosen Esta es una aproximaci√≥n heur√≠stica m√°s sofisticada que usa el n√∫mero de clusters como un proxy del n√∫mero de subpoblaciones Supongamos que esperamos d subpoblaciones de c√©lulas, en ese caso, necesitamos d-1 dimensiones para garantizar la separaci√≥n de todas las subpoblaciones Pero‚Ä¶ en un escenario real realmente no sabes cu√°ntas poblaciones hay‚Ä¶ Intenta con un rango para d y √∫nicamente considera valores que produzcan a lo m√°s d+1 clusters Cuando se seleccionan m√°s clusters con menos dimensiones se produce ‚Äòoverclustering‚Äô Elige una d que maximice el n√∫mero de clusters sin caer en ‚Äòoverclustering‚Äô Ventaja: Es una soluci√≥n pragm√°tica que soluciona el equilibrio sesgo-varianza en los an√°lisis posteriores (especialmente clustering) Desventaja: Hace suposiciones fuertes sobre la naturaleza de las diferencias biol√≥gicas entre los clusters, y de hecho supone la existencia de clusters, los cuales podr√≠an no existir en procesos biol√≥gicos como la diferenciaci√≥n 8.6.4 Juntando todo set.seed(100) # Compute and store the &#39;full&#39; set of PCs sce.zeisel &lt;- runPCA(sce.zeisel, subset_row = top.zeisel) # Can also select d and store the reduced set of PCs # e.g., using the elbow point reducedDim(sce.zeisel, &quot;PCA_elbow&quot;) &lt;- reducedDim( sce.zeisel, &quot;PCA&quot; )[, 1:chosen.elbow] # e.g., based on population structure reducedDim(sce.zeisel, &quot;PCA_clusters&quot;) &lt;- reducedDim( sce.zeisel, &quot;PCA&quot; )[, 1:chosen.clusters] 8.6.5 Usando el ruido t√©cnico library(scran) set.seed(111001001) denoised.pbmc &lt;- denoisePCA(sce.pbmc, technical = dec.pbmc, subset.row = top.pbmc ) Conserva todos los PCs hasta que el % de variaci√≥n explicado alcance algun l√≠mite (por ejemplo, basado en la estimaci√≥n de la variaci√≥n t√©cnica) denoisePCA() autom√°ticamente selecciona el n√∫mero de PCs Por default, denoisePCA() realiza algunas simulaciones, por lo tanto necesitamos ‚Äòconfigurar la semilla‚Äô para obtener resultados reproducibles dim(reducedDim(denoised.pbmc, &quot;PCA&quot;)) ## [1] 3985 9 La dimensionalidad del output es el l√≠mite inferior para el n√∫mero de PCs requeridos para explicar toda la variaci√≥n biol√≥gica. Lo que significa que cualquier n√∫mero menor de PCs definitivamente descartar√≠a alg√∫n aspecto de la se√±al biol√≥gica Esto no grantiza que los PCs retenidos capturen toda la se√±al biol√≥gica Esta t√©cnica usualmente retiene m√°s PCs que el m√©todo del punto del codo set.seed(001001001) denoised.zeisel &lt;- denoisePCA(sce.zeisel, technical = dec.zeisel, subset.row = top.zeisel ) dim(reducedDim(denoised.zeisel)) ## [1] 2815 50 scran::denoisePCA() internamente limita el numero de PCs, por default 5-50, para evitar la selecci√≥n de excesivamente pocos PCs (cuando el ruido t√©cnico es alto relativo al ruido biol√≥gico) o excesivamente muchos PCs (cuando el ruido t√©cnico es demasiado bajo) Los datos de cerebro de Zeisel est√°n cerca de este l√≠mite superior dec.pbmc2 &lt;- modelGeneVar(sce.pbmc) denoised.pbmc2 &lt;- denoisePCA(sce.pbmc, technical = dec.pbmc2, subset.row = top.pbmc ) dim(reducedDim(denoised.pbmc2)) ## [1] 3985 5 scran::denoisePCA() tiende a funcionar mejor cuando la relaci√≥n media-varianza refleja el ruiudo t√©cnico verdadero, i.e estimado por scran::modelGeneVarByPoisson() o scran::modelGeneVarWithSpikes() en vez de scran::modelGeneVar() El dataset PBMC est√° cerca de este l√≠mite inferior 8.7 Reducci√≥n de dimensionalidad para visualizaci√≥n 8.7.1 Motivaci√≥n Clustering y otros algoritmos operaran f√°cilmente sobre 10-50 (a lo m√°s) PCs, pero ese n√∫mero es a√∫n demasiado para la visualizaci√≥n Por lo tanto, necesitamos estrategias adicionales para la reducci√≥n de dimensionalidad si queremos visualizar los datos 8.7.2 Visualizando con PCA plotReducedDim(sce.zeisel, dimred = &quot;PCA&quot;) plotReducedDim(sce.zeisel, dimred = &quot;PCA&quot;, colour_by = &quot;level1class&quot; ) PCA es una t√©cnica lineal, por lo tanto, no es eficiente para comprimir diferencias en m√°s de 2 dimensiones en los primeros 2 PCs 8.7.3 Retos y resumen de la visualizaci√≥n con PCA plotReducedDim(sce.zeisel, dimred = &quot;PCA&quot;, ncomponents = 4, colour_by = &quot;level1class&quot; ) Ventajas: PCA es predecible y no introducir√° estructura aritficial en los datos Es deterministico y robusto a cambios peque√±os en los valores de entrada Desventajas: Usualmente no es satisfactoria paara visualizar la naturaleza compleja de los datos de scRNA-seq 8.7.4 Visualizaci√≥n con t-SNE set.seed(00101001101) sce.zeisel &lt;- runTSNE(sce.zeisel, dimred = &quot;PCA&quot;) plotReducedDim(sce.zeisel, dimred = &quot;TSNE&quot;, colour_by = &quot;level1class&quot;) t-stochastic neighbour embedding (t-SNE) es la visualizaci√≥n por excelencia de datos de scRNA-seq. Intenta encontrar una representaci√≥n (no-lineal) de los datos usando pocas dimensiones que preserve las distancias entre cada punto y sus vecinos en el espacio multi-dimensional 8.7.4.1 Retos de la visualizaci√≥n con t-SNE set.seed(100) sce.zeisel &lt;- runTSNE(sce.zeisel, dimred = &quot;PCA&quot;, perplexity = 30 ) plotReducedDim(sce.zeisel, dimred = &quot;TSNE&quot;, colour_by = &quot;level1class&quot; ) 8.7.4.2 Preguntas ¬øQu√© pasa si vuelves a correr runTSNE() sin especifica la semilla? ¬øQu√© pasa si especificas la semilla pero cambas el valor del par√°metro perplexity? 8.7.4.3 Continuando Baja perplejidad favorece la resoluci√≥n de la estrucutura fina, posiblemente al grado de que la visualizaci√≥n parece rudio random. El siguiente foro discute la selecci√≥n de par√°metros para t-SNE con cierta profundidad No sobreinterpretes los resultados de t-SNE como un ‚Äòmapa‚Äô de las identidades de las c√©lulas individuales Componentes aleatorios y selecci√≥n de par√°metors cambiar√°n la visualizaci√≥n La interpretaci√≥n puede ser enga√±ada por el tama√±o y posici√≥n de los clusters t-SNE infla clusters densos y comprime clusters escasos t-SNE no est√° obligado a preservar las localizaciones relativas de clusters no-vecinos (no puedes interpretar distancias no locales) A√∫n as√≠: t-SNE es una herramienta probada para visualizaci√≥n general de datos de scRNA-seq y sigue siendo muy popular 8.7.5 Visualizaci√≥n con UMAP Uniform manifold approximation and project (UMAP) es una alternativa a t-SNE As√≠ como t-SNE, UMAP intenta encontrar una representaci√≥n (no lineal) de pocas dimensiones de los datos que preserve las distancias entre cada puntos y sus vecinos en el espacio multi-dimensional t-SNE y UMAP est√°n basados en diferentes teor√≠as matem√°ticas set.seed(1100101001) sce.zeisel &lt;- runUMAP(sce.zeisel, dimred = &quot;PCA&quot;) plotReducedDim(sce.zeisel, dimred = &quot;UMAP&quot;, colour_by = &quot;level1class&quot; ) Comparado con t-SNE: UMAP tiende a tener clusters visualmente m√°s compactos Intenta preservar m√°s de la estructura global que t-SNE Tiende a ser m√°s r√°pido que t-SNE, lo cual puede ser importante para datasets grandes. La diferencia desaprece cuando se aplican a PCs 8.7.5.1 Retos de la visualizaci√≥n con UMAP set.seed(100) sce.zeisel &lt;- runUMAP(sce.zeisel, dimred = &quot;PCA&quot;, n_neighbors = 15 ) plotReducedDim(sce.zeisel, dimred = &quot;UMAP&quot;, colour_by = &quot;level1class&quot; ) 8.7.5.2 Preguntas ¬øQu√© pasa si vuelves a correr runUMAP() sin especifica la semilla? ¬øQu√© pasa si especificas la semilla pero cambas el valor del par√°metro n_neighbors? 8.7.5.3 Continuando Igual que para t-SNE, es necesario configurar una semilla y diferentes valores para los par√°metros cambiar√°n la visualizaci√≥n Si el valor para los par√°metros n_neighbors o min_dist es demasiado bajo entonces el ruido aleatorio se interpretar√° como estructura de alta-resoluci√≥n, si son demasiado altos entonces se perder√° la estructura fina TIP: Trata un rango de valores para cada par√°metro para asegurarte de que no comprometen ninguna de las conclusiones derivadas de la gr√°fica UMAP 8.7.6 Interpretando las gr√°ficas Recuerda: Reducci√≥n de dimensionalidad para la visualizaci√≥n de los datos necesariamente involucra descartar informaci√≥n y distorsionar las distancias entre las c√©lulas No sobre interpretes las gr√°ficas bonitas 8.7.7 Resumen y recomendaciones Las gr√°ficas de t-SNE y UMAP son herramientas diagn√≥stico importantes, por ejemplo: para checar si dos clusters son realmente subclusters vecinos o si un cluster puede ser dividido en m√°s de un cluster Es debatible cual visualizaci√≥n, t-SNE o UMAP, es m√°s √∫til o est√©ticamente agradable. Est√° bien elegir aqu√©lla que funcione mejor para tu an√°lisis (tomando en cuenta que tratar√°s la gr√°fica √∫nicamente como una herramienta de visualizaci√≥n/diagn√≥stico y que no llegar√°s a ninguna conclusi√≥n fuerte basado √∫nicamente en la gr√°fica ) 8.8 Donde estamos 8.9 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:22:34 UTC&quot; proc.time() ## user system elapsed ## 287.929 6.946 290.933 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## AnnotationHub 3.0.1 2021-06-20 [1] Bioconductor ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocManager 1.30.16 2021-06-15 [1] RSPM (R 4.1.0) ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## BiocVersion 3.13.1 2021-03-19 [2] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils * 1.12.2 2021-07-22 [1] Bioconductor ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## EnsDb.Hsapiens.v86 * 2.99.0 2021-07-29 [1] Bioconductor ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## ExperimentHub 2.0.0 2021-05-19 [1] Bioconductor ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## ggrepel * 0.9.1 2021-01-15 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## httpuv 1.6.1 2021-05-07 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## interactiveDisplayBase 1.30.0 2021-05-19 [1] Bioconductor ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## later 1.2.0 2021-04-23 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## Matrix * 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## mime 0.11 2021-06-23 [2] RSPM (R 4.1.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## PCAtools * 2.4.0 2021-05-19 [1] Bioconductor ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## promises 1.2.0.1 2021-02-11 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSpectra 0.16-0 2019-12-01 [1] RSPM (R 4.1.0) ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scran * 1.20.1 2021-05-24 [1] Bioconductor ## scRNAseq * 2.6.1 2021-05-25 [1] Bioconductor ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["clustering.html", "9 Clustering 9.1 Diapositivas de Peter Hickey 9.2 Dataset ilustrativo: 10X PBMC4k no filtrado 9.3 Motivaci√≥n 9.4 ¬øPor qu√© no realizamos el clustering sobre las coordenadas de t-SNE/UMAP? 9.5 ¬øCu√°l es el verdadero clustering? 9.6 Clustering basado en grafos 9.7 Implementaci√≥n 9.8 Clustering basado en grafos 9.9 Otros m√©todos de clustering 9.10 Evaluando estabilidad de los clusters 9.11 Subclustering 9.12 Resumen y recomendaciones 9.13 Donde estamos 9.14 Detalles de la sesi√≥n de R Patrocinadores", " 9 Clustering Instructora: Laura G√≥mez-Romero 9.1 Diapositivas de Peter Hickey Ve las diapositivas aqu√≠ 9.2 Dataset ilustrativo: 10X PBMC4k no filtrado library(BiocFileCache) bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath(bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot; )) untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc4k&quot;)) library(DropletUtils) library(Matrix) fname &lt;- file.path(tempdir(), &quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;) sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE) Dataset de c√©lulas mononucleares de sangre perif√©rica humana (PBMC) de 10X Genomics Descripci√≥n aqu√≠ Zheng, G. X. Y. et al.¬†Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017) # gene-annotation library(scater) rownames(sce.pbmc) &lt;- uniquifyFeatureNames( rowData(sce.pbmc)$ID, rowData(sce.pbmc)$Symbol ) library(EnsDb.Hsapiens.v86) location &lt;- mapIds(EnsDb.Hsapiens.v86, keys = rowData(sce.pbmc)$ID, column = &quot;SEQNAME&quot;, keytype = &quot;GENEID&quot; ) # cell-detection set.seed(100) e.out &lt;- emptyDrops(counts(sce.pbmc)) sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)] # quality-control stats &lt;- perCellQCMetrics(sce.pbmc, subsets = list(Mito = which(location == &quot;MT&quot;)) ) high.mito &lt;- isOutlier(stats$subsets_Mito_percent, type = &quot;higher&quot; ) sce.pbmc &lt;- sce.pbmc[, !high.mito] # normalization library(scran) set.seed(1000) clusters &lt;- quickCluster(sce.pbmc) sce.pbmc &lt;- computeSumFactors(sce.pbmc, cluster = clusters) sce.pbmc &lt;- logNormCounts(sce.pbmc) # variance modelling set.seed(1001) dec.pbmc &lt;- modelGeneVarByPoisson(sce.pbmc) top.pbmc &lt;- getTopHVGs(dec.pbmc, prop = 0.1) # dimensionality-reduction set.seed(10000) sce.pbmc &lt;- denoisePCA(sce.pbmc, subset.row = top.pbmc, technical = dec.pbmc ) set.seed(100000) sce.pbmc &lt;- runTSNE(sce.pbmc, dimred = &quot;PCA&quot;) set.seed(1000000) sce.pbmc &lt;- runUMAP(sce.pbmc, dimred = &quot;PCA&quot;) 9.3 Motivaci√≥n Clustering es un procedimiento no supervisado par definir grupos de c√©lulas con perfiles de expresi√≥n similares Su prop√≥sito principal es resumir los datos en un formato digerido susceptible a interpretaci√≥n humana Nos permite asignar etiquetas (por ejemplo, tipos celulares) a las c√©lulas 9.4 ¬øPor qu√© no realizamos el clustering sobre las coordenadas de t-SNE/UMAP? Las t√©cnicas de t-SNE/UMAP han comprimido datos altamente multi-dimensionales en dos dimensiones Esta compresi√≥n inevitablemente ha provocado la perdida de informaci√≥n Por lo tanto, agrupamos sobre los PCs y despu√©s visualizamos las identidades de los clusters en la gr√°fica t-SNE/UMAP 9.5 ¬øCu√°l es el verdadero clustering? Un cluster no implica un tipo celular Nosotros podemos definir tantos clusters como queramos y podemos utilizar el algoritmo que m√°s nos acomode El clustering, como un microscopio, simplemente es una herramienta para explorar los datos Preguntar por el mejor clustering es similar a preguntar cu√°l es la mejor magnificaci√≥n en un microscopio sin contenido 9.6 Clustering basado en grafos 9.6.1 Antecedentes El clustering basado en grafos fue popularizado (m√°s no inventado) por su uso en Seurat Objetivo: Construir un grafo en el que cada nodo es una c√©lula que est√° conectada a sus vecinos m√°s cercanos en el espacio multidimensional 9.6.2 Gr√°fica de los k vecinos m√°s cercanos (k-nearest neighbour -KNN- graph) Ilustremos como funciona para 20 c√©lulas 9.6.3 Gr√°fica de los vecinos m√°s pr√≥ximos compartidos (SNN) De una gr√°fica KNN se puede construir una grafica SNN Podemos asignar pesos a cada arista del grafo, bas√°ndonos en la similaridad de las c√©lulas involucradas, d√°ndole pesos m√°s altos a c√©lulas que est√°n m√°s cercanamente relacionadas 9.6.4 Gr√°fica SNN con pesos en las aristas 9.6.5 Pasando de una gr√°fica SNN pesada cluster mediante detecci√≥n de comunidades A partir de una gr√°fica SNN pesada podemos aplicar algoritmos para identificar comunidades de c√©lulas Comunidades son grupos de c√©lulas que est√°n m√°s conectadas a c√©lulas en el mismo grupo que lo que est√°n a c√©lulas de un grupo diferente Cada comunidad representa un cluster 9.6.6 Resumen de clustering basado en grafos La construcci√≥n y b√∫squeda de una red KNN es r√°pida, por lo tanto, es escalable para datasets grandes Debes evitar obtener conclusiones fuertes acerca de la forma de los clusters o la distribuci√≥n de c√©lulas dentro de cada cluster Cada c√©lula es conectada con un n√∫mero m√≠nimo de c√©lulas vecinas obligatoriamente, esto reduce el riesgo de cluster no informativos con unos pocos outliers Despu√©s de la construcci√≥n del grafo, no se almacena informaci√≥n adicional m√°s alla de las c√©lulas vecinas. Esto puede producir subclusters artificiales en regiones con muchas c√©lulas 9.7 Implementaci√≥n ¬øCu√°ntas c√©ulas vecinas debo considerar durante la construcci√≥n del grafo? ¬øC√≥mo debo pesar las aristas? ¬øCu√°l algoritmo de detecci√≥n de comunidades se debe usar para definir los clusters? 9.8 Clustering basado en grafos library(scran) # Build graph using k = 10 nearest neighbours in PCA-space g &lt;- buildSNNGraph(sce.pbmc, k = 10, use.dimred = &quot;PCA&quot;) # Identify communities using the Walktrap method clust &lt;- igraph::cluster_walktrap(g)$membership # Visualise clusters on t-SNE plot library(scater) sce.pbmc$cluster &lt;- factor(clust) plotReducedDim(sce.pbmc, &quot;TSNE&quot;, colour_by = &quot;cluster&quot;) ¬øQu√© pasa si utilizas una k m√°s grande o m√°s peque√±a? 9.8.1 Detalles adicionales del ejemplo previo KNNs se basan en la distancia Euclideana entre c√©lulas Las aristas se crean entre todos los pares de c√©lulas que comparten por lo menos un vecino Usa el esquema de peso de: Xu and Su (2015) 9.8.2 Eligiendo un valor de k El valor de k puede ser toscamente interpretado como el tama√±o anticipado de la subpoblaci√≥n m√°s peque√±a Si una subpoblaci√≥n tiene menos que (k+1) c√©lulas entonces el m√©todo ser√° forzado a construir aristas entre c√©lulas de esa subpoblaci√≥n y c√©lulas de otras subpoblaciones Esto incrementa el riesgo de que la subpoblaci√≥n en cuesti√≥n no forme su propio cluster 9.8.3 Estilo Seurat # Jaccard-based weights followed by Louvain clustering # aka &#39;Seurat-style&#39; clustering g &lt;- buildSNNGraph(sce.pbmc, k = 10, use.dimred = &quot;PCA&quot;, type = &quot;jaccard&quot;) clust2 &lt;- igraph::cluster_louvain(g)$membership sce.pbmc$cluster2 &lt;- factor(clust2) plotReducedDim(sce.pbmc, &quot;TSNE&quot;, colour_by = &quot;cluster2&quot;) 9.8.4 Clustering basado en un grafo Pipelines basados en Seurat: Pesos basados en Jacard Clustering Louvain Pipelines basados en Scran: Pesos basados en Randos Clustering Walktrap Para detalles sobre la seleccion de par√°metros y comparaciones: visitar esta p√°gina 9.8.5 Evaluando la separaci√≥n de los clusters Modularidad es una m√©trica natural para evaluar la separaci√≥n entre comunidades/clusters Definido como la diferencia (escalada) entre el peso total observado de las aristas entre los nodos en el mismo cluster y el peso total esperado si los pesos fueran distribuidos aleatoriamente entre todos los pares de nodos Nosotros computaremos un score de modularidad para cada cluster (usando las tasas en vez de las diferencias) library(bluster) ratio &lt;- pairwiseModularity(g, clust, as.ratio = TRUE) dim(ratio) ## [1] 16 16 library(pheatmap) pheatmap(log2(ratio + 1), cluster_rows = FALSE, cluster_cols = FALSE, color = colorRampPalette(c(&quot;white&quot;, &quot;blue&quot;))(100) ) Un dataset que contiene clusters bien separados deber√≠a contener la mayor√≠a del peso total observado en las entradas diagonales, i.e la mayor√≠a de las aristas ocurren entre c√©lulas del mismo cluster Para m√°s detalles sobre evaluaci√≥n de la separaci√≥n entre clusters visite esta p√°gina 9.9 Otros m√©todos de clustering Clustering por k-means R√°pido Se debe especificar el n√∫mero de clusters de antemano Favorece clusters esf√©ricos Clustering jer√°rquico Produce un dendograma (√°rbol) representando las c√©lulas y la similaridad entre subpoblaciones a varias resoluciones Demasiado lento para correrse en algo m√°s grande que los datasets m√°s peque√±os de scRNA-seq 9.10 Evaluando estabilidad de los clusters Una propiedad deseable de un cluster dado es que √©ste sea estable a las perturbaciones en los datos de entrada: Peque√±os cambios al procesamiento no cambiar√°n el resultado Esto incrementa la probabilida de que las conclusiones puedan ser replicadas en un estudio independiente Uno puede hacer un proceso de bootstrap para evaluar la estabilidad de un algoritmo de clustering en un dataset dado myClusterFUN &lt;- function(x) { g &lt;- buildSNNGraph(x, use.dimred = &quot;PCA&quot;, type = &quot;jaccard&quot;) igraph::cluster_louvain(g)$membership } originals &lt;- myClusterFUN(sce.pbmc) set.seed(0010010100) coassign &lt;- bootstrapStability(sce.pbmc, FUN = myClusterFUN, clusters = originals ) Coasignaci√≥n es la probabilidad de que c√©lulas elegidas al azar del cluster X y Y sean asignadas al mismo cluster en la r√©plica del proceso de bootstrap pheatmap(coassign, cluster_row = FALSE, cluster_col = FALSE, color = rev(viridis::magma(100)) ) Probabilidad alta de coasignaci√≥n indica que X no es estable con respecto a su separaci√≥n de Y. Queremos altas probabilidades de coasignaci√≥n en la diagonal Bootstraping solo considera el efecto del ruido de muestreo e ignora otros factores que pueden afectar la reproducinilidad (efectos de batch, variaci√≥n entre los donadores) Pobre separaci√≥n puede ser altamente estable 9.11 Subclustering Mejora la resoluc√≥n al repetir el proceso de feature selection y clustering dentro de un √∫nico cluster Se enfoca en los HGVs y PCs que son los m√°s relevantes para un cluster espec√≠fico g.full &lt;- buildSNNGraph(sce.pbmc, use.dimred = &quot;PCA&quot;) clust.full &lt;- igraph::cluster_walktrap(g.full)$membership sce.pbmc$clust.full &lt;- factor(clust.full) plotExpression(sce.pbmc, features = c(&quot;CD3E&quot;, &quot;CCR7&quot;, &quot;CD69&quot;, &quot;CD44&quot;), x = &quot;clust.full&quot;, colour_by = &quot;clust.full&quot; ) CD3E, CCR7, CD69, y CD44 son marcadores de c√©lulas T de memoria. Dentro de las c√©lulas T de memoria, ¬ød√≥nde est√°n las subpoblaciones CD4+ y CD8+? # Repeating modelling and PCA on the subset of cells we have # identified as memory T-cells (cluster 6). memory &lt;- 6 sce.memory &lt;- sce.pbmc[, clust.full == memory] dec.memory &lt;- modelGeneVar(sce.memory) sce.memory &lt;- denoisePCA(sce.memory, technical = dec.memory, subset.row = getTopHVGs(dec.memory, prop = 0.1) ) # Repeating clustering on the subset. g.memory &lt;- buildSNNGraph(sce.memory, use.dimred = &quot;PCA&quot;) clust.memory &lt;- igraph::cluster_walktrap(g.memory)$membership sce.memory$clust.memory &lt;- factor(clust.memory) plotExpression(sce.memory, features = c(&quot;CD8A&quot;, &quot;CD4&quot;), x = &quot;clust.memory&quot; ) Expresi√≥n de CD4 es bajo, por lo tanto, su cambio es modesto, pero la interpretaci√≥n es clara scran::quickSubCluster() ciclar√° sobre los clusters y realizar√° el proceso de subclustering de acuerdo a una funci√≥n especificada por el usuario. Esto asume que la misma funci√≥n es apropiada para todos los clusters Si tipos celulares o estados celulares se extienden sobre las fronteras de los clusters, entonces un subcluster podr√≠a representar contaminaci√≥n de un tipo celular en un cluster separado 9.12 Resumen y recomendaciones Un cluster no implica un tipo celular Nosotros podemos definir tantos clusters como queramos y podemos utilizar el algoritmo que m√°s nos acomode El clustering, como un microscopio, simplemente es una herramienta para explorar los datos Preguntar por el mejor clustering es similar a preguntar cu√°l es la mejor magnificaci√≥n en un microscopio sin contenido Clustering basado en grafos es r√°pido y evita tener que hacer suposiciones fuertes sobre la forma de los clusters o la distribuci√≥n de las c√©lulas dentro de cada cluster: scran::buildSNNGraph() igraph::cluster_walktrap() o igraph::cluster_louvain() Modularidad y estabilidad de los clusters son diagn√≥sticos √∫tiles El proceso de subclustering podr√≠a mejorar la resoluci√≥n dentro de clusters grandes 9.13 Donde estamos 9.14 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:25:57 UTC&quot; proc.time() ## user system elapsed ## 201.297 4.917 202.927 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster * 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils * 1.12.2 2021-07-22 [1] Bioconductor ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## EnsDb.Hsapiens.v86 * 2.99.0 2021-07-29 [1] Bioconductor ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## Matrix * 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## pheatmap * 1.0.12 2019-01-04 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSpectra 0.16-0 2019-12-01 [1] RSPM (R 4.1.0) ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scran * 1.20.1 2021-05-24 [1] Bioconductor ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["identificaci√≥n-de-genes-marcadores.html", "10 Identificaci√≥n de genes marcadores 10.1 Diapositivas de Peter Hickey 10.2 Motivaci√≥n 10.3 Dataset ilustrativo: PBMC4k 10X sin filtrar 10.4 Motivaci√≥n - continuaci√≥n 10.5 Prueba t modificada de Welch pareada 10.6 Ejemplo ilustrativo: CD3E como gen marcador en el dataset PBMC4k 10X 10.7 Aplicaci√≥n est√°ndar 10.8 Usando el log-fold change 10.9 Encontrando marcadores espec√≠ficos de cl√∫steres 10.10 Pruebas alternas 10.11 Prueba de rangos de Wilcoxon 10.12 Prueba binomial 10.13 M√©todos de expresi√≥n diferencial personalizados 10.14 Problemas estad√≠sticos 10.15 Resumen y recomendaciones 10.16 Detalles de la sesi√≥n de R Patrocinadores", " 10 Identificaci√≥n de genes marcadores Instructora: Yalbi I. Balderas-Mart√≠nez. 10.1 Diapositivas de Peter Hickey Ver las diapositivas originales aqu√≠ 10.2 Motivaci√≥n Ahora que hemos obtenido los cl√∫steres, nos preguntamos, pero qu√© son? (e.g.¬†¬øqu√© tipo celular es el cl√∫ster 1?) ¬øCu√°les genes est√°n dirigiendo el agrupamiento (e.g., ¬øcu√°les son los genes diferencialmente expresados entre los cl√∫steres 1 y 2?) Idea: Mirar las diferencias en los perfiles de expresi√≥n de las c√©lulas de los diferentes cl√∫steres 10.3 Dataset ilustrativo: PBMC4k 10X sin filtrar 10.3.1 Descargar datos # Usemos datos de pbmc4k library(BiocFileCache) bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath(bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot; )) untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc4k&quot;)) library(DropletUtils) library(Matrix) fname &lt;- file.path(tempdir(), &quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;) sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE) Dataset ‚ÄúC√©lulas mononucleares humanas de sangre perif√©rica‚Äù de 10X Genomics Descripci√≥n aqu√≠ 12 10.3.2 Anotaci√≥n # Anotaci√≥n de los genes library(scater) rownames(sce.pbmc) &lt;- uniquifyFeatureNames( rowData(sce.pbmc)$ID, rowData(sce.pbmc)$Symbol ) library(EnsDb.Hsapiens.v86) location &lt;- mapIds(EnsDb.Hsapiens.v86, keys = rowData(sce.pbmc)$ID, column = &quot;SEQNAME&quot;, keytype = &quot;GENEID&quot; ) # Detecci√≥n de _droplets_ con c√©lulas set.seed(100) e.out &lt;- emptyDrops(counts(sce.pbmc)) sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)] 10.3.3 Control de calidad # Control de calidad stats &lt;- perCellQCMetrics(sce.pbmc, subsets = list(Mito = which(location == &quot;MT&quot;)) ) high.mito &lt;- isOutlier(stats$subsets_Mito_percent, type = &quot;higher&quot; ) sce.pbmc &lt;- sce.pbmc[, !high.mito] # Normalizaci√≥n de los datos library(scran) set.seed(1000) clusters &lt;- quickCluster(sce.pbmc) sce.pbmc &lt;- computeSumFactors(sce.pbmc, cluster = clusters) sce.pbmc &lt;- logNormCounts(sce.pbmc) 10.3.4 Genes variables ## Identificaci√≥n de genes altamente variables set.seed(1001) dec.pbmc &lt;- modelGeneVarByPoisson(sce.pbmc) top.pbmc &lt;- getTopHVGs(dec.pbmc, prop = 0.1) 10.3.5 Reducci√≥n de dimensiones ## Reducci√≥n de dimensiones set.seed(10000) sce.pbmc &lt;- denoisePCA(sce.pbmc, subset.row = top.pbmc, technical = dec.pbmc ) set.seed(100000) sce.pbmc &lt;- runTSNE(sce.pbmc, dimred = &quot;PCA&quot;) set.seed(1000000) sce.pbmc &lt;- runUMAP(sce.pbmc, dimred = &quot;PCA&quot;) 10.3.6 Clustering # clustering g &lt;- buildSNNGraph(sce.pbmc, k = 10, use.dimred = &quot;PCA&quot;) clust &lt;- igraph::cluster_walktrap(g)$membership sce.pbmc$cluster &lt;- factor(clust) 10.4 Motivaci√≥n - continuaci√≥n ¬øAlgunos de estos genes est√°n asociados con los resultados de clustering? Ver una gr√°fica como una forma de encontrar los genes marcadores obviamente no nos sirve a gran escala Necesitamos un m√©todo estad√≠stico para identificar estos genes marcadores üëâ La prueba t de Welch es una opci√≥n obvia para probar las diferencias en la expresi√≥n entre cl√∫steres 10.5 Prueba t modificada de Welch pareada ‚ûï R√°pidas y buenas propiedades estad√≠sticas para un gran n√∫mero de c√©lulas (Soneson and Robinson, 2018) ‚ûï Las comparaciones pareadas proveen un log-fold change para indicar cu√°les cl√∫sterse son distinguidos por cada gen ü§î ¬øPor qu√© no comparar cada cl√∫ster con el promedio de todas las otras c√©lulas? Sensible a la composici√≥n poblacional, una subpoblaci√≥n dominante sola que dirige la selecci√≥n de los marcadores top para cualquier otro cl√∫ster 10.6 Ejemplo ilustrativo: CD3E como gen marcador en el dataset PBMC4k 10X 10.6.1 Pruebas pareadas comparison logFC Pval 1 vs 2 1.50 1.7e-198 1 vs 3 -0.08 0.11 ‚Ä¶ ‚Ä¶ ‚Ä¶ 2 vs 1 1.39 1.7e-198 ‚Ä¶ ‚Ä¶ ‚Ä¶ 18 vs 17 0.11 0.46 K = 18 cl√∫steres K!/(K-2)! = 306 comparaciones La mitad de ellas son redundantes 10.6.2 Combinando comparaciones del gen CD3E para el cl√∫ster 1 ‚ÄúMe interesa saber si el gen CD3 est√° diferencialmente expresado entre el cl√∫ster 1 y ..‚Äù cualquier (any) otro cl√∫ster = P = 1.3 x 10-205 (Simes adjusted P-value) todos (all) los otros cl√∫steres = P = 0.11 (Berger‚Äôs intersection-union test) algunos (some) de los otros cl√∫steres = P = 2.0 x 10-44 (mediana u otro cuantil, Holm-adjusted P-values) 10.6.2.1 Extendiendo a todos los genes scran::pairwiseTTests() scran::combineMarkers() M = 33,694 genes ü§ì K x M = 10,310,364 pruebas Comparaciones involucrando cl√∫ster 1‚Ä¶ Comparaciones involucrando cl√∫ster ‚Ä¶ Comparaciones involucrando cl√∫ster 18 10.7 Aplicaci√≥n est√°ndar Para cada cl√∫ster, usar pruebas t de Welch para identificar los genes que est√°n diferencialmente expresados entre √©ste y cualquier (any) otro cl√∫ster # scran::findMarkers() library(scran) markers.pbmc &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, test.type = &quot;t&quot;, pval.type = &quot;any&quot; ) 10.7.1 Explorando los resultados chosen &lt;- &quot;9&quot; interesting &lt;- markers.pbmc[[chosen]] 10.7.2 Con un heatmap best.set &lt;- interesting[interesting$Top &lt;= 6, ] logFCs &lt;- as.matrix(best.set[, -(1:3)]) colnames(logFCs) &lt;- sub(&quot;logFC.&quot;, &quot;&quot;, colnames(logFCs)) library(pheatmap) pheatmap(logFCs, breaks = seq(-5, 5, length.out = 101)) üëâ Usamos el campo Top para identificar un conjunto de genes que distinguen el cl√∫ster 9 de cualquier otro cl√∫ster 10.8 Usando el log-fold change 10.8.1 Sin espeficiar el lfc Para cada cl√∫ster, usa pruebas t de Welch para identificar los genes que est√°n sobreexpresados entre √©ste y cualquier otro cl√∫ster markers.pbmc.up &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, test.type = &quot;t&quot;, direction = &quot;up&quot;, pval.type = &quot;any&quot; ) interesting.up &lt;- markers.pbmc.up[[chosen]] 10.8.2 Especificando el lfc Para cada cl√∫ster, usa pruebas t de Welch para identificar los genes que est√°n sobreexpresados con un log-fold change (lfc) o al menos 1 entre √©ste y cualquier otro cl√∫ster markers.pbmc.up2 &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, test.type = &quot;t&quot;, direction = &quot;up&quot;, lfc = 1, pval.type = &quot;any&quot; ) interesting.up2 &lt;- markers.pbmc.up2[[chosen]] üëâ La prueba t tambi√©n nos permite especificar un log-fold change diferente de cero como la hip√≥tesis nula ü§ì Es m√°s riguroso que simplemente filtrar por log-fold change TREAT 10.8.3 Heatmap best.set &lt;- interesting.up2[interesting.up2$Top &lt;= 5, ] logFCs &lt;- as.matrix(best.set[, -(1:3)]) colnames(logFCs) &lt;- sub(&quot;logFC.&quot;, &quot;&quot;, colnames(logFCs)) pheatmap(logFCs, breaks = seq(-5, 5, length.out = 101)) üëâ Los promedios est√°n m√°s centrados en un conjunto de genes marcadores candidatos que est√°n sobreexpresados en el cl√∫ster 9 ‚ö†Ô∏è El incremento del rigor no se da sin costo ‚ö†Ô∏è Si el lfc es muy grande podr√≠a descartar genes √∫tiles E.g., un gen sobreexpresado en una proporci√≥n peque√±a de c√©lulas en un cl√∫ster sigue siendo un marcador efectivo si el foco est√° en la especificidad m√°s que en la sensibilidad 10.9 Encontrando marcadores espec√≠ficos de cl√∫steres üëâ Por defecto, scran::findMarkers() dar√° un alto rango a genes que est√°n DE en cualquier comparaci√≥n pareada ü§î Quiero genes que son espec√≠ficos de cada cl√∫ster üëâ T√∫ quieres genes que son DE en todas las comparaciones pareadas Para cada cl√∫ster, usa pruebas t de Welch para identificar genes que est√°n sobreexpresados entre √©ste y todos los otros cl√∫steres markers.pbmc.up3 &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, direction = &quot;up&quot;, pval.type = &quot;all&quot; ) interesting.up3 &lt;- markers.pbmc.up3[[chosen]] ü§ì Usa una prueba de uni√≥n-intersecci√≥n para combinar los P-values que es el m√°ximo P-value de todas las comparaciones pareadas 10.9.1 Pros/cons de los genes marcadores espec√≠ficos de los cl√∫steres Poblacion Expresion_CD4 Expresion_CD8 DN(CD4-/CD8-) No No CD4+&gt; Si No CD8+&gt; No Si DP(CD4+/CD8+) Si Si 10.9.2 findMarkers con pval.type some Para cada cl√∫ster, usa pruebas t de Welch para identificar los genes que est√°n sobreexpresados entre √©ste y algunos de los otros cl√∫sters markers.pbmc.up4 &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, direction = &quot;up&quot;, pval.type = &quot;some&quot; ) interesting.up4 &lt;- markers.pbmc.up4[[chosen]] üëâ Para cuando pval.type=\"all\" es muy estricto todav√≠a pval.type=\"any\" es muy generoso ü§ì Aplica la correcci√≥n Holm-Bonferroni a los P-values y toma el mejor valor de en medio como el P-value combinado ‚ö†Ô∏è Perder√°s algunas garant√≠as ofrecidas por los otros m√©todos 10.10 Pruebas alternas 10.10.1 Motivaci√≥n La prueba t no es la √∫nica forma de comparar dos grupos de mediciones ü§î Quiero una prueba que pueda ser usada perfectamente para distinguir dos cl√∫steres uno del otro üëâ Prueba de rangos Wilcoxon ü§î Quiero identificar genes que son expresados m√°s frecuentemente en un cl√∫ster que en otro üëâ Prueba Binomial 10.11 Prueba de rangos de Wilcoxon Eval√∫a directamente la separaci√≥n entre la distribuci√≥n de la expresi√≥n de los diferentes cl√∫steres ü§ì Es proporcional al √°rea bajo la curva (AUC), que es la probabilidad de que una c√©lula al azar de un cl√∫ster tenga mayor que expresi√≥n que una c√©lula al azar de otro cl√∫ster üëâ AUCs de 1 o 0 indican que los dos cl√∫steres tienen distribuciones de expresi√≥n separadas ü§ì Tambi√©n se conoce como prueba Wilcoxon-Mann-Whitney (WMW) 10.11.1 findMarkers para Wilcoxon Para cada cl√∫ster, usa la prueba de rangos de Wilcoxon para identificar genes que est√°n sobreexpresados entre √©ste y cualquier otro cl√∫ster markers.pbmc.wmw &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, test.type = &quot;wilcox&quot;, direction = &quot;up&quot;, pval.type = &quot;any&quot; ) interesting.wmw &lt;- markers.pbmc.wmw[[chosen]] 10.11.2 Heatmap de genes marcadores con Wilcoxon best.set &lt;- interesting.wmw[interesting.wmw$Top &lt;= 5, ] AUCs &lt;- as.matrix(best.set[, -(1:3)]) colnames(AUCs) &lt;- sub(&quot;AUC.&quot;, &quot;&quot;, colnames(AUCs)) pheatmap(AUCs, breaks = seq(0, 1, length.out = 21), color = viridis::viridis(21) ) 10.11.3 Resumen de la prueba de rangos de Wilcoxon ‚ûï Ofrece directamente la propiedad deseable de un gen marcador (i.e.¬†que el gen distinga perfectamente entre dos cl√∫steres) ‚ûï Es sim√©trico con respecto a las diferencias en el tama√±o de los grupos comparados ‚ûñ Es mucho m√°s lento comparado con la prueba t (aunque esto en general no es un problema en la pr√°ctica) 10.12 Prueba binomial Es una prueba que identifica los genes que difieren en la proporci√≥n de c√©lulas que se expresan entre cl√∫steres Una definici√≥n mucho m√°s estricta de genes marcadores ü§ì Convierte la expresi√≥n en una medida binaria de presencia/ausencia, por lo que toda la informaci√≥n cuantitativa es ignorada Desde una perspectiva pr√°ctica, puede ser m√°s f√°cil para validar 10.12.1 findMarkers para binomial Para cada cl√∫ster, usa la prueba Binomial para identificar genes que est√°n m√°s frecuentemente expresados (sobreexpresados) en comparaci√≥n con cualquier otro cl√∫ster markers.pbmc.binom &lt;- findMarkers(sce.pbmc, groups = sce.pbmc$cluster, test.type = &quot;binom&quot;, direction = &quot;up&quot;, pval.type = &quot;any&quot; ) interesting.binom &lt;- markers.pbmc.binom[[chosen]] ü§ì El efecto en el tama√±o se reporta como el log-fold change en la proporci√≥n de las c√©lulas que se expresan entre cl√∫steres üëâ Log-fold changes grandes positivos, indican que el gen est√° m√°s frecuentemente expresado en un cl√∫ster comparado con otro 10.12.2 Visualizando genes marcadores de la prueba bionomial 10.12.3 Resumen de la prueba binomial La prueba Binomial no toma en cuenta la normalizaci√≥n ‚ûï Produce genes marcadores que pueden ser m√°s f√°ciles de validar ‚ûñ Ser m√°s estricto puede llevar a la p√©rdida de buenos marcadores candidatos 10.13 M√©todos de expresi√≥n diferencial personalizados ü§î ¬øPor qu√© no usar edgeR/DESeq2/limma-voom u otros m√©todos personalizados (e.g., MAST)? üëâ Claro que puedes! Checa OSCA üëâ Pero √©stos son tal vez algo exagerados para identificar genes marcadores ü§ì Las c√©lulas son nuestras ‚Äúr√©plicas‚Äù para el prop√≥sito de identificar genes marcadores ü§ì edgeR/DESeq2/limma-voom hacen asunciones m√°s fuertes acerca de los datos que es m√°s probable que no se cumplan para c√©lulas individuales en scRNA-seq 10.14 Problemas estad√≠sticos 10.14.1 Invalidez de P-values Todas las estrategias de DE para detectar genes marcadores entre cl√∫steres son estad√≠sticamente defectuosas de alguna manera ü§ì ‚ÄúDragado de datos‚Äù: El an√°lisis DE se realiza usando los mismos datos usados para obtener los cl√∫steres üëâ Las pruebas para genes DE entre cl√∫steres producir√° inevitablemente algunos resultados significativos y as√≠ es como los cl√∫steres ser√°n definidos! üëâ A√∫n cuando los P-values son defectuosos, el efecto no es muy da√±ino para la detecci√≥n de genes ya que los P-values solo son usados para los rangos ü§ì No se pueden usar P-values para definir ‚Äúdiferencias significativas‚Äù entre los cl√∫steres con respecto a un umbral de la tasa de error 10.14.2 Naturaleza de la replicaci√≥n üëâ Idealmente, validar algunos de los marcadores con una poblaci√≥n de c√©lulas independientes (y idealmente usando una t√©cnica diferente, e.g., hibridaci√≥n fluorescente in situ o qPCR) 10.14.3 Comentarios adicionales üëâ La estrategia de an√°lisis DE es que los marcadores son definidos relativo a subpoblaciones en el mismo dataset üëâ Si un gen se expresa uniformemente a trav√©s de la poblaci√≥n no servir√° como un marcador e.g., los marcadores de las c√©lulas T no ser√°n detectados si solamente hay c√©lulas T en los datos usualmente no es un problema, ya que tenemos idea de las c√©lulas que se capturaron üëâ Existen m√©todos de machine learning para hacer la identificaci√≥n de los genes marcadores, pero la humilde prueba t sigue siendo muy buena 10.15 Resumen y recomendaciones üëâ Crea m√∫ltiples listas de genes marcadores con diferentes niveles de rigor üëâ La forma m√°s simple de interpretar los genes marcadores es que son los sobreexpresados de ‚Äúforma √∫nica‚Äù, o son ‚Äúgenes espec√≠ficos de cl√∫steres‚Äù, especialmente si queremos imponer un log-fold change m√≠nimo üëâ Puedes requerir hacer una identificaci√≥n de genes marcadores m√°s enfocada, e.g., subset de los datos de solo 2 cl√∫steres de inter√©s y entonces correr scran::findMarkers() 10.16 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:31:24 UTC&quot; proc.time() ## user system elapsed ## 324.825 4.355 326.426 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils * 1.12.2 2021-07-22 [1] Bioconductor ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## EnsDb.Hsapiens.v86 * 2.99.0 2021-07-29 [1] Bioconductor ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## kableExtra * 1.3.4 2021-02-20 [1] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## Matrix * 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## pheatmap * 1.0.12 2019-01-04 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSpectra 0.16-0 2019-12-01 [1] RSPM (R 4.1.0) ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rstudioapi 0.13 2020-11-12 [2] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## rvest 1.0.1 2021-07-26 [1] RSPM (R 4.1.0) ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scran * 1.20.1 2021-05-24 [1] Bioconductor ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## svglite 2.0.0 2021-02-20 [1] RSPM (R 4.1.0) ## systemfonts 1.0.2 2021-05-11 [1] RSPM (R 4.1.0) ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## webshot 0.5.2 2019-11-22 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: Zheng, G. X. Y. et al.¬†Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017).‚Ü©Ô∏é "],["anotaci√≥n-de-clusters-de-c√©lulas.html", "11 Anotaci√≥n de clusters de c√©lulas 11.1 Diapositivas de Peter Hickey 11.2 Motivaci√≥n 11.3 Dataset ilustrativo: PBMC4k 10X sin filtrar 11.4 Asignando las etiquetas celulares a partir de los datos de referencia 11.5 SingleR 11.6 Resumen de la anotaci√≥n basada en una referencia (e.g., SingleR) 11.7 Asignando las etiquetas de tipos celulares a partir de marcadores 11.8 Resumen y recomendaciones 11.9 Detalles de la sesi√≥n de R Patrocinadores", " 11 Anotaci√≥n de clusters de c√©lulas Instructora: Yalbi I. Balderas-Mart√≠nez. 11.1 Diapositivas de Peter Hickey Ver las diapositivas originales aqu√≠ 11.2 Motivaci√≥n Ahora estamos a punto de obtener la interpretaci√≥n biol√≥gica de los resultados Esta es la tarea m√°s retadora en los an√°lisis de datos scRNA-seq üëâ La obtenci√≥n de cl√∫steres es m√°s o menos directa ü§î ¬øCu√°l es el estado biol√≥gico que est√° representado por cada uno de los cl√∫steres? üëâ Necesitamos hacer un puente entre el gap del dataset actual y el conocimiento biol√≥gico a priori (no siempre est√° disponible en una forma consistente y cualitativa) ü§î ¬øQu√© es un tipo celular? üî¨ ‚ÄúLo sabr√© cuando lo vea‚Äù üíª ‚ÄúNo‚Äù Aplicaremos varios m√©todos computacionales que explotan la informaci√≥n a priori para asignar el significado a un dataset no caracterizado de scRNA-seq. Algunas fuentes de informaci√≥n a priori Conjuntos de genes curados (e.g.¬†Gene Ontology) Perfiles de expresi√≥n de bases de datos publicadas de referencia Los datos raros que t√∫ hayas escondido en tu cerebro Google 11.3 Dataset ilustrativo: PBMC4k 10X sin filtrar # Usemos datos de pbmc4k library(BiocFileCache) bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath(bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot; )) untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc4k&quot;)) library(DropletUtils) library(Matrix) fname &lt;- file.path(tempdir(), &quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;) sce.pbmc &lt;- read10xCounts(fname, col.names = TRUE) Dataset ‚ÄúC√©lulas mononucleares humanas de sangre perif√©rica‚Äù de 10X Genomics Descripci√≥n aqu√≠ 13 11.3.1 Anotaci√≥n # Anotaci√≥n de los genes library(scater) rownames(sce.pbmc) &lt;- uniquifyFeatureNames( rowData(sce.pbmc)$ID, rowData(sce.pbmc)$Symbol ) library(EnsDb.Hsapiens.v86) location &lt;- mapIds(EnsDb.Hsapiens.v86, keys = rowData(sce.pbmc)$ID, column = &quot;SEQNAME&quot;, keytype = &quot;GENEID&quot; ) # Detecci√≥n de _droplets_ con c√©lulas set.seed(100) e.out &lt;- emptyDrops(counts(sce.pbmc)) sce.pbmc &lt;- sce.pbmc[, which(e.out$FDR &lt;= 0.001)] 11.3.2 Control de calidad # Control de calidad stats &lt;- perCellQCMetrics(sce.pbmc, subsets = list(Mito = which(location == &quot;MT&quot;)) ) high.mito &lt;- isOutlier(stats$subsets_Mito_percent, type = &quot;higher&quot; ) sce.pbmc &lt;- sce.pbmc[, !high.mito] # Normalizaci√≥n de los datos library(scran) set.seed(1000) clusters &lt;- quickCluster(sce.pbmc) sce.pbmc &lt;- computeSumFactors(sce.pbmc, cluster = clusters) sce.pbmc &lt;- logNormCounts(sce.pbmc) 11.3.3 Genes variables ## Identificaci√≥n de genes altamente variables set.seed(1001) dec.pbmc &lt;- modelGeneVarByPoisson(sce.pbmc) top.pbmc &lt;- getTopHVGs(dec.pbmc, prop = 0.1) 11.3.4 Reducci√≥n de dimensiones ## Reducci√≥n de dimensiones set.seed(10000) sce.pbmc &lt;- denoisePCA(sce.pbmc, subset.row = top.pbmc, technical = dec.pbmc ) set.seed(100000) sce.pbmc &lt;- runTSNE(sce.pbmc, dimred = &quot;PCA&quot;) set.seed(1000000) sce.pbmc &lt;- runUMAP(sce.pbmc, dimred = &quot;PCA&quot;) 11.3.5 Clustering # clustering g &lt;- buildSNNGraph(sce.pbmc, k = 10, use.dimred = &quot;PCA&quot;) clust &lt;- igraph::cluster_walktrap(g)$membership sce.pbmc$cluster &lt;- factor(clust) 11.4 Asignando las etiquetas celulares a partir de los datos de referencia 11.4.1 Visi√≥n general üëâ Un enfoque directo es comparar los perfiles de expresi√≥n single-cell con datasets previamente anotados üëâ Las etiquetas pueden entonces ser asignadas a cada c√©lula en nuestro dataset no caracterizado de prueba basado en la muestra de referencia m√°s similar, por dar alguna definici√≥n de ‚Äúsimilar‚Äù üëâ Cualquier dataset de expresi√≥n g√©nica etiquetado (microarreglos, RNA-seq bulk, scRNA-seq) puede ser usado como una referencia ‚ö†Ô∏è Sin embargo, su confiabilidad depende enormemente en la calidad de los datos originales y la experiencia de los autores originales quienes asignaron las etiquetas en primer lugar üëâ Asignar las etiquetas a un dataset de ‚Äúprueba‚Äù a partir de un dataset de ‚Äúentrenamiento‚Äù (referencia), es un problema est√°ndar en estad√≠stica / machine learning üëâ Usaremos el m√©todo SingleR (Aran et al.¬†2019) 11.5 SingleR ü§ì Asigna las etiquetas a las c√©lulas basado en las muestras de referencia con las correlaciones de rangos m√°s altas de Spearman ü§ì Para reducir el ruido, identifica genes marcadores entre pares de etiquetas (en la referencia) y calcula la correlaci√≥n usando solamente esos marcadores ü§ì Hace alg√∫n tipo de tuneado fino, repitiendo las correlaciones solamente con los genes marcadores de las etiquetas con el mejor score, ayudando a resolver cualquier ambig√ºedad entre esas etiquetas al eliminar el ruido a partir de marcadores irrelevantes para otras etiquetas 11.5.1 SingleR incluye varias referencias Ver referencias # Human SingleR::BlueprintEncodeData() SingleR::DatabaseImmuneCellExpressionData() SingleR::HumanPrimaryCellAtlasData() SingleR::MonacoImmuneData() SingleR::NovershternHematopoieticData() # Mice SingleR::ImmGenData() SingleR::MouseRNASeqData() 11.5.2 Usando las referencias # if needed install celldex # create directory? y library(celldex) ref &lt;- celldex::BlueprintEncodeData() ‚ùì ¬øQu√© tipos celulares est√°n disponibles en este dataset de referencia? 11.5.3 Usando las referencias integradas library(SingleR) pred &lt;- SingleR( test = sce.pbmc, ref = ref, labels = ref$label.main ) ‚ùì ¬øQu√© etiquetas han sido asignadas a los datos single-cell? ‚ùì ¬øC√≥mo usar√≠amos las etiquetas ‚Äúfinas‚Äù con SingleR? üëâ Inspeccionamos los resultados usando un heatmap de los scores por c√©lula y por etiqueta üëâ Idealmente, cada c√©lula deber√≠a exhibir un score alto en una etiqueta relativa a todas las otras üëâ Los scores se muestran antes de cualquier tuneado fino y son normalizadas a [0, 1] dentro de cada c√©lula 11.5.4 Podado de etiquetas (Label pruning) total_pruned &lt;- sum(is.na(pred$pruned.labels)) plotScoreHeatmap(pred, show.pruned = TRUE) üëâ SingleR intentar√° podar aquellas asignaciones de baja calidad marc√°ndolas como NA ü§ì El podado se hace calculando la diferencia del score de la etiqueta asignada a partir del score de la mediana dentro de cada c√©lula y entonces podando las c√©lulas con un valor peque√±o de esta diferencia plotScoreDistribution(pred) üëâ Distribuci√≥n de las diferencias del score de la etiqueta asignada a partir del score de la mediana dentro de cada c√©lula 11.5.5 Identificando los genes con anotaci√≥n dirigida ü§î ¬øPor qu√© las c√©lulas en este cl√∫ster se etiquetan como el tipo celular X? üëâ Examina la expresi√≥n de los genes marcadores para cada etiqueta en el dataset de prueba üëâ Si una c√©lula en el dataset de prueba est√° asignado con confianza a una etiqueta en particular, uno esperar√≠a que tenga una fuerte expresi√≥n de los marcadores de esa etiqueta (al menos sobreexpresi√≥n con respecto a las c√©lulas asignadas a otras etiquetas) # install gmp, ClusterR, mbkmeans dependencies if needed library(clusterExperiment) sce.pbmc$labels &lt;- pred$labels all.markers &lt;- metadata(pred)$de.genes lab &lt;- &quot;B-cells&quot; # Get top-10 marker genes for B-cells compared to each other cell # type top.markers &lt;- Reduce(union, sapply(all.markers[[lab]], head, 10)) # plotHeatmap(sce.pbmc, order_columns_by=&quot;labels&quot;, # features=top.markers, center=TRUE, zlim=c(-3, 3), main=lab) ‚ùì Toma otro tipo celular e identifica los genes que dirigen la anotaci√≥n 11.5.6 Comparando las etiquetas con los cl√∫steres tab &lt;- table(Assigned = pred$pruned.labels, Cluster = sce.pbmc$cluster) library(pheatmap) # Proportion of cells in each cluster assigned to each label pheatmap(prop.table(tab, margin = 2), color = colorRampPalette(c(&quot;white&quot;, &quot;blue&quot;))(101) ) # (log-)number of cells in each cluster assigned to each label # Adding a pseudo-count of 10 to avoid strong color jumps with just # 1 cell. pheatmap(log2(tab + 10), color = colorRampPalette(c(&quot;white&quot;, &quot;blue&quot;))(101) ) 11.5.7 Voil√† plotTSNE(sce.pbmc, colour_by = &quot;labels&quot;, text_by = &quot;labels&quot;) 11.6 Resumen de la anotaci√≥n basada en una referencia (e.g., SingleR) ‚ûï Se centra en aspectos de los datos que se sabe son interesantes, simplifica el proceso de la interpretaci√≥n biol√≥gica ‚ûñ Est√° restringido por la diversidad y la resoluci√≥n de las etiquetas disponibles en el dataset de referencia üëâ Se pueden suplir referencias personalizadas a SingleR 11.7 Asignando las etiquetas de tipos celulares a partir de marcadores ü§î ¬øC√≥mo podemos hacer uso de nuestros genes marcadores agrupados? ü•â Revisarlos en hojas de c√°lculo ü•à Observar heatmaps ü•á Realizar un gene set enrichment analysis 11.7.1 Gene set enrichment analysis üëâ Identifica las rutas y procesos que est√°n (relativamente) activos en cada cl√∫ster basado en la sobreexpresi√≥n de los genes asociados en comparaci√≥n con otros cl√∫steres ‚ûï Un m√©todo confiable para determinar si las rutas est√°n sobre- o sub- expresadas entre cl√∫esteres ‚ûï Existen un mont√≥n de herramientas para gene set enrichment analysis ‚ûñ Todas las conclusiones son relativas a otros cl√∫steres, haci√©ndolo m√°s dif√≠cil para determinar la identidad celular si alguno no est√° presente en el mismo estudio m√°s info 11.7.2 Calculando las actividades de los conjuntos de genes üëâ Calcular el promedio de la expresi√≥n en log en todos los genes, en un conjunto de genes para cada c√©lula y examinar los cl√∫steres con valores altos (gene set activities) üëâ Se necesita proveer de conjuntos de genes ‚ûñ No todos los genes en el conjunto pueden exhibir el mismo patr√≥n de diferencia y los genes no-DE a√±adir√°n ruido, ‚Äúdiluyendo‚Äù la fuerza de cualquiera de las diferencias comparadas a un an√°lisis que se centra directamente en genes DE üëâ Es m√°s una visualizaci√≥n √∫til que la base para cualquier an√°lisis estad√≠stico real m√°s info 11.8 Resumen y recomendaciones üëâ La anotaci√≥n de tipos celulares ‚Äúautom√°tica‚Äù, como SingleR, es mejor cuando funciona (i.e.¬†cuando hay un dataset de referencia apropiado) üëâ Usualmente necesitaremos usar un m√©todo manual, como aquellos basados en agrupar los genes marcadores (e.g., gene set enrichment analysis) üëâ La anotaci√≥n del tipo celular ofrecer√° una reconsideraci√≥n inmediata de los par√°metros del agrupamiento y/o algunos retoques manuales a los cl√∫steres 11.9 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:34:27 UTC&quot; proc.time() ## user system elapsed ## 179.279 4.329 182.671 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## ade4 1.7-17 2021-06-17 [1] RSPM (R 4.1.0) ## annotate 1.70.0 2021-05-19 [1] Bioconductor ## AnnotationDbi * 1.54.1 2021-06-08 [1] Bioconductor ## AnnotationFilter * 1.16.0 2021-05-19 [1] Bioconductor ## AnnotationHub 3.0.1 2021-06-20 [1] Bioconductor ## ape 5.5 2021-04-25 [1] RSPM (R 4.1.0) ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## beachmat 2.8.0 2021-05-19 [1] Bioconductor ## beeswarm 0.4.0 2021-06-01 [1] RSPM (R 4.1.0) ## Biobase * 2.52.0 2021-05-19 [1] Bioconductor ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## BiocGenerics * 0.38.0 2021-05-19 [1] Bioconductor ## BiocIO 1.2.0 2021-05-19 [1] Bioconductor ## BiocManager 1.30.16 2021-06-15 [1] RSPM (R 4.1.0) ## BiocNeighbors 1.10.0 2021-05-19 [1] Bioconductor ## BiocParallel 1.26.1 2021-07-04 [1] Bioconductor ## BiocSingular 1.8.1 2021-06-08 [1] Bioconductor ## BiocVersion 3.13.1 2021-03-19 [2] Bioconductor ## biomaRt 2.48.2 2021-07-01 [1] Bioconductor ## Biostrings 2.60.2 2021-08-05 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## bitops 1.0-7 2021-04-24 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bluster 1.2.1 2021-05-27 [1] Bioconductor ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## celldex * 1.2.0 2021-05-20 [1] Bioconductor ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## clusterExperiment * 2.12.0 2021-05-19 [1] Bioconductor ## codetools 0.2-18 2020-11-04 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## DelayedArray 0.18.0 2021-05-19 [1] Bioconductor ## DelayedMatrixStats 1.14.2 2021-08-08 [1] Bioconductor ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## doParallel 1.0.16 2020-10-16 [1] RSPM (R 4.1.0) ## dplyr 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## dqrng 0.3.0 2021-05-01 [1] RSPM (R 4.1.0) ## DropletUtils * 1.12.2 2021-07-22 [1] Bioconductor ## edgeR 3.34.0 2021-05-19 [1] Bioconductor ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## EnsDb.Hsapiens.v86 * 2.99.0 2021-07-29 [1] Bioconductor ## ensembldb * 2.16.4 2021-08-05 [1] Bioconductor ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## ExperimentHub 2.0.0 2021-05-19 [1] Bioconductor ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## FNN 1.1.3 2019-02-15 [1] RSPM (R 4.1.0) ## foreach 1.5.1 2020-10-15 [1] RSPM (R 4.1.0) ## genefilter 1.74.0 2021-05-19 [1] Bioconductor ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## GenomeInfoDb * 1.28.1 2021-07-01 [1] Bioconductor ## GenomeInfoDbData 1.2.6 2021-07-29 [1] Bioconductor ## GenomicAlignments 1.28.0 2021-05-19 [1] Bioconductor ## GenomicFeatures * 1.44.0 2021-05-19 [1] Bioconductor ## GenomicRanges * 1.44.0 2021-05-19 [1] Bioconductor ## ggbeeswarm 0.6.0 2017-08-07 [1] RSPM (R 4.1.0) ## ggplot2 * 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## gridBase 0.4-7 2014-02-24 [1] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## HDF5Array 1.20.0 2021-05-19 [1] Bioconductor ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## hms 1.1.0 2021-05-17 [1] RSPM (R 4.1.0) ## howmany 0.3-1 2012-06-01 [1] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## httpuv 1.6.1 2021-05-07 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## interactiveDisplayBase 1.30.0 2021-05-19 [1] Bioconductor ## IRanges * 2.26.0 2021-05-19 [1] Bioconductor ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## iterators 1.0.13 2020-10-15 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KEGGREST 1.32.0 2021-05-19 [1] Bioconductor ## kernlab 0.9-29 2019-11-12 [1] RSPM (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## later 1.2.0 2021-04-23 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## locfdr 1.1-8 2015-07-15 [1] RSPM (R 4.1.0) ## locfit 1.5-9.4 2020-03-25 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## MASS 7.3-54 2021-05-03 [3] CRAN (R 4.1.0) ## Matrix * 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## MatrixGenerics * 1.4.2 2021-08-08 [1] Bioconductor ## matrixStats * 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## metapod 1.0.0 2021-05-19 [1] Bioconductor ## mime 0.11 2021-06-23 [2] RSPM (R 4.1.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## nlme 3.1-152 2021-02-04 [3] CRAN (R 4.1.0) ## NMF 0.23.0 2020-08-01 [1] RSPM (R 4.1.0) ## pheatmap * 1.0.12 2019-01-04 [1] RSPM (R 4.1.0) ## phylobase 0.8.10 2020-03-01 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## pkgmaker 0.32.2 2020-10-20 [1] RSPM (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## prettyunits 1.1.1 2020-01-24 [2] RSPM (R 4.1.0) ## progress 1.2.2 2019-05-16 [1] RSPM (R 4.1.0) ## promises 1.2.0.1 2021-02-11 [1] RSPM (R 4.1.0) ## ProtGenerics 1.24.0 2021-05-19 [1] Bioconductor ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R.methodsS3 1.8.1 2020-08-26 [1] RSPM (R 4.1.0) ## R.oo 1.24.0 2020-08-26 [1] RSPM (R 4.1.0) ## R.utils 2.10.1 2020-08-26 [1] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RCurl 1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0) ## registry 0.5-1 2019-03-05 [1] RSPM (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] RSPM (R 4.1.0) ## restfulr 0.0.13 2017-08-06 [1] RSPM (R 4.1.0) ## rhdf5 2.36.0 2021-05-19 [1] Bioconductor ## rhdf5filters 1.4.0 2021-05-19 [1] Bioconductor ## Rhdf5lib 1.14.2 2021-07-06 [1] Bioconductor ## rjson 0.2.20 2018-06-08 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## rncl 0.8.4 2020-02-10 [1] RSPM (R 4.1.0) ## RNeXML 2.4.5 2020-06-18 [1] RSPM (R 4.1.0) ## rngtools 1.5 2020-01-23 [1] RSPM (R 4.1.0) ## Rsamtools 2.8.0 2021-05-19 [1] Bioconductor ## RSpectra 0.16-0 2019-12-01 [1] RSPM (R 4.1.0) ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## rsvd 1.0.5 2021-04-16 [1] RSPM (R 4.1.0) ## rtracklayer 1.52.0 2021-05-19 [1] Bioconductor ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## S4Vectors * 0.30.0 2021-05-19 [1] Bioconductor ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## ScaledMatrix 1.0.0 2021-05-19 [1] Bioconductor ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scater * 1.20.1 2021-06-15 [1] Bioconductor ## scran * 1.20.1 2021-05-24 [1] Bioconductor ## scuttle * 1.2.1 2021-08-05 [1] Bioconductor ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.1.0) ## SingleCellExperiment * 1.14.1 2021-05-21 [1] Bioconductor ## SingleR * 1.6.1 2021-05-20 [1] Bioconductor ## softImpute 1.4-1 2021-05-09 [1] RSPM (R 4.1.0) ## sparseMatrixStats 1.4.2 2021-08-08 [1] Bioconductor ## statmod 1.4.36 2021-05-10 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## SummarizedExperiment * 1.22.0 2021-05-19 [1] Bioconductor ## survival 3.2-11 2021-04-26 [3] CRAN (R 4.1.0) ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyr 1.1.3 2021-03-03 [1] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## uuid 0.1-4 2020-02-26 [1] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## vipor 0.4.5 2017-03-22 [1] RSPM (R 4.1.0) ## viridis 0.6.1 2021-05-11 [1] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## XML 3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0) ## xml2 1.3.2 2020-04-23 [2] RSPM (R 4.1.0) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.1.0) ## XVector 0.32.0 2021-05-19 [1] Bioconductor ## yaml 2.2.1 2020-02-01 [2] RSPM (R 4.1.0) ## zinbwave 1.14.1 2021-05-25 [1] Bioconductor ## zlibbioc 1.38.0 2021-05-19 [1] Bioconductor ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: Zheng, G. X. Y. et al.¬†Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017).‚Ü©Ô∏é "],["an√°lisis-de-expresi√≥n-diferencial.html", "12 An√°lisis de expresi√≥n diferencial 12.1 Detalles de la sesi√≥n de R Patrocinadores", " 12 An√°lisis de expresi√≥n diferencial TODO 12.1 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:34:28 UTC&quot; proc.time() ## user system elapsed ## 0.37 0.16 0.40 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "],["introducci√≥n-a-seurat.html", "13 Introducci√≥n a Seurat 13.1 Diapositivas 13.2 Una perspectiva diferente 13.3 Kick-start 13.4 Quality Control 13.5 Normalizaci√≥n 13.6 Detecci√≥n de genes (caractersticas) altamente variables 13.7 Escalar los datos 13.8 Reducci√≥n dimensional lineal 13.9 Determinar la dimensionalidad del conjunto de datos 13.10 Clustering 13.11 Reducci√≥n dimensional no lineal (UMAP/tSNE) 13.12 Caracteristicas diferencialmente expresadas (biomarcadores de los clusters) 13.13 Assigning cell type identity to clusters 13.14 Guardar Resultados 13.15 Detalles de la sesi√≥n de R Patrocinadores", " 13 Introducci√≥n a Seurat Instructor: Kevin E. Meza-Landeros 13.1 Diapositivas Presentaci√≥n: aqu√≠ 13.2 Una perspectiva diferente Seurat es un paquete R dise√±ado para control de calidad, an√°lisis y exploraci√≥n de datos de secuencia de ARN de una sola c√©lula. Seurat tiene como objetivo permitir a los usuarios identificar e interpretar fuentes de heterogeneidad a partir de mediciones transcript√≥micas unicelulares e integrar diversos tipos de datos unicelulares. Seurat es desarrollado y mantenido por el laboratorio de Satija y se publica bajo la Licencia P√∫blica GNU (GPL 3.0). En este tutorial se ve como procesar los datos de scRNAseq con un nuevo paquete. Los pasos a realizar son en esencia los mismos que ya revisamos con el tutorial de la OSCA de RStudio. No olvides nunca que el paquete mas adecuado y que deber√°s utilizar depender√° mayoritariamente de tus datos y el procesamiento que se adec√∫e a estos. Adem√°s‚Ä¶ siempre es bueno diversos puntos de vista sobre las cosas, ¬øno es as√≠? Aprende mas sobre Seurat: aqu√≠ 13.3 Kick-start En este tutorial partimos a partir de que ya se tienen los archivos FASTQ resultados de secuenciaci√≥n. ¬øCon qu√© datos estoy trabajando? Peripheral Blood Mononuclear Cells (PBMC) disponibles gratuitamente de 10X Genomics. Son en total 2,700 c√©luas √∫nicas secuenciadas con Illumina NextSeq 500. Puedes descargar los datos de aqu√≠ (7.3MB). Descarga el archivo comprimido y procede a descomprimirlo. Se creara el siguiente directorio filtered_gene_bc_matrices/hg19/, aqu√≠ estar√°n los archivos que necesitaremos. A continuaci√≥n lo haremos con c√≥digo de R. Este tutorial solo es la punta del iceberg de lo que se puede hacer con la paquetera de Seurat. Para comenzar a sumergirte en este mundo no dudes en visitar la p√°gina oficial mantenida por Satija Lab Vignettes A continuaci√≥n estableceremos nuestros directorio de trabajo y leeremos los datos anteriores. La funci√≥n Read10X() lee en la salida de cellranger de 10X (de donde se obtuvieron los FASTQs), devolviendo una matriz de recuento √∫nica identificada molecularmente (UMI). Los valores en esta matriz representan el n√∫mero de mol√©culas para cada caracter√≠stica (es decir, gen; fila) que se detectan en cada celda (columna). ## Cargar paquetes de R library(&quot;BiocFileCache&quot;) ## para descargar datos library(&quot;dplyr&quot;) ## para filtar datos library(&quot;Seurat&quot;) ## paquete principal de este cap√≠tulo library(&quot;patchwork&quot;) ## para graficar im√°genes juntas # Usemos datos de pbmc3k tal y como lo hacen en # https://satijalab.org/seurat/articles/pbmc3k_tutorial.html # pero con nuestro propio c√≥digo bfc &lt;- BiocFileCache() raw.path &lt;- bfcrpath(bfc, file.path( &quot;http://cf.10xgenomics.com/samples&quot;, &quot;cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz&quot; )) ## adding rname &#39;http://cf.10xgenomics.com/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz&#39; untar(raw.path, exdir = file.path(tempdir(), &quot;pbmc3k&quot;)) fname &lt;- file.path(tempdir(), &quot;pbmc3k/filtered_gene_bc_matrices/hg19&quot;) # Load the PBMC dataset pbmc.data &lt;- Read10X(data.dir = fname) # Initialize the Seurat object with the raw (non-normalized data). pbmc &lt;- CreateSeuratObject(counts = pbmc.data, project = &quot;pbmc3k&quot;, min.cells = 3, min.features = 200) ## Warning: Feature names cannot have underscores (&#39;_&#39;), replacing with dashes ## (&#39;-&#39;) pbmc ## An object of class Seurat ## 13714 features across 2700 samples within 1 assay ## Active assay: RNA (13714 features, 0 variable features) Veamos la estructura del Objeto de Seurat str(pbmc) ## Formal class &#39;Seurat&#39; [package &quot;SeuratObject&quot;] with 13 slots ## ..@ assays :List of 1 ## .. ..$ RNA:Formal class &#39;Assay&#39; [package &quot;SeuratObject&quot;] with 8 slots ## .. .. .. ..@ counts :Formal class &#39;dgCMatrix&#39; [package &quot;Matrix&quot;] with 6 slots ## .. .. .. .. .. ..@ i : int [1:2282976] 29 73 80 148 163 184 186 227 229 230 ... ## .. .. .. .. .. ..@ p : int [1:2701] 0 779 2131 3260 4220 4741 5522 6304 7094 7626 ... ## .. .. .. .. .. ..@ Dim : int [1:2] 13714 2700 ## .. .. .. .. .. ..@ Dimnames:List of 2 ## .. .. .. .. .. .. ..$ : chr [1:13714] &quot;AL627309.1&quot; &quot;AP006222.2&quot; &quot;RP11-206L10.2&quot; &quot;RP11-206L10.9&quot; ... ## .. .. .. .. .. .. ..$ : chr [1:2700] &quot;AAACATACAACCAC-1&quot; &quot;AAACATTGAGCTAC-1&quot; &quot;AAACATTGATCAGC-1&quot; &quot;AAACCGTGCTTCCG-1&quot; ... ## .. .. .. .. .. ..@ x : num [1:2282976] 1 1 2 1 1 1 1 41 1 1 ... ## .. .. .. .. .. ..@ factors : list() ## .. .. .. ..@ data :Formal class &#39;dgCMatrix&#39; [package &quot;Matrix&quot;] with 6 slots ## .. .. .. .. .. ..@ i : int [1:2282976] 29 73 80 148 163 184 186 227 229 230 ... ## .. .. .. .. .. ..@ p : int [1:2701] 0 779 2131 3260 4220 4741 5522 6304 7094 7626 ... ## .. .. .. .. .. ..@ Dim : int [1:2] 13714 2700 ## .. .. .. .. .. ..@ Dimnames:List of 2 ## .. .. .. .. .. .. ..$ : chr [1:13714] &quot;AL627309.1&quot; &quot;AP006222.2&quot; &quot;RP11-206L10.2&quot; &quot;RP11-206L10.9&quot; ... ## .. .. .. .. .. .. ..$ : chr [1:2700] &quot;AAACATACAACCAC-1&quot; &quot;AAACATTGAGCTAC-1&quot; &quot;AAACATTGATCAGC-1&quot; &quot;AAACCGTGCTTCCG-1&quot; ... ## .. .. .. .. .. ..@ x : num [1:2282976] 1 1 2 1 1 1 1 41 1 1 ... ## .. .. .. .. .. ..@ factors : list() ## .. .. .. ..@ scale.data : num[0 , 0 ] ## .. .. .. ..@ key : chr &quot;rna_&quot; ## .. .. .. ..@ assay.orig : NULL ## .. .. .. ..@ var.features : logi(0) ## .. .. .. ..@ meta.features:&#39;data.frame&#39;: 13714 obs. of 0 variables ## .. .. .. ..@ misc : list() ## ..@ meta.data :&#39;data.frame&#39;: 2700 obs. of 3 variables: ## .. ..$ orig.ident : Factor w/ 1 level &quot;pbmc3k&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## .. ..$ nCount_RNA : num [1:2700] 2419 4903 3147 2639 980 ... ## .. ..$ nFeature_RNA: int [1:2700] 779 1352 1129 960 521 781 782 790 532 550 ... ## ..@ active.assay: chr &quot;RNA&quot; ## ..@ active.ident: Factor w/ 1 level &quot;pbmc3k&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## .. ..- attr(*, &quot;names&quot;)= chr [1:2700] &quot;AAACATACAACCAC-1&quot; &quot;AAACATTGAGCTAC-1&quot; &quot;AAACATTGATCAGC-1&quot; &quot;AAACCGTGCTTCCG-1&quot; ... ## ..@ graphs : list() ## ..@ neighbors : list() ## ..@ reductions : list() ## ..@ images : list() ## ..@ project.name: chr &quot;pbmc3k&quot; ## ..@ misc : list() ## ..@ version :Classes &#39;package_version&#39;, &#39;numeric_version&#39; hidden list of 1 ## .. ..$ : int [1:3] 4 0 2 ## ..@ commands : list() ## ..@ tools : list() ¬øC√≥mo se ven los datos en una matriz de recuento? Examinemos algunos genes en las primeras treinta c√©lulas. Los valores en la matriz representan ceros (no se detectan mol√©culas). Dado que la mayor√≠a de los valores en una matriz scRNA-seq son 0, Seurat utiliza una representaci√≥n de matriz dispersa (sparse matrix) siempre que sea posible. Esto da como resultado un ahorro significativo de memoria y velocidad. pbmc.data[c(&quot;CD3D&quot;, &quot;TCL1A&quot;, &quot;MS4A1&quot;), 1:30] ## 3 x 30 sparse Matrix of class &quot;dgCMatrix&quot; ## ## CD3D 4 . 10 . . 1 2 3 1 . . 2 7 1 . . 1 3 . 2 3 . . . . . 3 4 1 5 ## TCL1A . . . . . . . . 1 . . . . . . . . . . . . 1 . . . . . . . . ## MS4A1 . 6 . . . . . . 1 1 1 . . . . . . . . . 36 1 2 . . 2 . . . . dense.size &lt;- object.size(as.matrix(pbmc.data)) dense.size ## 709591472 bytes sparse.size &lt;- object.size(pbmc.data) sparse.size ## 29905192 bytes dense.size / sparse.size ## 23.7 bytes ¬°EN ESTE CASO UNA MATRIZ NO DISPERSA OCUPA ~ 24 VECES MAS ESPACIO! 13.4 Quality Control Algunas m√©tricas de control de calidad com√∫nmente utilizadas por la comunidad incluyen: El n√∫mero de genes √∫nicos detectados en cada c√©lula. Las c√©lulas de baja calidad o las gotitas vac√≠as suelen tener muy pocos genes. Los dobletes o multipletes celulares pueden exhibir un recuento de genes aberrantemente alto De manera similar, el n√∫mero total de mol√©culas detectadas dentro de una c√©lula (se correlaciona fuertemente con genes √∫nicos) El porcentaje de lecturas que se asignan al genoma mitocondrial Las c√©lulas de baja calidad / moribundas a menudo exhiben una extensa contaminaci√≥n mitocondrial Calculamos m√©tricas de control de calidad mitocondrial con la funci√≥n PercentageFeatureSet(), que calcula el porcentaje de recuentos que se originan a partir de un conjunto de caracter√≠sticas. El operador [[ puede agregar columnas a los metadatos del objeto. Este es un gran lugar para almacenar estad√≠sticas de control de calidad. Entonces calculamos y a√±adimos la cantidad de lecturas que corresponden al genoma mitocondrial. pbmc[[&quot;percent.mt&quot;]] &lt;- PercentageFeatureSet(pbmc, pattern = &quot;^MT-&quot;) Visualizamos las m√©tricas de control de calidad mencionadas anteriormente como un diagrama de viol√≠n. Ademas vemos la correlaci√≥n entre el numero de mol√©culas de RNA detectadas en cada c√©lula con el n√∫mero de genes √∫nicos y con el porcentaje de lecturas que corresponden a mtADN. VlnPlot(pbmc, features = c(&quot;nFeature_RNA&quot;, &quot;nCount_RNA&quot;, &quot;percent.mt&quot;), ncol = 3) plot1 &lt;- FeatureScatter(pbmc, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;percent.mt&quot;) plot2 &lt;- FeatureScatter(pbmc, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;nFeature_RNA&quot;) plot1 + plot2 Finalmente filtramos aquellas c√©lulas que se salen de los est√°ndares de cada uno de los par√°metros. # Filter pbmc &lt;- subset(pbmc, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 2500 &amp; percent.mt &lt; 5) ¬øD√≥nde se almacenan la m√©tricas de QC en Seurat? Est√°n almacenadas en la seccion de meta-data del objeto Seurat. head(pbmc@meta.data, 5) ## orig.ident nCount_RNA nFeature_RNA percent.mt ## AAACATACAACCAC-1 pbmc3k 2419 779 3.0177759 ## AAACATTGAGCTAC-1 pbmc3k 4903 1352 3.7935958 ## AAACATTGATCAGC-1 pbmc3k 3147 1129 0.8897363 ## AAACCGTGCTTCCG-1 pbmc3k 2639 960 1.7430845 ## AAACCGTGTATGCG-1 pbmc3k 980 521 1.2244898 13.5 Normalizaci√≥n De forma predeterminada, se emplea un m√©todo de normalizaci√≥n de escala global ‚ÄúLogNormalize‚Äù que normaliza las medidas de expresi√≥n de caracter√≠sticas para cada celda por la expresi√≥n total, multiplica esto por un factor de escala (10.000 por defecto) y transforma el resultado en logaritmos. Los valores normalizados se almacenan en pbmc [[\"RNA\"]]@data. pbmc &lt;- NormalizeData(pbmc, normalization.method = &quot;LogNormalize&quot;, scale.factor = 10000) 13.6 Detecci√≥n de genes (caractersticas) altamente variables A continuaci√≥n, calculamos un subconjunto de caracter√≠sticas que exhiben una alta variaci√≥n de c√©lula a c√©lula en el conjunto de datos (es decir, est√°n altamente expresadas en algunas c√©lulas y poco expresadas en otras). El equipo de Seurat y otros equipos han descubierto que centrarse en estos genes en el an√°lisis posterior ayuda a resaltar la se√±al biol√≥gica en conjuntos de datos unicelulares. Nuestro procedimiento en Seurat se describe en detalle aqu√≠ y mejora las versiones anteriores al modelar directamente la relaci√≥n de varianza media inherente a los datos de una sola celda, y se implementa en la funci√≥n FindVariableFeatures(). De forma predeterminada, devolvemos 2000 caracter√≠sticas por conjunto de datos (aunque se puede modificar). Estos se utilizar√°n en an√°lisis posteriores, como PCA. pbmc &lt;- FindVariableFeatures(pbmc, selection.method = &quot;vst&quot;, nfeatures = 2000) # Identify the 10 most highly variable genes top10 &lt;- head(VariableFeatures(pbmc), 10) top10 ## [1] &quot;PPBP&quot; &quot;LYZ&quot; &quot;S100A9&quot; &quot;IGLL5&quot; &quot;GNLY&quot; &quot;FTL&quot; &quot;PF4&quot; &quot;FTH1&quot; ## [9] &quot;GNG11&quot; &quot;S100A8&quot; # plot variable features with and without labels plot1 &lt;- VariableFeaturePlot(pbmc) plot2 &lt;- LabelPoints(plot = plot1, points = top10, repel = TRUE) ## When using repel, set xnudge and ynudge to 0 for optimal results plot1 + plot2 ## Warning: Transformation introduced infinite values in continuous x-axis ## Warning: Removed 1 rows containing missing values (geom_point). ## Warning: Transformation introduced infinite values in continuous x-axis ## Warning: Removed 1 rows containing missing values (geom_point). 13.7 Escalar los datos A continuaci√≥n, aplicamos una transformaci√≥n lineal (‚Äúescalado‚Äù) que es un paso de preprocesamiento est√°ndar antes de las t√©cnicas de reducci√≥n dimensional como PCA. La funci√≥n ScaleData(): Cambia la expresi√≥n de cada gen, de modo que la expresi√≥n media en las c√©lulas sea 0 Escala la expresi√≥n de cada gen, de modo que la varianza entre las c√©lulas sea 1 Este paso otorga el mismo peso en los an√°lisis posteriores, de modo que los genes altamente expresados no dominen Los resultados de esto se almacenan en pbmc [[\"RNA\"]]@scale.data. all.genes &lt;- rownames(pbmc) pbmc &lt;- ScaleData(pbmc, features = all.genes) ## Centering and scaling data matrix 13.8 Reducci√≥n dimensional lineal A continuaci√≥n, realizamos PCA sobre los datos escalados. De forma predeterminada, solo las caracter√≠sticas variables determinadas previamente se utilizan como entrada, pero se pueden definir mediante el argumento de caracter√≠sticas si desea elegir un subconjunto diferente. pbmc &lt;- RunPCA(pbmc, features = VariableFeatures(object = pbmc)) ## PC_ 1 ## Positive: CST3, TYROBP, LST1, AIF1, FTL, FTH1, LYZ, FCN1, S100A9, TYMP ## FCER1G, CFD, LGALS1, S100A8, CTSS, LGALS2, SERPINA1, IFITM3, SPI1, CFP ## PSAP, IFI30, SAT1, COTL1, S100A11, NPC2, GRN, LGALS3, GSTP1, PYCARD ## Negative: MALAT1, LTB, IL32, IL7R, CD2, B2M, ACAP1, CD27, STK17A, CTSW ## CD247, GIMAP5, AQP3, CCL5, SELL, TRAF3IP3, GZMA, MAL, CST7, ITM2A ## MYC, GIMAP7, HOPX, BEX2, LDLRAP1, GZMK, ETS1, ZAP70, TNFAIP8, RIC3 ## PC_ 2 ## Positive: CD79A, MS4A1, TCL1A, HLA-DQA1, HLA-DQB1, HLA-DRA, LINC00926, CD79B, HLA-DRB1, CD74 ## HLA-DMA, HLA-DPB1, HLA-DQA2, CD37, HLA-DRB5, HLA-DMB, HLA-DPA1, FCRLA, HVCN1, LTB ## BLNK, P2RX5, IGLL5, IRF8, SWAP70, ARHGAP24, FCGR2B, SMIM14, PPP1R14A, C16orf74 ## Negative: NKG7, PRF1, CST7, GZMB, GZMA, FGFBP2, CTSW, GNLY, B2M, SPON2 ## CCL4, GZMH, FCGR3A, CCL5, CD247, XCL2, CLIC3, AKR1C3, SRGN, HOPX ## TTC38, APMAP, CTSC, S100A4, IGFBP7, ANXA1, ID2, IL32, XCL1, RHOC ## PC_ 3 ## Positive: HLA-DQA1, CD79A, CD79B, HLA-DQB1, HLA-DPB1, HLA-DPA1, CD74, MS4A1, HLA-DRB1, HLA-DRA ## HLA-DRB5, HLA-DQA2, TCL1A, LINC00926, HLA-DMB, HLA-DMA, CD37, HVCN1, FCRLA, IRF8 ## PLAC8, BLNK, MALAT1, SMIM14, PLD4, P2RX5, IGLL5, LAT2, SWAP70, FCGR2B ## Negative: PPBP, PF4, SDPR, SPARC, GNG11, NRGN, GP9, RGS18, TUBB1, CLU ## HIST1H2AC, AP001189.4, ITGA2B, CD9, TMEM40, PTCRA, CA2, ACRBP, MMD, TREML1 ## NGFRAP1, F13A1, SEPT5, RUFY1, TSC22D1, MPP1, CMTM5, RP11-367G6.3, MYL9, GP1BA ## PC_ 4 ## Positive: HLA-DQA1, CD79B, CD79A, MS4A1, HLA-DQB1, CD74, HIST1H2AC, HLA-DPB1, PF4, SDPR ## TCL1A, HLA-DRB1, HLA-DPA1, HLA-DQA2, PPBP, HLA-DRA, LINC00926, GNG11, SPARC, HLA-DRB5 ## GP9, AP001189.4, CA2, PTCRA, CD9, NRGN, RGS18, CLU, TUBB1, GZMB ## Negative: VIM, IL7R, S100A6, IL32, S100A8, S100A4, GIMAP7, S100A10, S100A9, MAL ## AQP3, CD2, CD14, FYB, LGALS2, GIMAP4, ANXA1, CD27, FCN1, RBP7 ## LYZ, S100A11, GIMAP5, MS4A6A, S100A12, FOLR3, TRABD2A, AIF1, IL8, IFI6 ## PC_ 5 ## Positive: GZMB, NKG7, S100A8, FGFBP2, GNLY, CCL4, CST7, PRF1, GZMA, SPON2 ## GZMH, S100A9, LGALS2, CCL3, CTSW, XCL2, CD14, CLIC3, S100A12, RBP7 ## CCL5, MS4A6A, GSTP1, FOLR3, IGFBP7, TYROBP, TTC38, AKR1C3, XCL1, HOPX ## Negative: LTB, IL7R, CKB, VIM, MS4A7, AQP3, CYTIP, RP11-290F20.3, SIGLEC10, HMOX1 ## LILRB2, PTGES3, MAL, CD27, HN1, CD2, GDI2, CORO1B, ANXA5, TUBA1B ## FAM110A, ATP1A1, TRADD, PPA1, CCDC109B, ABRACL, CTD-2006K23.1, WARS, VMO1, FYB Seurat proporciona varias formas √∫tiles de visualizar tanto las celdas como las caracter√≠sticas que definen el PCA, incluidas VizDimReduction(), DimPlot() y DimHeatmap(). Puedes examinar y visualizar los resultados de PCA de diferentes formas. print(pbmc[[&quot;pca&quot;]], dims = 1:5, nfeatures = 5) ## PC_ 1 ## Positive: CST3, TYROBP, LST1, AIF1, FTL ## Negative: MALAT1, LTB, IL32, IL7R, CD2 ## PC_ 2 ## Positive: CD79A, MS4A1, TCL1A, HLA-DQA1, HLA-DQB1 ## Negative: NKG7, PRF1, CST7, GZMB, GZMA ## PC_ 3 ## Positive: HLA-DQA1, CD79A, CD79B, HLA-DQB1, HLA-DPB1 ## Negative: PPBP, PF4, SDPR, SPARC, GNG11 ## PC_ 4 ## Positive: HLA-DQA1, CD79B, CD79A, MS4A1, HLA-DQB1 ## Negative: VIM, IL7R, S100A6, IL32, S100A8 ## PC_ 5 ## Positive: GZMB, NKG7, S100A8, FGFBP2, GNLY ## Negative: LTB, IL7R, CKB, VIM, MS4A7 VizDimLoadings(pbmc, dims = 1:2, reduction = &quot;pca&quot;) DimPlot(pbmc, reduction = &quot;pca&quot;) En particular, DimHeatmap() permite una f√°cil exploraci√≥n de las fuentes primarias de heterogeneidad en un conjunto de datos y puede ser √∫til cuando se intenta decidir qu√© PC incluir para an√°lisis posteriores posteriores. Tanto las celdas como las caracter√≠sticas se ordenan de acuerdo con sus puntajes de PCA. Establecer celdas en un n√∫mero traza las celdas ‚Äúextremas‚Äù en ambos extremos del espectro, lo que acelera dr√°sticamente el trazado de grandes conjuntos de datos. Aunque claramente es un an√°lisis supervisado, consideramos que esta es una herramienta valiosa para explorar conjuntos de caracter√≠sticas correlacionadas. DimHeatmap(pbmc, dims = 1, cells = 500, balanced = TRUE) DimHeatmap(pbmc, dims = 1:15, cells = 500, balanced = TRUE) 13.9 Determinar la dimensionalidad del conjunto de datos Para superar el extenso ruido t√©cnico en cualquier caracter√≠stica √∫nica para los datos de scRNA-seq, Seurat agrupa las c√©lulas en funci√≥n de sus puntuaciones de PCA, y cada PC representa esencialmente una ‚Äúmetafunci√≥n‚Äù que combina informaci√≥n en un conjunto de caracter√≠sticas correlacionadas. Por lo tanto, los componentes principales principales representan una compresi√≥n s√≥lida del conjunto de datos. Sin embargo, ¬øcu√°ntos componentes deber√≠amos elegir incluir? 10? 20? 100? En Macosko et al, implementamos una prueba de remuestreo inspirada en el procedimiento JackStraw. Permutamos aleatoriamente un subconjunto de los datos (1% por defecto) y volvemos a ejecutar PCA, construyendo una ‚Äúdistribuci√≥n nula‚Äù de puntuaciones de caracter√≠sticas, y repetimos este procedimiento. Identificamos PC ‚Äúimportantes‚Äù como aquellas que tienen un gran enriquecimiento de caracter√≠sticas de bajo valor p.¬† # NOTE: This process can take a long time for big datasets, comment out for expediency. More # approximate techniques such as those implemented in ElbowPlot() can be used to reduce # computation time pbmc &lt;- JackStraw(pbmc, num.replicate = 100) pbmc &lt;- ScoreJackStraw(pbmc, dims = 1:20) La funci√≥n JackStrawPlot() proporciona una herramienta de visualizaci√≥n para comparar la distribuci√≥n de los valores p para cada PC con una distribuci√≥n uniforme (l√≠nea discontinua). Las PC ‚Äúsignificativas‚Äù mostrar√°n un gran enriquecimiento de funciones con valores p bajos (curva s√≥lida por encima de la l√≠nea discontinua). En este caso, parece que hay una fuerte ca√≠da en la importancia despu√©s de los primeros 10-12 PCs. JackStrawPlot(pbmc, dims = 1:15) ## Warning: Removed 23510 rows containing missing values (geom_point). Un m√©todo heur√≠stico alternativo genera un ‚Äúdiagrama de codo (Elbow Plot)‚Äù: una clasificaci√≥n de componentes principales basada en el porcentaje de varianza explicada por cada uno (funci√≥n ElbowPlot()). En este ejemplo, podemos observar un ‚Äúcodo‚Äù alrededor de PC9-10, lo que sugiere que la mayor parte de la se√±al verdadera se captura en las primeras 10 PC. ElbowPlot(pbmc) 13.10 Clustering pbmc &lt;- FindNeighbors(pbmc, dims = 1:10) ## Computing nearest neighbor graph ## Computing SNN pbmc &lt;- FindClusters(pbmc, resolution = 0.5) ## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck ## ## Number of nodes: 2638 ## Number of edges: 95927 ## ## Running Louvain algorithm... ## Maximum modularity in 10 random starts: 0.8728 ## Number of communities: 9 ## Elapsed time: 0 seconds 13.11 Reducci√≥n dimensional no lineal (UMAP/tSNE) Seurat ofrece varias t√©cnicas de reducci√≥n dimensional no lineal, como tSNE y UMAP, para visualizar y explorar estos conjuntos de datos. El objetivo de estos algoritmos es aprender la variedad subyacente de los datos para colocar celdas similares juntas en un espacio de baja dimensi√≥n. Las celdas dentro de los grupos basados en gr√°ficos determinados anteriormente deben ubicarse conjuntamente en estos gr√°ficos de reducci√≥n de dimensi√≥n. Como entrada para UMAP y tSNE, sugerimos usar las mismas PC como entrada para el an√°lisis de agrupamiento. # If you haven&#39;t installed UMAP, you can do so via reticulate::py_install(packages = &#39;umap-learn&#39;) pbmc &lt;- RunUMAP(pbmc, dims = 1:10) ## Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric ## To use Python UMAP via reticulate, set umap.method to &#39;umap-learn&#39; and metric to &#39;correlation&#39; ## This message will be shown once per session ## 22:35:53 UMAP embedding parameters a = 0.9922 b = 1.112 ## 22:35:53 Read 2638 rows and found 10 numeric columns ## 22:35:53 Using Annoy for neighbor search, n_neighbors = 30 ## 22:35:53 Building Annoy index with metric = cosine, n_trees = 50 ## 0% 10 20 30 40 50 60 70 80 90 100% ## [----|----|----|----|----|----|----|----|----|----| ## **************************************************| ## 22:35:53 Writing NN index file to temp file /tmp/Rtmp3QGO76/file7555c5a6153 ## 22:35:53 Searching Annoy index using 1 thread, search_k = 3000 ## 22:35:54 Annoy recall = 100% ## 22:35:54 Commencing smooth kNN distance calibration using 1 thread ## 22:35:55 Initializing from normalized Laplacian + noise ## 22:35:55 Commencing optimization for 500 epochs, with 105140 positive edges ## 22:35:59 Optimization finished # Note that you can set `label = TRUE` or use the LabelClusters function to help label # individual clusters DimPlot(pbmc, reduction = &quot;umap&quot;) Puede guardar el objeto en este punto para que se pueda volver a cargar f√°cilmente sin tener que volver a ejecutar los pasos computacionalmente intensivos realizados anteriormente o compartir f√°cilmente con los colaboradores. if (interactive()) { saveRDS(pbmc, file = &quot;pbmc_tutorial.rds&quot;) } 13.12 Caracteristicas diferencialmente expresadas (biomarcadores de los clusters) Seurat puede ayudarlo a encontrar marcadores que definan cl√∫steres mediante expresi√≥n diferencial. De forma predeterminada, identifica marcadores positivos y negativos de un solo grupo (especificado en ident.1), en comparaci√≥n con todas las dem√°s c√©lulas. FindAllMarkers() automatiza este proceso para todos los cl√∫steres, pero tambi√©n se pueden comparar grupos de cl√∫steres entre s√≠ o contra todas las celdas. El argumento min.pct requiere que se detecte una caracter√≠stica en un porcentaje m√≠nimo en cualquiera de los dos grupos de celdas, y el argumento thresh.test requiere que una caracter√≠stica se exprese diferencialmente (en promedio) en alguna cantidad entre los dos grupos. Puede establecer ambos en 0, pero con un aumento dram√°tico en el tiempo, ya que esto probar√° una gran cantidad de caracter√≠sticas que probablemente no sean altamente discriminatorias. Como otra opci√≥n para acelerar estos c√°lculos, se puede configurar el n√∫mero m√°ximo de celdas por identificador. Esto reducir√° la resoluci√≥n de cada clase de identidad para que no tenga m√°s celdas que las que se establezcan. Si bien generalmente habr√° una p√©rdida de potencia, los aumentos de velocidad pueden ser significativos y es probable que las caracter√≠sticas expresadas de manera m√°s diferencial a√∫n se eleven a la cima. # find all markers of cluster 2 cluster2.markers &lt;- FindMarkers(pbmc, ident.1 = 2, min.pct = 0.25) head(cluster2.markers, n = 5) ## p_val avg_log2FC pct.1 pct.2 p_val_adj ## IL32 2.892340e-90 1.2013522 0.947 0.465 3.966555e-86 ## LTB 1.060121e-86 1.2695776 0.981 0.643 1.453850e-82 ## CD3D 8.794641e-71 0.9389621 0.922 0.432 1.206097e-66 ## IL7R 3.516098e-68 1.1873213 0.750 0.326 4.821977e-64 ## LDHB 1.642480e-67 0.8969774 0.954 0.614 2.252497e-63 # find all markers distinguishing cluster 5 from clusters 0 and 3 cluster5.markers &lt;- FindMarkers(pbmc, ident.1 = 5, ident.2 = c(0, 3), min.pct = 0.25) head(cluster5.markers, n = 5) ## p_val avg_log2FC pct.1 pct.2 p_val_adj ## FCGR3A 8.246578e-205 4.261495 0.975 0.040 1.130936e-200 ## IFITM3 1.677613e-195 3.879339 0.975 0.049 2.300678e-191 ## CFD 2.401156e-193 3.405492 0.938 0.038 3.292945e-189 ## CD68 2.900384e-191 3.020484 0.926 0.035 3.977587e-187 ## RP11-290F20.3 2.513244e-186 2.720057 0.840 0.017 3.446663e-182 # find markers for every cluster compared to all remaining cells, report only the positive # ones pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE, min.pct = 0.25, logfc.threshold = 0.25) ## Calculating cluster 0 ## Calculating cluster 1 ## Calculating cluster 2 ## Calculating cluster 3 ## Calculating cluster 4 ## Calculating cluster 5 ## Calculating cluster 6 ## Calculating cluster 7 ## Calculating cluster 8 pbmc.markers %&gt;% group_by(cluster) %&gt;% top_n(n = 2, wt = avg_log2FC) ## Registered S3 method overwritten by &#39;cli&#39;: ## method from ## print.boxx spatstat.geom ## # A tibble: 18 √ó 7 ## # Groups: cluster [9] ## p_val avg_log2FC pct.1 pct.2 p_val_adj cluster gene ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt; ## 1 3.75e-112 1.09 0.912 0.592 5.14e-108 0 LDHB ## 2 9.57e- 88 1.36 0.447 0.108 1.31e- 83 0 CCR7 ## 3 0 5.57 0.996 0.215 0 1 S100A9 ## 4 0 5.48 0.975 0.121 0 1 S100A8 ## 5 1.06e- 86 1.27 0.981 0.643 1.45e- 82 2 LTB ## 6 2.97e- 58 1.23 0.42 0.111 4.07e- 54 2 AQP3 ## 7 0 4.31 0.936 0.041 0 3 CD79A ## 8 9.48e-271 3.59 0.622 0.022 1.30e-266 3 TCL1A ## 9 5.61e-202 3.10 0.983 0.234 7.70e-198 4 CCL5 ## 10 7.25e-165 3.00 0.577 0.055 9.95e-161 4 GZMK ## 11 3.51e-184 3.31 0.975 0.134 4.82e-180 5 FCGR3A ## 12 2.03e-125 3.09 1 0.315 2.78e-121 5 LST1 ## 13 7.95e-269 4.83 0.961 0.068 1.09e-264 6 GZMB ## 14 3.13e-191 5.32 0.961 0.131 4.30e-187 6 GNLY ## 15 1.48e-220 3.87 0.812 0.011 2.03e-216 7 FCER1A ## 16 1.67e- 21 2.87 1 0.513 2.28e- 17 7 HLA-DPB1 ## 17 9.25e-186 7.29 1 0.011 1.27e-181 8 PF4 ## 18 1.92e-102 8.59 1 0.024 2.63e- 98 8 PPBP Seurat tiene varias pruebas de expresi√≥n diferencial que se pueden configurar con el par√°metro test.use (consulte nuestra vi√±eta DE para obtener m√°s detalles). Por ejemplo, la prueba ROC devuelve el ‚Äúpoder de clasificaci√≥n‚Äù para cualquier marcador individual (que var√≠a de 0 - aleatorio a 1 - perfecto) . cluster0.markers &lt;- FindMarkers(pbmc, ident.1 = 0, logfc.threshold = 0.25, test.use = &quot;roc&quot;, only.pos = TRUE) Se incluyen varias herramientas para visualizar la expresi√≥n de los marcadores. VlnPlot() (muestra distribuciones de probabilidad de expresi√≥n entre cl√∫steres) y FeaturePlot() (visualiza la expresi√≥n de caracter√≠sticas en un gr√°fico tSNE o PCA) son nuestras visualizaciones m√°s utilizadas. Tambi√©n sugerimos explorar RidgePlot(), CellScatter() y DotPlot() como m√©todos adicionales para ver su conjunto de datos. VlnPlot(pbmc, features = c(&quot;MS4A1&quot;, &quot;CD79A&quot;)) ## you can plot raw counts as well VlnPlot(pbmc, features = c(&quot;NKG7&quot;, &quot;PF4&quot;), slot = &quot;counts&quot;, log = TRUE) FeaturePlot(pbmc, features = c( &quot;MS4A1&quot;, &quot;GNLY&quot;, &quot;CD3E&quot;, &quot;CD14&quot;, &quot;FCER1A&quot;, &quot;FCGR3A&quot;, &quot;LYZ&quot;, &quot;PPBP&quot;, &quot;CD8A&quot; )) # DoHeatmap() generates an expression heatmap for given cells and features. In this case, we are plotting the top 20 markers (or all markers if less than 20) for each cluster. pbmc.markers %&gt;% group_by(cluster) %&gt;% top_n(n = 10, wt = avg_log2FC) -&gt; top10 DoHeatmap(pbmc, features = top10$gene) + NoLegend() 13.13 Assigning cell type identity to clusters Podemos usar marcadores can√≥nicos para hacer coincidir f√°cilmente la agrupaci√≥n imparcial con los tipos de c√©lulas conocidos. new.cluster.ids &lt;- c( &quot;Naive CD4 T&quot;, &quot;CD14+ Mono&quot;, &quot;Memory CD4 T&quot;, &quot;B&quot;, &quot;CD8 T&quot;, &quot;FCGR3A+ Mono&quot;, &quot;NK&quot;, &quot;DC&quot;, &quot;Platelet&quot; ) names(new.cluster.ids) &lt;- levels(pbmc) pbmc &lt;- RenameIdents(pbmc, new.cluster.ids) DimPlot(pbmc, reduction = &quot;umap&quot;, label = TRUE, pt.size = 0.5) + NoLegend() 13.14 Guardar Resultados if (interactive()) { saveRDS(pbmc, file = &quot;pbmc3k_final.rds&quot;) } 13.15 Detalles de la sesi√≥n de R ## Informaci√≥n de la sesi√≥n de R Sys.time() ## [1] &quot;2021-08-09 22:36:37 UTC&quot; proc.time() ## user system elapsed ## 181.969 11.268 129.370 options(width = 120) sessioninfo::session_info() ## ‚îÄ Session info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## setting value ## version R version 4.1.0 (2021-05-18) ## os Ubuntu 20.04.2 LTS ## system x86_64, linux-gnu ## ui X11 ## language (EN) ## collate en_US.UTF-8 ## ctype en_US.UTF-8 ## tz UTC ## date 2021-08-09 ## ## ‚îÄ Packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ## package * version date lib source ## abind 1.4-5 2016-07-21 [1] RSPM (R 4.1.0) ## assertthat 0.2.1 2019-03-21 [1] RSPM (R 4.1.0) ## BiocFileCache * 2.0.0 2021-05-19 [1] Bioconductor ## bit 4.0.4 2020-08-04 [1] RSPM (R 4.1.0) ## bit64 4.0.5 2020-08-30 [1] RSPM (R 4.1.0) ## blob 1.2.2 2021-07-23 [1] RSPM (R 4.1.0) ## bookdown 0.22 2021-04-22 [1] RSPM (R 4.1.0) ## bslib 0.2.5.1 2021-05-18 [1] RSPM (R 4.1.0) ## cachem 1.0.5 2021-05-15 [2] RSPM (R 4.1.0) ## cli 3.0.1 2021-07-17 [2] RSPM (R 4.1.0) ## cluster 2.1.2 2021-04-17 [3] CRAN (R 4.1.0) ## codetools 0.2-18 2020-11-04 [3] CRAN (R 4.1.0) ## colorspace 2.0-2 2021-06-24 [1] RSPM (R 4.1.0) ## cowplot 1.1.1 2020-12-30 [1] RSPM (R 4.1.0) ## crayon 1.4.1 2021-02-08 [2] RSPM (R 4.1.0) ## curl 4.3.2 2021-06-23 [2] RSPM (R 4.1.0) ## data.table 1.14.0 2021-02-21 [1] RSPM (R 4.1.0) ## DBI 1.1.1 2021-01-15 [1] RSPM (R 4.1.0) ## dbplyr * 2.1.1 2021-04-06 [1] RSPM (R 4.1.0) ## deldir 0.2-10 2021-02-16 [1] RSPM (R 4.1.0) ## digest 0.6.27 2020-10-24 [2] RSPM (R 4.1.0) ## dplyr * 1.0.7 2021-06-18 [1] RSPM (R 4.1.0) ## ellipsis 0.3.2 2021-04-29 [2] RSPM (R 4.1.0) ## evaluate 0.14 2019-05-28 [2] RSPM (R 4.1.0) ## fansi 0.5.0 2021-05-25 [2] RSPM (R 4.1.0) ## farver 2.1.0 2021-02-28 [1] RSPM (R 4.1.0) ## fastmap 1.1.0 2021-01-25 [2] RSPM (R 4.1.0) ## filelock 1.0.2 2018-10-05 [1] RSPM (R 4.1.0) ## fitdistrplus 1.1-5 2021-05-28 [1] RSPM (R 4.1.0) ## future 1.21.0 2020-12-10 [1] RSPM (R 4.1.0) ## future.apply 1.7.0 2021-01-04 [1] RSPM (R 4.1.0) ## generics 0.1.0 2020-10-31 [1] RSPM (R 4.1.0) ## ggplot2 3.3.5 2021-06-25 [1] RSPM (R 4.1.0) ## ggrepel 0.9.1 2021-01-15 [1] RSPM (R 4.1.0) ## ggridges 0.5.3 2021-01-08 [1] RSPM (R 4.1.0) ## globals 0.14.0 2020-11-22 [1] RSPM (R 4.1.0) ## glue 1.4.2 2020-08-27 [2] RSPM (R 4.1.0) ## goftest 1.2-2 2019-12-02 [1] RSPM (R 4.1.0) ## gridExtra 2.3 2017-09-09 [1] RSPM (R 4.1.0) ## gtable 0.3.0 2019-03-25 [1] RSPM (R 4.1.0) ## highr 0.9 2021-04-16 [2] RSPM (R 4.1.0) ## htmltools 0.5.1.1 2021-01-22 [1] RSPM (R 4.1.0) ## htmlwidgets 1.5.3 2020-12-10 [1] RSPM (R 4.1.0) ## httpuv 1.6.1 2021-05-07 [1] RSPM (R 4.1.0) ## httr 1.4.2 2020-07-20 [2] RSPM (R 4.1.0) ## ica 1.0-2 2018-05-24 [1] RSPM (R 4.1.0) ## igraph 1.2.6 2020-10-06 [1] RSPM (R 4.1.0) ## irlba 2.3.3 2019-02-05 [1] RSPM (R 4.1.0) ## jquerylib 0.1.4 2021-04-26 [1] RSPM (R 4.1.0) ## jsonlite 1.7.2 2020-12-09 [2] RSPM (R 4.1.0) ## KernSmooth 2.23-20 2021-05-03 [3] CRAN (R 4.1.0) ## knitr 1.33 2021-04-24 [2] RSPM (R 4.1.0) ## labeling 0.4.2 2020-10-20 [1] RSPM (R 4.1.0) ## later 1.2.0 2021-04-23 [1] RSPM (R 4.1.0) ## lattice 0.20-44 2021-05-02 [3] CRAN (R 4.1.0) ## lazyeval 0.2.2 2019-03-15 [1] RSPM (R 4.1.0) ## leiden 0.3.9 2021-07-27 [1] RSPM (R 4.1.0) ## lifecycle 1.0.0 2021-02-15 [2] RSPM (R 4.1.0) ## limma 3.48.2 2021-08-08 [1] Bioconductor ## listenv 0.8.0 2019-12-05 [1] RSPM (R 4.1.0) ## lmtest 0.9-38 2020-09-09 [1] RSPM (R 4.1.0) ## magrittr 2.0.1 2020-11-17 [2] RSPM (R 4.1.0) ## MASS 7.3-54 2021-05-03 [3] CRAN (R 4.1.0) ## Matrix 1.3-4 2021-06-01 [3] RSPM (R 4.1.0) ## matrixStats 0.60.0 2021-07-26 [1] RSPM (R 4.1.0) ## memoise 2.0.0 2021-01-26 [2] RSPM (R 4.1.0) ## mgcv 1.8-36 2021-06-01 [3] RSPM (R 4.1.0) ## mime 0.11 2021-06-23 [2] RSPM (R 4.1.0) ## miniUI 0.1.1.1 2018-05-18 [1] RSPM (R 4.1.0) ## munsell 0.5.0 2018-06-12 [1] RSPM (R 4.1.0) ## nlme 3.1-152 2021-02-04 [3] CRAN (R 4.1.0) ## parallelly 1.27.0 2021-07-19 [1] RSPM (R 4.1.0) ## patchwork * 1.1.1 2020-12-17 [1] RSPM (R 4.1.0) ## pbapply 1.4-3 2020-08-18 [1] RSPM (R 4.1.0) ## pillar 1.6.2 2021-07-29 [2] RSPM (R 4.1.0) ## pkgconfig 2.0.3 2019-09-22 [2] RSPM (R 4.1.0) ## plotly 4.9.4.1 2021-06-18 [1] RSPM (R 4.1.0) ## plyr 1.8.6 2020-03-03 [1] RSPM (R 4.1.0) ## png 0.1-7 2013-12-03 [1] RSPM (R 4.1.0) ## polyclip 1.10-0 2019-03-14 [1] RSPM (R 4.1.0) ## promises 1.2.0.1 2021-02-11 [1] RSPM (R 4.1.0) ## purrr 0.3.4 2020-04-17 [2] RSPM (R 4.1.0) ## R6 2.5.0 2020-10-28 [2] RSPM (R 4.1.0) ## RANN 2.6.1 2019-01-08 [1] RSPM (R 4.1.0) ## rappdirs 0.3.3 2021-01-31 [2] RSPM (R 4.1.0) ## RColorBrewer 1.1-2 2014-12-07 [1] RSPM (R 4.1.0) ## Rcpp 1.0.7 2021-07-07 [2] RSPM (R 4.1.0) ## RcppAnnoy 0.0.19 2021-07-30 [1] RSPM (R 4.1.0) ## reshape2 1.4.4 2020-04-09 [1] RSPM (R 4.1.0) ## reticulate 1.20 2021-05-03 [1] RSPM (R 4.1.0) ## rlang 0.4.11 2021-04-30 [2] RSPM (R 4.1.0) ## rmarkdown 2.10 2021-08-06 [1] RSPM (R 4.1.0) ## ROCR 1.0-11 2020-05-02 [1] RSPM (R 4.1.0) ## rpart 4.1-15 2019-04-12 [3] CRAN (R 4.1.0) ## RSpectra 0.16-0 2019-12-01 [1] RSPM (R 4.1.0) ## RSQLite 2.2.7 2021-04-22 [1] RSPM (R 4.1.0) ## Rtsne 0.15 2018-11-10 [1] RSPM (R 4.1.0) ## sass 0.4.0 2021-05-12 [1] RSPM (R 4.1.0) ## scales 1.1.1 2020-05-11 [1] RSPM (R 4.1.0) ## scattermore 0.7 2020-11-24 [1] RSPM (R 4.1.0) ## sctransform 0.3.2 2020-12-16 [1] RSPM (R 4.1.0) ## sessioninfo 1.1.1 2018-11-05 [2] RSPM (R 4.1.0) ## Seurat * 4.0.3 2021-06-10 [1] RSPM (R 4.1.0) ## SeuratObject * 4.0.2 2021-06-09 [1] RSPM (R 4.1.0) ## shiny 1.6.0 2021-01-25 [1] RSPM (R 4.1.0) ## spatstat.core 2.3-0 2021-07-16 [1] RSPM (R 4.1.0) ## spatstat.data 2.1-0 2021-03-21 [1] RSPM (R 4.1.0) ## spatstat.geom 2.2-2 2021-07-12 [1] RSPM (R 4.1.0) ## spatstat.sparse 2.0-0 2021-03-16 [1] RSPM (R 4.1.0) ## spatstat.utils 2.2-0 2021-06-14 [1] RSPM (R 4.1.0) ## stringi 1.7.3 2021-07-16 [2] RSPM (R 4.1.0) ## stringr 1.4.0 2019-02-10 [2] RSPM (R 4.1.0) ## survival 3.2-11 2021-04-26 [3] CRAN (R 4.1.0) ## tensor 1.5 2012-05-05 [1] RSPM (R 4.1.0) ## tibble 3.1.3 2021-07-23 [2] RSPM (R 4.1.0) ## tidyr 1.1.3 2021-03-03 [1] RSPM (R 4.1.0) ## tidyselect 1.1.1 2021-04-30 [1] RSPM (R 4.1.0) ## utf8 1.2.2 2021-07-24 [2] RSPM (R 4.1.0) ## uwot 0.1.10 2020-12-15 [1] RSPM (R 4.1.0) ## vctrs 0.3.8 2021-04-29 [2] RSPM (R 4.1.0) ## viridisLite 0.4.0 2021-04-13 [1] RSPM (R 4.1.0) ## withr 2.4.2 2021-04-18 [2] RSPM (R 4.1.0) ## xfun 0.25 2021-08-06 [2] RSPM (R 4.1.0) ## xtable 1.8-4 2019-04-21 [1] RSPM (R 4.1.0) ## zoo 1.8-9 2021-03-09 [1] RSPM (R 4.1.0) ## ## [1] /__w/_temp/Library ## [2] /usr/local/lib/R/site-library ## [3] /usr/local/lib/R/library Patrocinadores Agradecemos a nuestros patrocinadores: "]]
