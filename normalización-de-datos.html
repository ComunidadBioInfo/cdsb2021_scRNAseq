<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Normalización de datos | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor</title>
  <meta name="description" content="6 Normalización de datos | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Normalización de datos | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="ComunidadBioInfo/cdsb2021_scRNAseq" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Normalización de datos | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="icon_32.png" type="image/x-icon" />
<link rel="prev" href="control-de-calidad.html"/>
<link rel="next" href="selección-de-genes.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del taller</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formato-del-curso-en-línea"><i class="fa fa-check"></i>Formato del curso: en línea</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quién-es-nuestra-audiencia"><i class="fa fa-check"></i>¿Quién es nuestra audiencia?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formulario-de-registro"><i class="fa fa-check"></i>Formulario de registro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructores"><i class="fa fa-check"></i>Instructores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ponentes-e-instructores-invitados"><i class="fa fa-check"></i>Ponentes e instructores invitados</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ayudantes"><i class="fa fa-check"></i>Ayudantes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#código-de-conducta"><i class="fa fa-check"></i>Código de Conducta</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisitos"><i class="fa fa-check"></i>Pre-requisitos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#horario"><i class="fa fa-check"></i>Horario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#materiales"><i class="fa fa-check"></i>Materiales</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#zoom"><i class="fa fa-check"></i>Zoom</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organizadores"><i class="fa fa-check"></i>Organizadores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#patrocinadores"><i class="fa fa-check"></i>Patrocinadores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#información-sesión-de-r"><i class="fa fa-check"></i>Información sesión de R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licencia"><i class="fa fa-check"></i>Licencia</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introducción a R y RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#r"><i class="fa fa-check"></i><b>1.1</b> R</a></li>
<li class="chapter" data-level="1.2" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#github"><i class="fa fa-check"></i><b>1.2</b> GitHub</a></li>
<li class="chapter" data-level="1.3" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#rstudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#material-del-curso"><i class="fa fa-check"></i><b>1.4</b> Material del curso</a></li>
<li class="chapter" data-level="" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#patrocinadores-1"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html"><i class="fa fa-check"></i><b>2</b> Ejercicio usando <code>usethis</code>, <code>here</code> y <code>postcards</code></a>
<ul>
<li class="chapter" data-level="" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#patrocinadores-2"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><i class="fa fa-check"></i><b>3</b> Introducción a RNA-seq de célula única (scRNA-seq) con Bioconductor y al libro de OSCA</a>
<ul>
<li class="chapter" data-level="" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#patrocinadores-3"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html"><i class="fa fa-check"></i><b>4</b> Estructura e importe de datos</a>
<ul>
<li class="chapter" data-level="" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#patrocinadores-4"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-de-calidad.html"><a href="control-de-calidad.html"><i class="fa fa-check"></i><b>5</b> Control de calidad</a>
<ul>
<li class="chapter" data-level="" data-path="control-de-calidad.html"><a href="control-de-calidad.html#patrocinadores-5"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html"><i class="fa fa-check"></i><b>6</b> Normalización de datos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#material"><i class="fa fa-check"></i><b>6.1</b> Material</a></li>
<li class="chapter" data-level="6.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#motivación"><i class="fa fa-check"></i><b>6.2</b> Motivación</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-conceptos-básicos"><i class="fa fa-check"></i><b>6.2.1</b> Ejercicio: Conceptos básicos</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#datos"><i class="fa fa-check"></i><b>6.3</b> Datos</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-qc"><i class="fa fa-check"></i><b>6.3.1</b> Ejercicio: QC</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#normalización-por-escalamiento-scaling-normalization"><i class="fa fa-check"></i><b>6.4</b> Normalización por escalamiento (scaling normalization)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#tamaño-de-biblioteca-library-size"><i class="fa fa-check"></i><b>6.4.1</b> Tamaño de biblioteca (<em>Library Size</em>)</a></li>
<li class="chapter" data-level="6.4.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-library-size"><i class="fa fa-check"></i><b>6.4.2</b> Ejercicio: <em>library Size</em></a></li>
<li class="chapter" data-level="6.4.3" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#puntos-finales"><i class="fa fa-check"></i><b>6.4.3</b> Puntos finales</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#normalización-por-decircunvolución-deconvolution"><i class="fa fa-check"></i><b>6.5</b> Normalización por decircunvolución (deconvolution)</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicios-deconvolution"><i class="fa fa-check"></i><b>6.5.1</b> Ejercicios: deconvolution</a></li>
<li class="chapter" data-level="6.5.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#puntos-finales-1"><i class="fa fa-check"></i><b>6.5.2</b> Puntos finales</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#transformación-logatítmica"><i class="fa fa-check"></i><b>6.6</b> Transformación logatítmica</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#motivación-1"><i class="fa fa-check"></i><b>6.6.1</b> Motivación</a></li>
<li class="chapter" data-level="6.6.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-transformación-logatítmica"><i class="fa fa-check"></i><b>6.6.2</b> Ejercicio: Transformación logatítmica</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#otras-normalizaciones"><i class="fa fa-check"></i><b>6.7</b> Otras normalizaciones</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#seurat"><i class="fa fa-check"></i><b>6.7.1</b> Seurat</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#notas-finales"><i class="fa fa-check"></i><b>6.8</b> Notas finales</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-conceptos-básicos-1"><i class="fa fa-check"></i><b>6.8.1</b> Ejercicio: Conceptos básicos</a></li>
<li class="chapter" data-level="6.8.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-qc-1"><i class="fa fa-check"></i><b>6.8.2</b> Ejercicio: QC</a></li>
<li class="chapter" data-level="6.8.3" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-library-size-1"><i class="fa fa-check"></i><b>6.8.3</b> Ejercicio: <em>library Size</em></a></li>
<li class="chapter" data-level="6.8.4" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicios-deconvolution-1"><i class="fa fa-check"></i><b>6.8.4</b> Ejercicios: deconvolution</a></li>
<li class="chapter" data-level="6.8.5" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-transformación-logatítmica-1"><i class="fa fa-check"></i><b>6.8.5</b> Ejercicio: Transformación logatítmica</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#adicionales"><i class="fa fa-check"></i><b>6.9</b> Adicionales</a></li>
<li class="chapter" data-level="6.10" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#agradecimientos"><i class="fa fa-check"></i><b>6.10</b> Agradecimientos</a></li>
<li class="chapter" data-level="6.11" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#detalles-de-la-sesión-de-r"><i class="fa fa-check"></i><b>6.11</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#patrocinadores-6"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="selección-de-genes.html"><a href="selección-de-genes.html"><i class="fa fa-check"></i><b>7</b> Selección de genes</a>
<ul>
<li class="chapter" data-level="" data-path="selección-de-genes.html"><a href="selección-de-genes.html#patrocinadores-7"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html"><i class="fa fa-check"></i><b>8</b> Reducción de dimensiones</a>
<ul>
<li class="chapter" data-level="8.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#diapositivas-de-peter-hickey"><i class="fa fa-check"></i><b>8.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="8.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#motivación-2"><i class="fa fa-check"></i><b>8.2</b> Motivación</a></li>
<li class="chapter" data-level="8.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#reducción-de-dimensionalidad"><i class="fa fa-check"></i><b>8.3</b> Reducción de dimensionalidad</a></li>
<li class="chapter" data-level="8.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#dataset-ilustrativo-zeisel"><i class="fa fa-check"></i><b>8.4</b> Dataset ilustrativo: Zeisel</a></li>
<li class="chapter" data-level="8.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#dataset-ilustrativo-10x-pbmc4k-no-filtradas"><i class="fa fa-check"></i><b>8.5</b> Dataset ilustrativo: 10x PBMC4k no filtradas</a></li>
<li class="chapter" data-level="8.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>8.6</b> Análisis de Componentes Principales</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#pca-aplicado-a-datos-de-scrna-seq"><i class="fa fa-check"></i><b>8.6.1</b> PCA aplicado a datos de scRNA-seq</a></li>
<li class="chapter" data-level="8.6.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#suposiciones-de-pca-aplicadas-a-los-datos-de-scrna-seq"><i class="fa fa-check"></i><b>8.6.2</b> Suposiciones de PCA aplicadas a los datos de scRNA-seq</a></li>
<li class="chapter" data-level="8.6.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#eligiendo-el-número-de-pcs"><i class="fa fa-check"></i><b>8.6.3</b> Eligiendo el número de PCs</a></li>
<li class="chapter" data-level="8.6.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#juntando-todo"><i class="fa fa-check"></i><b>8.6.4</b> Juntando todo</a></li>
<li class="chapter" data-level="8.6.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#usando-el-ruido-técnico"><i class="fa fa-check"></i><b>8.6.5</b> Usando el ruido técnico</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#reducción-de-dimensionalidad-para-visualización"><i class="fa fa-check"></i><b>8.7</b> Reducción de dimensionalidad para visualización</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#motivación-3"><i class="fa fa-check"></i><b>8.7.1</b> Motivación</a></li>
<li class="chapter" data-level="8.7.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualizando-con-pca"><i class="fa fa-check"></i><b>8.7.2</b> Visualizando con PCA</a></li>
<li class="chapter" data-level="8.7.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#retos-y-resumen-de-la-visualización-con-pca"><i class="fa fa-check"></i><b>8.7.3</b> Retos y resumen de la visualización con PCA</a></li>
<li class="chapter" data-level="8.7.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualización-con-t-sne"><i class="fa fa-check"></i><b>8.7.4</b> Visualización con t-SNE</a></li>
<li class="chapter" data-level="8.7.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualización-con-umap"><i class="fa fa-check"></i><b>8.7.5</b> Visualización con UMAP</a></li>
<li class="chapter" data-level="8.7.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#interpretando-las-gráficas"><i class="fa fa-check"></i><b>8.7.6</b> Interpretando las gráficas</a></li>
<li class="chapter" data-level="8.7.7" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#resumen-y-recomendaciones"><i class="fa fa-check"></i><b>8.7.7</b> Resumen y recomendaciones</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#donde-estamos"><i class="fa fa-check"></i><b>8.8</b> Donde estamos</a></li>
<li class="chapter" data-level="" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#patrocinadores-8"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#diapositivas-de-peter-hickey-1"><i class="fa fa-check"></i><b>9.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#dataset-ilustrativo-10x-pbmc4k-no-filtrado"><i class="fa fa-check"></i><b>9.2</b> Dataset ilustrativo: 10X PBMC4k no filtrado</a></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#motivación-4"><i class="fa fa-check"></i><b>9.3</b> Motivación</a></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#por-qué-no-realizamos-el-clustering-sobre-las-coordenadas-de-t-sneumap"><i class="fa fa-check"></i><b>9.4</b> ¿Por qué no realizamos el clustering sobre las coordenadas de t-SNE/UMAP?</a></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#cuál-es-el-verdadero-clustering"><i class="fa fa-check"></i><b>9.5</b> ¿Cuál es el verdadero clustering?</a></li>
<li class="chapter" data-level="9.6" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-grafos"><i class="fa fa-check"></i><b>9.6</b> Clustering basado en grafos</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="clustering.html"><a href="clustering.html#antecedentes"><i class="fa fa-check"></i><b>9.6.1</b> Antecedentes</a></li>
<li class="chapter" data-level="9.6.2" data-path="clustering.html"><a href="clustering.html#gráfica-de-los-k-vecinos-más-cercanos-k-nearest-neighbour--knn--graph"><i class="fa fa-check"></i><b>9.6.2</b> Gráfica de los <em>k</em> vecinos más cercanos (k-nearest neighbour -KNN- graph)</a></li>
<li class="chapter" data-level="9.6.3" data-path="clustering.html"><a href="clustering.html#gráfica-de-los-vecinos-más-próximos-compartidos-snn"><i class="fa fa-check"></i><b>9.6.3</b> Gráfica de los vecinos más próximos compartidos (SNN)</a></li>
<li class="chapter" data-level="9.6.4" data-path="clustering.html"><a href="clustering.html#gráfica-snn-con-pesos-en-las-aristas"><i class="fa fa-check"></i><b>9.6.4</b> Gráfica SNN con pesos en las aristas</a></li>
<li class="chapter" data-level="9.6.5" data-path="clustering.html"><a href="clustering.html#pasando-de-una-gráfica-snn-pesada-cluster-mediante-detección-de-comunidades"><i class="fa fa-check"></i><b>9.6.5</b> Pasando de una gráfica SNN pesada cluster mediante detección de comunidades</a></li>
<li class="chapter" data-level="9.6.6" data-path="clustering.html"><a href="clustering.html#resumen-de-clustering-basado-en-grafos"><i class="fa fa-check"></i><b>9.6.6</b> Resumen de clustering basado en grafos</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="clustering.html"><a href="clustering.html#implementación"><i class="fa fa-check"></i><b>9.7</b> Implementación</a></li>
<li class="chapter" data-level="9.8" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-grafos-1"><i class="fa fa-check"></i><b>9.8</b> Clustering basado en grafos</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="clustering.html"><a href="clustering.html#detalles-adicionales-del-ejemplo-previo"><i class="fa fa-check"></i><b>9.8.1</b> Detalles adicionales del ejemplo previo</a></li>
<li class="chapter" data-level="9.8.2" data-path="clustering.html"><a href="clustering.html#eligiendo-un-valor-de-k"><i class="fa fa-check"></i><b>9.8.2</b> Eligiendo un valor de <em>k</em></a></li>
<li class="chapter" data-level="9.8.3" data-path="clustering.html"><a href="clustering.html#estilo-seurat"><i class="fa fa-check"></i><b>9.8.3</b> Estilo Seurat</a></li>
<li class="chapter" data-level="9.8.4" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-un-grafo"><i class="fa fa-check"></i><b>9.8.4</b> Clustering basado en un grafo</a></li>
<li class="chapter" data-level="9.8.5" data-path="clustering.html"><a href="clustering.html#evaluando-la-separación-de-los-clusters"><i class="fa fa-check"></i><b>9.8.5</b> Evaluando la separación de los clusters</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="clustering.html"><a href="clustering.html#otros-métodos-de-clustering"><i class="fa fa-check"></i><b>9.9</b> Otros métodos de clustering</a></li>
<li class="chapter" data-level="9.10" data-path="clustering.html"><a href="clustering.html#evaluando-estabilidad-de-los-clusters"><i class="fa fa-check"></i><b>9.10</b> Evaluando estabilidad de los clusters</a></li>
<li class="chapter" data-level="9.11" data-path="clustering.html"><a href="clustering.html#subclustering"><i class="fa fa-check"></i><b>9.11</b> Subclustering</a></li>
<li class="chapter" data-level="9.12" data-path="clustering.html"><a href="clustering.html#resumen-y-recomendaciones-1"><i class="fa fa-check"></i><b>9.12</b> Resumen y recomendaciones</a></li>
<li class="chapter" data-level="9.13" data-path="clustering.html"><a href="clustering.html#donde-estamos-1"><i class="fa fa-check"></i><b>9.13</b> Donde estamos</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#patrocinadores-9"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html"><i class="fa fa-check"></i><b>10</b> Identificación de genes marcadores</a>
<ul>
<li class="chapter" data-level="" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#patrocinadores-10"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html"><i class="fa fa-check"></i><b>11</b> Anotación de clusters de células</a>
<ul>
<li class="chapter" data-level="" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#patrocinadores-11"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html"><i class="fa fa-check"></i><b>12</b> Análisis de expresión diferencial</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#patrocinadores-12"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html"><i class="fa fa-check"></i><b>13</b> Introducción a Seurat</a>
<ul>
<li class="chapter" data-level="" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#patrocinadores-13"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="normalización-de-datos" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Normalización de datos</h1>
<p>Instructora: <a href="https://comunidadbioinfo.github.io/es/authors/anabva/">Ana Beatriz Villaseñor Altamirano</a></p>
<div id="material" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Material</h2>
<ul>
<li><p>Diapositivas de Peter Hickey: Ve las diapositivas <a href="https://docs.google.com/presentation/d/1_tCNLiEsQ_TgsqHHf9_1lzXSaM_LunEHxBq3k130dQI/edit#slide=id.g7cc450648d_0_6">aquí</a></p></li>
<li><p>Capítulo de OSCA: Ve el capítulo del libro OSCA <a href="https://bioconductor.org/books/release/OSCA/normalization.html">aquí</a></p></li>
</ul>
</div>
<div id="motivación" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Motivación</h2>
<p>Al igual que otras tecnologías, sigle-cell RNA-seq (scRNA-seq) tiene errores sistemáticos y es importante conocerlos.</p>
<p>Dentro de los más comunes se encuentran la captura de cDNA y la amplificación de PCR que se lleva acabo por célula. Tener poco material de inicio dificulta lograr una preparación de libreria consistente dando lugar a errores sistemáticos.</p>
<div class="figure"><span id="fig:unnamed-chunk-1"></span>
<img src="https://scrnaseq-course.cog.sanger.ac.uk/website/figures/RNA-Seq_workflow-5.pdf.jpg" alt="Figura tomada de [1]"  />
<p class="caption">
Figure 6.1: Figura tomada de [1]
</p>
</div>
<p>La <strong>normalización</strong> tiene como objetivo remover estás diffencias sistemáticas para que no interfieran cuando comparamos los periles de expresión entre células.</p>
<p>Al normalizar los datos, las diferencias observadas entre poblaciones célulares o condiciones son debido a la biología y no por factores técnicos.</p>
<div id="ejercicio-conceptos-básicos" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Ejercicio: Conceptos básicos</h3>
<ul>
<li><p>Da ejemplos de sesgos técnicos (TIP: ¿Qué es RPKM?).</p></li>
<li><p>¿Qué es correción por lote (<em>batch effect correction</em>)? Da un ejemplo.</p></li>
<li><p>¿Cuáles son las diferencias entre correción por lote y normalización?</p></li>
</ul>
</div>
</div>
<div id="datos" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Datos</h2>
<p>Usaremos el dataset de <a href="https://bioconductor.org/books/release/OSCA/zeisel-mouse-brain-strt-seq.html"><strong>Zeisel</strong></a>.</p>
<ul>
<li><p>Tipos ceulares en cerebro de ratón (oligodendrocitos, microglias, neuronas, etc.)</p></li>
<li><p>Procesado con STRT-seq (similar a CEL-seq), un sistema de microfluio.</p></li>
<li><p>3005 células y 18441 genes</p></li>
<li><p>Contiene UMIs</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="normalización-de-datos.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;scRNAseq&#39;</span>)</span>
<span id="cb15-2"><a href="normalización-de-datos.html#cb15-2" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">ZeiselBrainData</span>(<span class="at">ensembl =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-3"><a href="normalización-de-datos.html#cb15-3" aria-hidden="true" tabindex="-1"></a>sce.zeisel</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 18441 3005 
## metadata(0):
## assays(1): counts
## rownames(18441): ENSMUSG00000029669 ENSMUSG00000046982 ...
##   ENSMUSG00000064337 ENSMUSG00000065947
## rowData names(2): featureType originalName
## colnames(3005): 1772071015_C02 1772071017_G12 ... 1772066098_A12
##   1772058148_F03
## colData names(10): tissue group # ... level1class level2class
## reducedDimNames(0):
## altExpNames(2): ERCC repeat</code></pre>
<div id="ejercicio-qc" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Ejercicio: QC</h3>
<ul>
<li><p>¿Cuántos genes son mitocondriales? (TIP: <code>is.mito</code>)</p></li>
<li><p>¿Cuántos genes tienen: bajas cuentas de librería, bajos features, alto porcentaje de expresión de ERCC, alto porcentaje de genes MT? ¿Cuántas células descartamos? (TIP: <code>perCellQCMetrics</code> y <code>quickPerCellQC</code>)</p></li>
<li><p>Gráfica los resultados</p></li>
</ul>
</div>
</div>
<div id="normalización-por-escalamiento-scaling-normalization" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Normalización por escalamiento (scaling normalization)</h2>
<p>La normalización por escalamiento es la estrategia más simple y usada.</p>
<p>Representa el estimado del sesgo relativo en cada célula.</p>
<p>Se realiza dividiendo todas las cuentas de cada célula por un factor de escalamiento específico para cada una. Este factor de escalamiento se le conoce como <em>Library Size factor</em>.</p>
<p><span class="math display">\[ CuentasNormalizadas = Cuentas / Library Size factor\]</span></p>
<p>Suposición: Cualquier sesgo específico en cada célula (e.j. eficiencia en la captura o en la amplificación) afecta a <strong>todos los genes de igual manera</strong> a través de escalar por el promedio esperado de cuentas para dicha célula.</p>
<p>Los valores de expresión normalizados pueden ser usados por análisis posteriores como <em>clustering</em> o <em>reducción de dimenciones</em>.</p>
<div id="tamaño-de-biblioteca-library-size" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Tamaño de biblioteca (<em>Library Size</em>)</h3>
<p><strong>Tamaño de biblioteca (<em>Library Size</em>):</strong> La suma total de las cuentas a tráves de todos los genes en una célula.</p>
<p><span class="math display">\[Library Size_{cell} = \sum_{n=1}^{j} gene\]</span>
Donde <span class="math inline">\(j\)</span> es el número total de genes y <span class="math inline">\(gene\)</span> es el número de cuentas por gen para cada célula.</p>
<p>El valor de <em>library size</em> es el que asumimos que escala con cualquier sesgo específico en cada célula.</p>
<p>Para escalar los datos ocuparemos un factor de escalamiento llamado <em>Library Size factor</em>.</p>
<p><span class="math display">\[ Library Size \propto Library Size factor \]</span></p>
<p>Se calcula usando <em>library size</em>:</p>
<p><span class="math display">\[ Library Size factor =  {Library Size} / {mean(Library Size)}\]</span></p>
<p>Y se define de tal manera que el promedio de <em>Library Size factor</em> en todas las células es igual a 1.</p>
<p><span class="math display">\[ mean(Library Size factor) = 1 \]</span></p>
<p>Lo que nos permite que los valores normalizados están en la misma escala y pueden ser útiles para la interpretación.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="normalización-de-datos.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimar tamaños de librerías</span></span>
<span id="cb17-2"><a href="normalización-de-datos.html#cb17-2" aria-hidden="true" tabindex="-1"></a>lib.sf.zeisel <span class="ot">&lt;-</span> <span class="fu">librarySizeFactors</span>(sce.zeisel)</span>
<span id="cb17-3"><a href="normalización-de-datos.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Examina la distribución de los tamaños de librerías</span></span>
<span id="cb17-4"><a href="normalización-de-datos.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># que acabamos de estimar</span></span>
<span id="cb17-5"><a href="normalización-de-datos.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lib.sf.zeisel)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.1754  0.5682  0.8669  1.0000  1.2758  4.0651</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="normalización-de-datos.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log10</span>(lib.sf.zeisel), <span class="at">xlab =</span> <span class="st">&quot;Log10[Library Size factor]&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey80&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/all_code2-1.png" width="672" /></p>
</div>
<div id="ejercicio-library-size" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Ejercicio: <em>library Size</em></h3>
<ul>
<li><p>Revisa los detalles (<strong>Details</strong>) en <code>?scater::librarySizeFactors</code></p></li>
<li><p>Calcula <em>library Size</em> <code>ls.zeisel</code></p></li>
<li><p>¿Son idénticos <code>ls.zeisel</code> y <code>lib.sf.zeisel</code>?</p></li>
<li><p>¿Son proporcionales?</p></li>
<li><p>Calcula <code>lib.sf.zeisel</code> de forma manual. TIP: Checa el <a href="https://github.com/LTLA/scuttle/blob/master/R/librarySizeFactors.R">código fuente</a></p></li>
</ul>
</div>
<div id="puntos-finales" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Puntos finales</h3>
<ul>
<li><p>Normalizar por <em>Library Size factor</em> asume que no hay desigualdad en la cantidad de genes differencialmente expresados (DE) entre dos células. Es decir, que para cada grupo de genes sobre-expresados, debe existir un grupo de genes sub-expresados en la misma magnitud, cuando esto no pasa se le conoce como <em>sesgo de composición</em> (Veáse a continuación).</p></li>
<li><p>Para análisis exploratorios, la precisión de la normalización no es un punto mayor a considerar. El sesgo por composición normalmente no afecta la separación de los clusters, solo la magnitud.</p></li>
<li><p>La normalización por <em>Library Size factor</em> suele ser suficiente en algunas ocasiones donde se busca identificar clusters y los marcadores de los clusters.</p></li>
</ul>
</div>
</div>
<div id="normalización-por-decircunvolución-deconvolution" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Normalización por decircunvolución (deconvolution)</h2>
<p>Un sesgo técnico que es importante considerar es el <em>sesgo de composición</em> de RNA (transcriptoma).</p>
<p>Supongamos que un gen X (o grupo de genes) se expresa en mayor cantidad en la célula A comparado a la célula B. Esto significa que más recursos fueron tomados por el gen X, disminuyendo la covertura de los demás.</p>
<p>¿Qué pasa si escalamos por tamaño de biblioteca?</p>
<div class="figure"><span id="fig:unnamed-chunk-3"></span>
<img src="https://hbctraining.github.io/DGE_workshop/img/normalization_methods_composition.png" alt="Figura tomada de [2]"  />
<p class="caption">
Figure 6.2: Figura tomada de [2]
</p>
</div>
<p>Este problema ha sido estudiado en bulk RNA-seq, <code>DESeq2::estimateSizeFactorsFromMatrix()</code> y <code>edgeR::calcNormFactors()</code>, contemplan este sesgo. Se assume que la mayoría de genes no estarán DE entre las muestras (en nuestro caso céluas) y cualquier diferencia entre los genes non-DE representa un sesgo el cual se remueve (calculando un factor de normalización).</p>
<p>Sin embargo, single-cell RNA-seq tiene muchas cuentas bajas y ceros debido a limitaciones en la tecnología y no necesariamente indica ausencia de expresión.</p>
<p>El método de <code>scran</code> resuelve este problema juntando las cuentas de varias células (pool) para incrementar el tamaño de las cuentas y obtener un factor de estimación que remueva el sesgo de composición de manera más precisa.</p>
<p>Este factor calculado con las cuentas pool se les regresa individualmente a cada célula mediante decircunvolución (deconvolution). Utilizando este factor se normalizan los datos con <code>scran::calculateSumFactors()</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="normalización-de-datos.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalización por decircunvolución (deconvolution)</span></span>
<span id="cb20-2"><a href="normalización-de-datos.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;scran&#39;</span>)</span>
<span id="cb20-3"><a href="normalización-de-datos.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-clustering</span></span>
<span id="cb20-4"><a href="normalización-de-datos.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb20-5"><a href="normalización-de-datos.html#cb20-5" aria-hidden="true" tabindex="-1"></a>clust.zeisel <span class="ot">&lt;-</span> <span class="fu">quickCluster</span>(sce.zeisel)</span>
<span id="cb20-6"><a href="normalización-de-datos.html#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="normalización-de-datos.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula factores de tamaño para la decircunvolución (deconvolution)</span></span>
<span id="cb20-8"><a href="normalización-de-datos.html#cb20-8" aria-hidden="true" tabindex="-1"></a>deconv.sf.zeisel <span class="ot">&lt;-</span></span>
<span id="cb20-9"><a href="normalización-de-datos.html#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calculateSumFactors</span>(sce.zeisel, <span class="at">clusters =</span> clust.zeisel, <span class="at">min.mean =</span> <span class="fl">0.1</span>)</span>
<span id="cb20-10"><a href="normalización-de-datos.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Examina la distribución de los factores de tamaño</span></span>
<span id="cb20-11"><a href="normalización-de-datos.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(deconv.sf.zeisel)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.1282  0.4859  0.8248  1.0000  1.3194  4.6521</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="normalización-de-datos.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log10</span>(deconv.sf.zeisel), <span class="at">xlab =</span> <span class="st">&quot;Log10[Deconvolution size factor]&quot;</span>,</span>
<span id="cb22-2"><a href="normalización-de-datos.html#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;grey80&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/all_code3-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="normalización-de-datos.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lib.sf.zeisel, </span>
<span id="cb23-2"><a href="normalización-de-datos.html#cb23-2" aria-hidden="true" tabindex="-1"></a>     deconv.sf.zeisel, </span>
<span id="cb23-3"><a href="normalización-de-datos.html#cb23-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Library size factor&quot;</span>,</span>
<span id="cb23-4"><a href="normalización-de-datos.html#cb23-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Deconvolution size factor&quot;</span>, </span>
<span id="cb23-5"><a href="normalización-de-datos.html#cb23-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">log=</span><span class="st">&#39;xy&#39;</span>, </span>
<span id="cb23-6"><a href="normalización-de-datos.html#cb23-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span></span>
<span id="cb23-7"><a href="normalización-de-datos.html#cb23-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-8"><a href="normalización-de-datos.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/all_code3-2.png" width="672" /></p>
<div id="ejercicios-deconvolution" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Ejercicios: deconvolution</h3>
<ul>
<li><p>¿Cúantos clusters rápidos obtuvimos?</p></li>
<li><p>¿Cúantas células por cluster obtuvimos?</p></li>
<li><p>¿Cúantos clusters rápidos obtendríamos si cambiamos el tamaño mínimo a 200? Usa 100 como la semilla (seed).</p></li>
<li><p>¿Cúantas líneas ves en la gráfica?</p></li>
</ul>
</div>
<div id="puntos-finales-1" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Puntos finales</h3>
<p>La normalización por decircunvolución (deconvolution) mejora los resultados para análsis posteriores de una manera más precisa que los métodos para bulk RNA-seq.</p>
<p><code>scran</code> algunas veces alcula factores negativos o ceros lo cual altera la matrix de expresión normalizada. ¡Checa los factores que calculas!</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="normalización-de-datos.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(deconv.sf.zeisel)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.1282  0.4859  0.8248  1.0000  1.3194  4.6521</code></pre>
<p>Si obtienes factores negativos intenta variar el número de clusters, checa si incrementar el número de células por cluster te dan factores positivos.</p>
</div>
</div>
<div id="transformación-logatítmica" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Transformación logatítmica</h2>
<div id="motivación-1" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Motivación</h3>
<p>¿Qué gen es más interesante?</p>
<ul>
<li><p><em>Gen X</em>: el promedio de expresión en el tipo celular A: 50 y B: 10</p></li>
<li><p><em>Gen Y</em>: el promedio de expresión en el tipo celular A: 1100 y B: 1000</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="normalización-de-datos.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">50-10</span></span></code></pre></div>
<pre><code>## [1] 40</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="normalización-de-datos.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1100-1000</span></span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="normalización-de-datos.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">50</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 1.609438</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="normalización-de-datos.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">1100</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 0.09531018</code></pre>
<p>Una vez calculados los factores de normalización con <code>computeSumFactors()</code>, podemos calular las cuentas en escala logaritmica usando <code>logNormCounts()</code>.</p>
<p>Estos valores resultantes son valores de expresión normalizados transformados en escala logarítmica.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="normalización-de-datos.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalization</span></span>
<span id="cb34-2"><a href="normalización-de-datos.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(100)</span></span>
<span id="cb34-3"><a href="normalización-de-datos.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># clust.zeisel &lt;- quickCluster(sce.zeisel) </span></span>
<span id="cb34-4"><a href="normalización-de-datos.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sce.zeisel &lt;- computeSumFactors(sce.zeisel, cluster=clust.zeisel, min.mean=0.1)</span></span>
<span id="cb34-5"><a href="normalización-de-datos.html#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="normalización-de-datos.html#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Log transformation</span></span>
<span id="cb34-7"><a href="normalización-de-datos.html#cb34-7" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> scater<span class="sc">::</span><span class="fu">logNormCounts</span>(sce.zeisel)</span>
<span id="cb34-8"><a href="normalización-de-datos.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">assayNames</span>(sce.zeisel)</span></code></pre></div>
<pre><code>## [1] &quot;counts&quot;    &quot;logcounts&quot;</code></pre>
</div>
<div id="ejercicio-transformación-logatítmica" class="section level3" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Ejercicio: Transformación logatítmica</h3>
<ul>
<li><p>¿Qué es una pseudo-cuenta?</p></li>
<li><p>¿Porqué se usa?</p></li>
<li><p>¿Qué valor de pseudo-cuenta usa <code>logNormCounts()</code>?</p></li>
<li><p>¿Qué es la opción <code>downsample=TRUE</code>?</p></li>
</ul>
</div>
</div>
<div id="otras-normalizaciones" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Otras normalizaciones</h2>
<p>Te invitamos a leer más sobre otras formas de normalizar, un lugar para empezar lo puedes encontrar en el curso del <a href="https://www.singlecellcourse.org/basic-quality-control-qc-and-exploration-of-scrna-seq-datasets.html#normalization-theory">Sanger Institute</a>.</p>
<p>Si estas interesad@ en diferencias en el contenido total de RNA en cada célula checa la normalización por <em>spike-ins</em>. La cual asume que los <em>spike-ins</em> fueron añadidos en un nivel constante en cada célula.</p>
<p>Si tienes resultados donde el <em>library size</em> está asociado a tus datos a pesar de haber normalizado checa la opción de <code>downsample=TRUE</code> dentro de la función de <code>logNormCounts()</code>.</p>
<div id="seurat" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Seurat</h3>
<p>La normalización de Seurat con <code>NormalizeData()</code> (tomado de <a href="https://github.com/satijalab/seurat/issues/3630">aquí</a>):</p>
<ol style="list-style-type: decimal">
<li><p>Dividir cada célula por el número total de moléculas medidas en la célula. - ¿Será <em>library size</em>?</p></li>
<li><p>Multiplicar ese número por un <em>scaling factor</em> (e.j. 10000)</p></li>
<li><p>Sumar 1 y tomar el logaritmo natural.</p></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="normalización-de-datos.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;Seurat&#39;</span>)</span>
<span id="cb36-2"><a href="normalización-de-datos.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Seurat obj</span></span>
<span id="cb36-3"><a href="normalización-de-datos.html#cb36-3" aria-hidden="true" tabindex="-1"></a>sce <span class="ot">&lt;-</span> sce.zeisel</span>
<span id="cb36-4"><a href="normalización-de-datos.html#cb36-4" aria-hidden="true" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">removeAltExps</span>(sce)</span>
<span id="cb36-5"><a href="normalización-de-datos.html#cb36-5" aria-hidden="true" tabindex="-1"></a>seurat.zeisel <span class="ot">&lt;-</span> <span class="fu">as.Seurat</span>(sce,<span class="at">counts =</span> <span class="st">&quot;counts&quot;</span>, <span class="at">data =</span> <span class="cn">NULL</span>)</span>
<span id="cb36-6"><a href="normalización-de-datos.html#cb36-6" aria-hidden="true" tabindex="-1"></a>seurat.zeisel</span></code></pre></div>
<pre><code>## An object of class Seurat 
## 18441 features across 2815 samples within 1 assay 
## Active assay: originalexp (18441 features, 0 variable features)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="normalización-de-datos.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize using Seurat function</span></span>
<span id="cb38-2"><a href="normalización-de-datos.html#cb38-2" aria-hidden="true" tabindex="-1"></a>seurat.zeisel <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(seurat.zeisel,<span class="at">normalization.method =</span> <span class="st">&quot;LogNormalize&quot;</span>)</span>
<span id="cb38-3"><a href="normalización-de-datos.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare Total counts per cell after normalization</span></span>
<span id="cb38-4"><a href="normalización-de-datos.html#cb38-4" aria-hidden="true" tabindex="-1"></a>ls.seurat <span class="ot">&lt;-</span> <span class="fu">colSums</span>(seurat.zeisel[[<span class="st">&quot;originalexp&quot;</span>]]<span class="sc">@</span>data)</span>
<span id="cb38-5"><a href="normalización-de-datos.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ls.seurat)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1460    2942    3693    3534    4097    4778</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="normalización-de-datos.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ls.seurat)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="normalización-de-datos.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trying to replicate it</span></span>
<span id="cb41-2"><a href="normalización-de-datos.html#cb41-2" aria-hidden="true" tabindex="-1"></a>ls.zeisel <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">counts</span>(sce.zeisel))</span>
<span id="cb41-3"><a href="normalización-de-datos.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ls.zeisel)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    2623    8497   12964   14955   19080   60792</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="normalización-de-datos.html#cb43-1" aria-hidden="true" tabindex="-1"></a>step1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">counts</span>(sce.zeisel))<span class="sc">/</span>ls.zeisel <span class="co"># matrix(2,2,2,2) /c(1,2)</span></span>
<span id="cb43-2"><a href="normalización-de-datos.html#cb43-2" aria-hidden="true" tabindex="-1"></a>step2 <span class="ot">&lt;-</span> step1 <span class="sc">*</span> <span class="dv">10000</span></span>
<span id="cb43-3"><a href="normalización-de-datos.html#cb43-3" aria-hidden="true" tabindex="-1"></a>step3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">log1p</span>(step2))</span>
<span id="cb43-4"><a href="normalización-de-datos.html#cb43-4" aria-hidden="true" tabindex="-1"></a>ls.steps <span class="ot">&lt;-</span> <span class="fu">colSums</span>(step3)</span>
<span id="cb43-5"><a href="normalización-de-datos.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ls.steps)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1460    2942    3693    3534    4097    4778</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="normalización-de-datos.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ls.seurat,ls.steps)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="normalización-de-datos.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with deconv normalization</span></span>
<span id="cb46-2"><a href="normalización-de-datos.html#cb46-2" aria-hidden="true" tabindex="-1"></a>ls.log <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">logcounts</span>(sce.zeisel))</span>
<span id="cb46-3"><a href="normalización-de-datos.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ls.seurat, ls.log)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
<p>Nota: <a href="https://scanpy-tutorials.readthedocs.io/en/latest/pbmc3k.html">scanpy</a> ocupa un factor de normalización igual que Seurat.</p>
</div>
</div>
<div id="notas-finales" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Notas finales</h2>
<div id="ejercicio-conceptos-básicos-1" class="section level3" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Ejercicio: Conceptos básicos</h3>
<ul>
<li>Da ejemplos de sesgos técnicos (TIP: ¿Qué es RPKM?).</li>
</ul>
<p>“Technical biases tend to affect genes in a similar manner, or at least in a manner related to their biophysical properties (e.g., length, GC content)” - <a href="https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html">hbctraining</a></p>
<p>Algunos ejemplos de los sesgos técnicos que se contemplan son <strong>la profundidad de secuenciación</strong> y <strong>la longitud del gen</strong>.</p>
<ul>
<li>Profundidad de secuenciación: Es necesario contemplarlo para comparar entre muestras, en este caso células.</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-7"></span>
<img src="https://hbctraining.github.io/DGE_workshop/img/normalization_methods_depth.png" alt="Figura tomada de [2]"  />
<p class="caption">
Figure 6.3: Figura tomada de [2]
</p>
</div>
<ul>
<li>Longitud del gen: Es necesario contemplarlo para comparar entre genes.</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="https://hbctraining.github.io/DGE_workshop/img/normalization_methods_length.png" alt="Figura tomada de [2]"  />
<p class="caption">
Figure 6.4: Figura tomada de [2]
</p>
</div>
<ul>
<li>¿Qué es correción por lote (<em>batch effect correction</em>)? Da un ejemplo.</li>
</ul>
<p>“Large single-cell RNA sequencing (scRNA-seq) projects usually need to generate data across multiple batches due to logistical constraints. However, the processing of different batches is often subject to uncontrollable differences, e.g., changes in operator, differences in reagent quality. This results in systematic differences in the observed expression in cells from different batches, which we refer to as “batch effects”. Batch effects are problematic as they can be major drivers of heterogeneity in the data, masking the relevant biological differences and complicating interpretation of the results" -OSCA</p>
<ul>
<li>¿Cuáles son las diferencias entre correción por lote y normalización?</li>
</ul>
<p>“Normalization occurs regardless of the batch structure and only considers technical biases, while batch correction - as the name suggests - only occurs across batches and must consider both technical biases and biological differences. Technical biases tend to affect genes in a similar manner, or at least in a manner related to their biophysical properties (e.g., length, GC content), while biological differences between batches can be highly unpredictable” -OSCA</p>
</div>
<div id="ejercicio-qc-1" class="section level3" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Ejercicio: QC</h3>
<ul>
<li>¿Cuántos genes son mitocondriales? (recuerdas <code>is.mito</code>)</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="normalización-de-datos.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(is.mito)</span></code></pre></div>
<pre><code>## [1] 34</code></pre>
<ul>
<li>¿Cuántos genes tienen: bajas cuentas de librería, bajos features, alto porcentaje de expresión de ERCC, alto porcentaje de genes MT? ¿Cuántas células descartamos? (TIP: <code>perCellQCMetrics</code> y <code>quickPerCellQC</code>)</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="normalización-de-datos.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">as.data.frame</span>(qc))</span></code></pre></div>
<pre><code>##              low_lib_size            low_n_features high_altexps_ERCC_percent   high_subsets_Mt_percent 
##                         0                         3                        66                       128 
##                   discard 
##                       190</code></pre>
<ul>
<li>Gráfica los resultados</li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="normalización-de-datos.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb51-2"><a href="normalización-de-datos.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(unfiltered) <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">colData</span>(unfiltered), stats)</span>
<span id="cb51-3"><a href="normalización-de-datos.html#cb51-3" aria-hidden="true" tabindex="-1"></a>unfiltered<span class="sc">$</span>discard <span class="ot">&lt;-</span> qc<span class="sc">$</span>discard</span>
<span id="cb51-4"><a href="normalización-de-datos.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="normalización-de-datos.html#cb51-5" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb51-6"><a href="normalización-de-datos.html#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plotColData</span>(unfiltered, <span class="at">y=</span><span class="st">&quot;sum&quot;</span>, <span class="at">colour_by=</span><span class="st">&quot;discard&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="normalización-de-datos.html#cb51-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Cuentas Totales&quot;</span>),</span>
<span id="cb51-8"><a href="normalización-de-datos.html#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plotColData</span>(unfiltered, <span class="at">y=</span><span class="st">&quot;detected&quot;</span>, <span class="at">colour_by=</span><span class="st">&quot;discard&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="normalización-de-datos.html#cb51-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Features (genes) detectados&quot;</span>),</span>
<span id="cb51-10"><a href="normalización-de-datos.html#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plotColData</span>(unfiltered, <span class="at">y=</span><span class="st">&quot;altexps_ERCC_percent&quot;</span>,</span>
<span id="cb51-11"><a href="normalización-de-datos.html#cb51-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour_by=</span><span class="st">&quot;discard&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ERCC %&quot;</span>),</span>
<span id="cb51-12"><a href="normalización-de-datos.html#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plotColData</span>(unfiltered, <span class="at">y=</span><span class="st">&quot;subsets_Mt_percent&quot;</span>,</span>
<span id="cb51-13"><a href="normalización-de-datos.html#cb51-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour_by=</span><span class="st">&quot;discard&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Mito %&quot;</span>),</span>
<span id="cb51-14"><a href="normalización-de-datos.html#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol=</span><span class="dv">2</span></span>
<span id="cb51-15"><a href="normalización-de-datos.html#cb51-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="ejercicio-library-size-1" class="section level3" number="6.8.3">
<h3><span class="header-section-number">6.8.3</span> Ejercicio: <em>library Size</em></h3>
<ul>
<li><p>Revisa los detalles (<strong>Details</strong>) en <code>?scater::librarySizeFactors</code></p></li>
<li><p>Calcula <em>library size</em> <code>ls.zeisel</code></p></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="normalización-de-datos.html#cb52-1" aria-hidden="true" tabindex="-1"></a>ls.zeisel <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">counts</span>(sce.zeisel))</span>
<span id="cb52-2"><a href="normalización-de-datos.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ls.zeisel)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    2623    8497   12964   14955   19080   60792</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="normalización-de-datos.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log10</span>(ls.zeisel), <span class="at">xlab =</span> <span class="st">&quot;Log10[Library size]&quot;</span>, <span class="at">col =</span> <span class="st">&quot;grey80&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<ul>
<li>¿Son idénticos <code>ls.zeisel</code> y <code>lib.sf.zeisel</code>?</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="normalización-de-datos.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(lib.sf.zeisel, ls.zeisel)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<ul>
<li>¿Son proporcionales?</li>
</ul>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="normalización-de-datos.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checamos proporcionalidad </span></span>
<span id="cb57-2"><a href="normalización-de-datos.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb57-3"><a href="normalización-de-datos.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    ls.zeisel,</span>
<span id="cb57-4"><a href="normalización-de-datos.html#cb57-4" aria-hidden="true" tabindex="-1"></a>    lib.sf.zeisel,</span>
<span id="cb57-5"><a href="normalización-de-datos.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="st">&quot;xy&quot;</span>,</span>
<span id="cb57-6"><a href="normalización-de-datos.html#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Proporcionalidad&quot;</span>,</span>
<span id="cb57-7"><a href="normalización-de-datos.html#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Library size&quot;</span>,</span>
<span id="cb57-8"><a href="normalización-de-datos.html#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot; Library size factor&quot;</span></span>
<span id="cb57-9"><a href="normalización-de-datos.html#cb57-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<ul>
<li>Calcula <code>lib.sf.zeisel</code> de forma manual. TIP: Checa el <a href="https://github.com/LTLA/scuttle/blob/master/R/librarySizeFactors.R">código fuente</a></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="normalización-de-datos.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ahora asegurate que su media sea 1 (unity mean)</span></span>
<span id="cb58-2"><a href="normalización-de-datos.html#cb58-2" aria-hidden="true" tabindex="-1"></a>lib_size_factors <span class="ot">&lt;-</span> ls.zeisel<span class="sc">/</span><span class="fu">mean</span>(ls.zeisel)</span>
<span id="cb58-3"><a href="normalización-de-datos.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lib_size_factors)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.1754  0.5682  0.8669  1.0000  1.2758  4.0651</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="normalización-de-datos.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(lib_size_factors, lib.sf.zeisel)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="ejercicios-deconvolution-1" class="section level3" number="6.8.4">
<h3><span class="header-section-number">6.8.4</span> Ejercicios: deconvolution</h3>
<ul>
<li>¿Cúantos clusters rápidos obtuvimos?</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="normalización-de-datos.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(clust.zeisel)</span></code></pre></div>
<pre><code>##  [1] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; &quot;11&quot; &quot;12&quot;</code></pre>
<ul>
<li>¿Cúantas células por cluster obtuvimos?</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="normalización-de-datos.html#cb64-1" aria-hidden="true" tabindex="-1"></a>cells_cluster <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(clust.zeisel))</span>
<span id="cb64-2"><a href="normalización-de-datos.html#cb64-2" aria-hidden="true" tabindex="-1"></a>cells_cluster</span></code></pre></div>
<pre><code>## clust.zeisel
##  12   7   4   6  10   1   3  11   2   8   5   9 
## 113 123 140 224 231 243 252 259 281 300 324 325</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="normalización-de-datos.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cells_cluster)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<ul>
<li>¿Cúantos clusters rápidos obtendríamos si cambiamos el tamaño mínimo a 200? Usa 100 como la semilla (seed).</li>
</ul>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="normalización-de-datos.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb67-2"><a href="normalización-de-datos.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">table</span>(<span class="fu">quickCluster</span>(sce.zeisel, <span class="at">min.size =</span> <span class="dv">200</span>)))</span></code></pre></div>
<pre><code>## 
##   5   9   6   1   3  10   2   4   8   7 
## 224 231 236 243 252 259 281 324 325 440</code></pre>
<ul>
<li>¿Cúantas líneas ves en la gráfica?</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="normalización-de-datos.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lib.sf.zeisel, </span>
<span id="cb69-2"><a href="normalización-de-datos.html#cb69-2" aria-hidden="true" tabindex="-1"></a>     deconv.sf.zeisel, </span>
<span id="cb69-3"><a href="normalización-de-datos.html#cb69-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Library size factor&quot;</span>,</span>
<span id="cb69-4"><a href="normalización-de-datos.html#cb69-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Deconvolution size factor&quot;</span>, </span>
<span id="cb69-5"><a href="normalización-de-datos.html#cb69-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">log=</span><span class="st">&#39;xy&#39;</span>, </span>
<span id="cb69-6"><a href="normalización-de-datos.html#cb69-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb69-7"><a href="normalización-de-datos.html#cb69-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">as.integer</span>(<span class="fu">factor</span>(sce.zeisel<span class="sc">$</span>level1class))</span>
<span id="cb69-8"><a href="normalización-de-datos.html#cb69-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb69-9"><a href="normalización-de-datos.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb69-10"><a href="normalización-de-datos.html#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="sc">-</span>.<span class="dv">2</span>, <span class="at">b=</span><span class="fl">0.95</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb69-11"><a href="normalización-de-datos.html#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fl">0.08</span>, <span class="at">b=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="ejercicio-transformación-logatítmica-1" class="section level3" number="6.8.5">
<h3><span class="header-section-number">6.8.5</span> Ejercicio: Transformación logatítmica</h3>
<ul>
<li>¿Qué es una pseudo-cuenta?</li>
</ul>
<p>Un número que se agrega para poder sacar el logarítmo</p>
<ul>
<li>¿Porqué se usa?</li>
</ul>
<p>Por que <code>log(0) = -Inf</code> y produce error más adelante.</p>
<ul>
<li>¿Qué valor de pseudo-cuenta usa <code>logNormCounts()</code>?</li>
</ul>
<p><code>pseudo.count = 1</code></p>
<ul>
<li>¿Qué es la opción <code>downsample=TRUE</code>?</li>
</ul>
<p><a href="https://bioconductor.org/books/release/OSCA/normalization.html#downsampling-and-log-transforming">OSCA: Downsampling</a>. Para cuando existe un efecto en los valores que se asocia a la <em>library size</em> a pesar de haber nomalizado.</p>
<p>Funciones interesantes para después de normalizar</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="normalización-de-datos.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sce.zeisel &lt;- runPCA(sce.zeisel)</span></span>
<span id="cb70-2"><a href="normalización-de-datos.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plotPCA(sce.zeisel, colour_by = &quot;level1class&quot;)</span></span>
<span id="cb70-3"><a href="normalización-de-datos.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plotRLE(sce.zeisel, exprs_values = &quot;logcounts&quot;, colour_by = &quot;level1class&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="adicionales" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> Adicionales</h2>
<p>[1] <a href="https://www.stephaniehicks.com/2018-bioinfosummer-scrnaseq/introduction-to-single-cell-rna-seq.html">2018 BioInfoSummer Workshop</a></p>
<p>[2] <a href="https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html">HBC training</a></p>
</div>
<div id="agradecimientos" class="section level2" number="6.10">
<h2><span class="header-section-number">6.10</span> Agradecimientos</h2>
<p>Este curso está basado en el libro <a href="https://osca.bioconductor.org/"><strong>Orchestrating Single Cell Analysis with Bioconductor</strong></a> de <a href="https://www.linkedin.com/in/aaron-lun-869b5894/">Aaron Lun</a>, <a href="https://robertamezquita.github.io/">Robert Amezquita</a>, <a href="https://www.stephaniehicks.com/">Stephanie Hicks</a> y <a href="http://rglab.org">Raphael Gottardo</a>, además del <a href="https://drive.google.com/drive/folders/1cn5d-Ey7-kkMiex8-74qxvxtCQT6o72h"><strong>curso de scRNA-seq para WEHI</strong></a> creado por <a href="https://www.peterhickey.org/">Peter Hickey</a>.</p>
<p>Y en el material de la <a href="https://github.com/comunidadbioinfo/cdsb2020">comunidadbioinfo/cdsb2020</a> con el permiso de <a href="http://lcolladotor.github.io/"><strong>Leonardo Collado-Torres</strong></a>.</p>
</div>
<div id="detalles-de-la-sesión-de-r" class="section level2" number="6.11">
<h2><span class="header-section-number">6.11</span> Detalles de la sesión de R</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="normalización-de-datos.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">120</span>)</span>
<span id="cb71-2"><a href="normalización-de-datos.html#cb71-2" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.0.2 (2020-06-22)
##  os       macOS  10.16                
##  system   x86_64, darwin17.0          
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       America/Mexico_City         
##  date     2021-08-08                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
##  package                * version   date       lib source                             
##  abind                    1.4-5     2016-07-21 [1] CRAN (R 4.0.0)                     
##  AnnotationDbi          * 1.52.0    2020-10-27 [1] Bioconductor                       
##  AnnotationFilter       * 1.14.0    2020-10-27 [1] Bioconductor                       
##  AnnotationHub          * 2.22.1    2021-04-16 [1] Bioconductor                       
##  askpass                  1.1       2019-01-13 [1] CRAN (R 4.0.0)                     
##  assertthat               0.2.1     2019-03-21 [1] CRAN (R 4.0.0)                     
##  batchelor              * 1.6.3     2021-04-16 [1] Bioconductor                       
##  beachmat                 2.6.4     2020-12-20 [1] Bioconductor                       
##  beeswarm                 0.4.0     2021-06-01 [1] CRAN (R 4.0.2)                     
##  Biobase                * 2.50.0    2020-10-27 [1] Bioconductor                       
##  BiocFileCache          * 1.14.0    2020-10-27 [1] Bioconductor                       
##  BiocGenerics           * 0.36.1    2021-04-16 [1] Bioconductor                       
##  BiocManager              1.30.16   2021-06-15 [1] CRAN (R 4.0.2)                     
##  BiocNeighbors            1.8.2     2020-12-07 [1] Bioconductor                       
##  BiocParallel             1.24.1    2020-11-06 [1] Bioconductor                       
##  BiocSingular           * 1.6.0     2020-10-27 [1] Bioconductor                       
##  BiocVersion              3.12.0    2020-05-14 [1] Bioconductor                       
##  biomaRt                  2.46.3    2021-02-11 [1] Bioconductor                       
##  Biostrings               2.58.0    2020-10-27 [1] Bioconductor                       
##  bit                      4.0.4     2020-08-04 [1] CRAN (R 4.0.2)                     
##  bit64                    4.0.5     2020-08-30 [1] CRAN (R 4.0.2)                     
##  bitops                   1.0-7     2021-04-24 [1] CRAN (R 4.0.2)                     
##  blob                     1.2.2     2021-07-23 [1] CRAN (R 4.0.2)                     
##  bluster                * 1.0.0     2020-10-27 [1] Bioconductor                       
##  bookdown                 0.22      2021-04-22 [1] CRAN (R 4.0.2)                     
##  bslib                    0.2.5.1   2021-05-18 [1] CRAN (R 4.0.2)                     
##  cachem                   1.0.5     2021-05-15 [1] CRAN (R 4.0.2)                     
##  Cairo                    1.5-12.2  2020-07-07 [1] CRAN (R 4.0.2)                     
##  circlize                 0.4.13    2021-06-09 [1] CRAN (R 4.0.2)                     
##  cli                      3.0.1     2021-07-17 [1] CRAN (R 4.0.2)                     
##  clue                     0.3-59    2021-04-16 [1] CRAN (R 4.0.2)                     
##  cluster                  2.1.2     2021-04-17 [1] CRAN (R 4.0.2)                     
##  codetools                0.2-18    2020-11-04 [1] CRAN (R 4.0.2)                     
##  colorspace               2.0-2     2021-06-24 [1] CRAN (R 4.0.2)                     
##  colourpicker             1.1.0     2020-09-14 [1] CRAN (R 4.0.2)                     
##  ComplexHeatmap           2.6.2     2020-11-12 [1] Bioconductor                       
##  cowplot                * 1.1.1     2020-12-30 [1] CRAN (R 4.0.2)                     
##  crayon                   1.4.1     2021-02-08 [1] CRAN (R 4.0.2)                     
##  curl                     4.3.2     2021-06-23 [1] CRAN (R 4.0.2)                     
##  data.table               1.14.0    2021-02-21 [1] CRAN (R 4.0.2)                     
##  DBI                      1.1.1     2021-01-15 [1] CRAN (R 4.0.2)                     
##  dbplyr                 * 2.1.1     2021-04-06 [1] CRAN (R 4.0.2)                     
##  DelayedArray           * 0.16.3    2021-03-24 [1] Bioconductor                       
##  DelayedMatrixStats       1.12.3    2021-02-03 [1] Bioconductor                       
##  deldir                   0.2-10    2021-02-16 [1] CRAN (R 4.0.2)                     
##  DEoptimR                 1.0-9     2021-05-24 [1] CRAN (R 4.0.2)                     
##  digest                   0.6.27    2020-10-24 [1] CRAN (R 4.0.2)                     
##  dplyr                    1.0.7     2021-06-18 [1] CRAN (R 4.0.2)                     
##  dqrng                    0.3.0     2021-05-01 [1] CRAN (R 4.0.2)                     
##  DropletUtils           * 1.10.3    2021-02-02 [1] Bioconductor                       
##  DT                       0.18      2021-04-14 [1] CRAN (R 4.0.2)                     
##  edgeR                    3.32.1    2021-01-14 [1] Bioconductor                       
##  ellipsis                 0.3.2     2021-04-29 [1] CRAN (R 4.0.2)                     
##  EnsDb.Hsapiens.v86     * 2.99.0    2020-08-03 [1] Bioconductor                       
##  ensembldb              * 2.14.1    2021-04-19 [1] Bioconductor                       
##  evaluate                 0.14      2019-05-28 [1] CRAN (R 4.0.0)                     
##  ExperimentHub          * 1.16.1    2021-04-16 [1] Bioconductor                       
##  fansi                    0.5.0     2021-05-25 [1] CRAN (R 4.0.2)                     
##  farver                   2.1.0     2021-02-28 [1] CRAN (R 4.0.2)                     
##  fastmap                  1.1.0     2021-01-25 [1] CRAN (R 4.0.2)                     
##  fitdistrplus             1.1-5     2021-05-28 [1] CRAN (R 4.0.2)                     
##  foreign                * 0.8-81    2020-12-22 [1] CRAN (R 4.0.2)                     
##  fossil                 * 0.4.0     2020-03-23 [1] CRAN (R 4.0.2)                     
##  fs                       1.5.0     2020-07-31 [1] CRAN (R 4.0.2)                     
##  future                   1.21.0    2020-12-10 [1] CRAN (R 4.0.2)                     
##  future.apply             1.7.0     2021-01-04 [1] CRAN (R 4.0.2)                     
##  generics                 0.1.0     2020-10-31 [1] CRAN (R 4.0.2)                     
##  GenomeInfoDb           * 1.26.7    2021-04-08 [1] Bioconductor                       
##  GenomeInfoDbData         1.2.4     2021-03-04 [1] Bioconductor                       
##  GenomicAlignments        1.26.0    2020-10-27 [1] Bioconductor                       
##  GenomicFeatures        * 1.42.3    2021-04-04 [1] Bioconductor                       
##  GenomicRanges          * 1.42.0    2020-10-27 [1] Bioconductor                       
##  GetoptLong               1.0.5     2020-12-15 [1] CRAN (R 4.0.2)                     
##  GGally                   2.1.2     2021-06-21 [1] CRAN (R 4.0.2)                     
##  ggbeeswarm               0.6.0     2017-08-07 [1] CRAN (R 4.0.2)                     
##  ggplot2                * 3.3.5     2021-06-25 [1] CRAN (R 4.0.2)                     
##  ggrepel                * 0.9.1     2021-01-15 [1] CRAN (R 4.0.2)                     
##  ggridges                 0.5.3     2021-01-08 [1] CRAN (R 4.0.2)                     
##  GlobalOptions            0.1.2     2020-06-10 [1] CRAN (R 4.0.0)                     
##  globals                  0.14.0    2020-11-22 [1] CRAN (R 4.0.2)                     
##  glue                     1.4.2     2020-08-27 [1] CRAN (R 4.0.2)                     
##  goftest                  1.2-2     2019-12-02 [1] CRAN (R 4.0.2)                     
##  gridExtra                2.3       2017-09-09 [1] CRAN (R 4.0.0)                     
##  gtable                   0.3.0     2019-03-25 [1] CRAN (R 4.0.0)                     
##  HDF5Array              * 1.18.1    2021-02-04 [1] Bioconductor                       
##  here                   * 1.0.1     2020-12-13 [1] CRAN (R 4.0.2)                     
##  highr                    0.9       2021-04-16 [1] CRAN (R 4.0.2)                     
##  hms                      1.1.0     2021-05-17 [1] CRAN (R 4.0.2)                     
##  htmltools                0.5.1.1   2021-01-22 [1] CRAN (R 4.0.2)                     
##  htmlwidgets              1.5.3     2020-12-10 [1] CRAN (R 4.0.2)                     
##  httpuv                   1.6.1     2021-05-07 [1] CRAN (R 4.0.2)                     
##  httr                     1.4.2     2020-07-20 [1] CRAN (R 4.0.2)                     
##  ica                      1.0-2     2018-05-24 [1] CRAN (R 4.0.0)                     
##  igraph                   1.2.6     2020-10-06 [1] CRAN (R 4.0.2)                     
##  interactiveDisplayBase   1.28.0    2020-10-27 [1] Bioconductor                       
##  IRanges                * 2.24.1    2020-12-12 [1] Bioconductor                       
##  irlba                    2.3.3     2019-02-05 [1] CRAN (R 4.0.0)                     
##  iSEE                   * 2.2.4     2021-02-01 [1] Bioconductor                       
##  jquerylib                0.1.4     2021-04-26 [1] CRAN (R 4.0.2)                     
##  jsonlite                 1.7.2     2020-12-09 [1] CRAN (R 4.0.2)                     
##  KernSmooth               2.23-20   2021-05-03 [1] CRAN (R 4.0.2)                     
##  knitr                    1.33      2021-04-24 [1] CRAN (R 4.0.2)                     
##  labeling                 0.4.2     2020-10-20 [1] CRAN (R 4.0.2)                     
##  later                    1.2.0     2021-04-23 [1] CRAN (R 4.0.2)                     
##  lattice                  0.20-44   2021-05-02 [1] CRAN (R 4.0.2)                     
##  lazyeval                 0.2.2     2019-03-15 [1] CRAN (R 4.0.0)                     
##  leiden                   0.3.9     2021-07-27 [1] CRAN (R 4.0.2)                     
##  lifecycle                1.0.0     2021-02-15 [1] CRAN (R 4.0.2)                     
##  limma                    3.46.0    2020-10-27 [1] Bioconductor                       
##  listenv                  0.8.0     2019-12-05 [1] CRAN (R 4.0.0)                     
##  lmtest                   0.9-38    2020-09-09 [1] CRAN (R 4.0.2)                     
##  locfit                   1.5-9.4   2020-03-25 [1] CRAN (R 4.0.0)                     
##  magrittr                 2.0.1     2020-11-17 [1] CRAN (R 4.0.2)                     
##  maps                   * 3.3.0     2018-04-03 [1] CRAN (R 4.0.0)                     
##  MASS                     7.3-54    2021-05-03 [1] CRAN (R 4.0.2)                     
##  Matrix                 * 1.3-4     2021-06-01 [1] CRAN (R 4.0.2)                     
##  MatrixGenerics         * 1.2.1     2021-01-30 [1] Bioconductor                       
##  matrixStats            * 0.60.0    2021-07-26 [1] CRAN (R 4.0.2)                     
##  mclust                   5.4.7     2020-11-20 [1] CRAN (R 4.0.2)                     
##  memoise                  2.0.0     2021-01-26 [1] CRAN (R 4.0.2)                     
##  mgcv                     1.8-36    2021-06-01 [1] CRAN (R 4.0.2)                     
##  mime                     0.11      2021-06-23 [1] CRAN (R 4.0.2)                     
##  miniUI                   0.1.1.1   2018-05-18 [1] CRAN (R 4.0.0)                     
##  munsell                  0.5.0     2018-06-12 [1] CRAN (R 4.0.0)                     
##  nlme                     3.1-152   2021-02-04 [1] CRAN (R 4.0.2)                     
##  openssl                  1.4.4     2021-04-30 [1] CRAN (R 4.0.2)                     
##  org.Hs.eg.db             3.12.0    2021-03-08 [1] Bioconductor                       
##  org.Mm.eg.db           * 3.12.0    2021-03-08 [1] Bioconductor                       
##  parallelly               1.27.0    2021-07-19 [1] CRAN (R 4.0.2)                     
##  patchwork                1.1.1     2020-12-17 [1] CRAN (R 4.0.2)                     
##  pbapply                  1.4-3     2020-08-18 [1] CRAN (R 4.0.2)                     
##  PCAtools               * 2.2.0     2020-10-27 [1] Bioconductor                       
##  pheatmap               * 1.0.12    2019-01-04 [1] CRAN (R 4.0.2)                     
##  pillar                   1.6.2     2021-07-29 [1] CRAN (R 4.0.2)                     
##  pkgconfig                2.0.3     2019-09-22 [1] CRAN (R 4.0.0)                     
##  plotly                 * 4.9.4.1   2021-06-18 [1] CRAN (R 4.0.2)                     
##  plyr                     1.8.6     2020-03-03 [1] CRAN (R 4.0.2)                     
##  png                      0.1-7     2013-12-03 [1] CRAN (R 4.0.0)                     
##  polyclip                 1.10-0    2019-03-14 [1] CRAN (R 4.0.2)                     
##  prettyunits              1.1.1     2020-01-24 [1] CRAN (R 4.0.0)                     
##  progress                 1.2.2     2019-05-16 [1] CRAN (R 4.0.0)                     
##  promises                 1.2.0.1   2021-02-11 [1] CRAN (R 4.0.2)                     
##  ProtGenerics             1.22.0    2020-10-27 [1] Bioconductor                       
##  pryr                   * 0.1.5     2021-07-26 [1] CRAN (R 4.0.2)                     
##  purrr                    0.3.4     2020-04-17 [1] CRAN (R 4.0.0)                     
##  R.methodsS3              1.8.1     2020-08-26 [1] CRAN (R 4.0.2)                     
##  R.oo                     1.24.0    2020-08-26 [1] CRAN (R 4.0.2)                     
##  R.utils                  2.10.1    2020-08-26 [1] CRAN (R 4.0.2)                     
##  R6                       2.5.0     2020-10-28 [1] CRAN (R 4.0.2)                     
##  RANN                     2.6.1     2019-01-08 [1] CRAN (R 4.0.0)                     
##  rappdirs                 0.3.3     2021-01-31 [1] CRAN (R 4.0.2)                     
##  RColorBrewer           * 1.1-2     2014-12-07 [1] CRAN (R 4.0.2)                     
##  Rcpp                     1.0.7     2021-07-07 [1] CRAN (R 4.0.2)                     
##  RcppAnnoy                0.0.19    2021-07-30 [1] CRAN (R 4.0.2)                     
##  RCurl                    1.98-1.3  2021-03-16 [1] CRAN (R 4.0.2)                     
##  remotes                  2.4.0     2021-06-02 [1] CRAN (R 4.0.2)                     
##  reshape                  0.8.8     2018-10-23 [1] CRAN (R 4.0.0)                     
##  reshape2                 1.4.4     2020-04-09 [1] CRAN (R 4.0.0)                     
##  ResidualMatrix           1.0.0     2020-10-27 [1] Bioconductor                       
##  reticulate               1.20-9001 2021-07-15 [1] Github (rstudio/reticulate@477f2c0)
##  rhdf5                  * 2.34.0    2020-10-27 [1] Bioconductor                       
##  rhdf5filters             1.2.1     2021-05-03 [1] Bioconductor                       
##  Rhdf5lib                 1.12.1    2021-01-26 [1] Bioconductor                       
##  Rhtslib                  1.22.0    2020-10-27 [1] Bioconductor                       
##  rintrojs                 0.3.0     2021-06-06 [1] CRAN (R 4.0.2)                     
##  rjson                    0.2.20    2018-06-08 [1] CRAN (R 4.0.0)                     
##  rlang                    0.4.11    2021-04-30 [1] CRAN (R 4.0.2)                     
##  rmarkdown                2.9       2021-06-15 [1] CRAN (R 4.0.2)                     
##  robustbase               0.93-8    2021-06-02 [1] CRAN (R 4.0.2)                     
##  ROCR                     1.0-11    2020-05-02 [1] CRAN (R 4.0.0)                     
##  rpart                    4.1-15    2019-04-12 [1] CRAN (R 4.0.2)                     
##  rprojroot                2.0.2     2020-11-15 [1] CRAN (R 4.0.2)                     
##  Rsamtools                2.6.0     2020-10-27 [1] Bioconductor                       
##  RSQLite                  2.2.7     2021-04-22 [1] CRAN (R 4.0.2)                     
##  rstudioapi               0.13      2020-11-12 [1] CRAN (R 4.0.2)                     
##  rsvd                     1.0.5     2021-04-16 [1] CRAN (R 4.0.2)                     
##  rtracklayer              1.50.0    2020-10-27 [1] Bioconductor                       
##  Rtsne                  * 0.15      2018-11-10 [1] CRAN (R 4.0.2)                     
##  S4Vectors              * 0.28.1    2020-12-09 [1] Bioconductor                       
##  sass                     0.4.0     2021-05-12 [1] CRAN (R 4.0.2)                     
##  scales                   1.1.1     2020-05-11 [1] CRAN (R 4.0.0)                     
##  scater                 * 1.18.6    2021-02-26 [1] Bioconductor                       
##  scattermore              0.7       2020-11-24 [1] CRAN (R 4.0.2)                     
##  scPipe                 * 1.12.0    2020-10-27 [1] Bioconductor                       
##  scran                  * 1.18.7    2021-04-16 [1] Bioconductor                       
##  scRNAseq               * 2.4.0     2020-11-09 [1] Bioconductor                       
##  sctransform              0.3.2     2020-12-16 [1] CRAN (R 4.0.2)                     
##  scuttle                  1.0.4     2020-12-17 [1] Bioconductor                       
##  sessioninfo            * 1.1.1     2018-11-05 [1] CRAN (R 4.0.2)                     
##  Seurat                 * 4.0.3     2021-06-10 [1] CRAN (R 4.0.2)                     
##  SeuratObject           * 4.0.2     2021-06-09 [1] CRAN (R 4.0.2)                     
##  shape                    1.4.6     2021-05-19 [1] CRAN (R 4.0.2)                     
##  shapefiles             * 0.7       2013-01-26 [1] CRAN (R 4.0.2)                     
##  shiny                    1.6.0     2021-01-25 [1] CRAN (R 4.0.2)                     
##  shinyAce                 0.4.1     2019-09-24 [1] CRAN (R 4.0.2)                     
##  shinydashboard           0.7.1     2018-10-17 [1] CRAN (R 4.0.2)                     
##  shinyjs                  2.0.0     2020-09-09 [1] CRAN (R 4.0.2)                     
##  shinyWidgets             0.6.0     2021-03-15 [1] CRAN (R 4.0.2)                     
##  SingleCellExperiment   * 1.12.0    2020-10-27 [1] Bioconductor                       
##  sp                     * 1.4-5     2021-01-10 [1] CRAN (R 4.0.2)                     
##  sparseMatrixStats        1.2.1     2021-02-02 [1] Bioconductor                       
##  spatstat.core            2.3-0     2021-07-16 [1] CRAN (R 4.0.2)                     
##  spatstat.data            2.1-0     2021-03-21 [1] CRAN (R 4.0.2)                     
##  spatstat.geom            2.2-2     2021-07-12 [1] CRAN (R 4.0.2)                     
##  spatstat.sparse          2.0-0     2021-03-16 [1] CRAN (R 4.0.2)                     
##  spatstat.utils           2.2-0     2021-06-14 [1] CRAN (R 4.0.2)                     
##  statmod                  1.4.36    2021-05-10 [1] CRAN (R 4.0.2)                     
##  stringi                  1.7.3     2021-07-16 [1] CRAN (R 4.0.2)                     
##  stringr                  1.4.0     2019-02-10 [1] CRAN (R 4.0.0)                     
##  SummarizedExperiment   * 1.20.0    2020-10-27 [1] Bioconductor                       
##  survival                 3.2-11    2021-04-26 [1] CRAN (R 4.0.2)                     
##  tensor                   1.5       2012-05-05 [1] CRAN (R 4.0.2)                     
##  TENxPBMCData           * 1.8.0     2020-10-29 [1] Bioconductor                       
##  tibble                   3.1.3     2021-07-23 [1] CRAN (R 4.0.2)                     
##  tidyr                    1.1.3     2021-03-03 [1] CRAN (R 4.0.2)                     
##  tidyselect               1.1.1     2021-04-30 [1] CRAN (R 4.0.2)                     
##  usethis                * 2.0.1     2021-02-10 [1] CRAN (R 4.0.2)                     
##  utf8                     1.2.2     2021-07-24 [1] CRAN (R 4.0.2)                     
##  uwot                   * 0.1.10    2020-12-15 [1] CRAN (R 4.0.2)                     
##  vctrs                    0.3.8     2021-04-29 [1] CRAN (R 4.0.2)                     
##  vipor                    0.4.5     2017-03-22 [1] CRAN (R 4.0.2)                     
##  viridis                  0.6.1     2021-05-11 [1] CRAN (R 4.0.2)                     
##  viridisLite              0.4.0     2021-04-13 [1] CRAN (R 4.0.2)                     
##  withr                    2.4.2     2021-04-18 [1] CRAN (R 4.0.2)                     
##  xfun                     0.24      2021-06-15 [1] CRAN (R 4.0.2)                     
##  XML                      3.99-0.6  2021-03-16 [1] CRAN (R 4.0.2)                     
##  xml2                     1.3.2     2020-04-23 [1] CRAN (R 4.0.0)                     
##  xtable                   1.8-4     2019-04-21 [1] CRAN (R 4.0.0)                     
##  XVector                  0.30.0    2020-10-28 [1] Bioconductor                       
##  yaml                     2.2.1     2020-02-01 [1] CRAN (R 4.0.0)                     
##  zlibbioc                 1.36.0    2020-10-28 [1] Bioconductor                       
##  zoo                      1.8-9     2021-03-09 [1] CRAN (R 4.0.2)                     
## 
## [1] /Library/Frameworks/R.framework/Versions/4.0/Resources/library</code></pre>
</div>
<div id="patrocinadores-6" class="section level2 unnumbered">
<h2>Patrocinadores</h2>
<p>Agradecemos a nuestros patrocinadores:</p>
<p><a href="https://comunidadbioinfo.github.io/es/post/cs_and_s_event_fund_award/#.YJH-wbVKj8A"><img src="https://comunidadbioinfo.github.io/post/2021-01-27-cs_and_s_event_fund_award/spanish_cs_and_s_award.jpeg" width="400px" align="center"/></a></p>
<p><a href="https://www.r-consortium.org/"><img src="https://www.r-consortium.org/wp-content/uploads/sites/13/2016/09/RConsortium_Horizontal_Pantone.png" width="400px" align="center"/></a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="control-de-calidad.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="selección-de-genes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
