<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Reducción de dimensiones | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor</title>
  <meta name="description" content="8 Reducción de dimensiones | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Reducción de dimensiones | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="ComunidadBioInfo/cdsb2021_scRNAseq" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Reducción de dimensiones | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="icon_32.png" type="image/x-icon" />
<link rel="prev" href="selección-de-genes.html"/>
<link rel="next" href="clustering.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del taller</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formato-del-curso-en-línea"><i class="fa fa-check"></i>Formato del curso: en línea</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quién-es-nuestra-audiencia"><i class="fa fa-check"></i>¿Quién es nuestra audiencia?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formulario-de-registro"><i class="fa fa-check"></i>Formulario de registro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructores"><i class="fa fa-check"></i>Instructores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ponentes-e-instructores-invitados"><i class="fa fa-check"></i>Ponentes e instructores invitados</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ayudantes"><i class="fa fa-check"></i>Ayudantes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#código-de-conducta"><i class="fa fa-check"></i>Código de Conducta</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisitos"><i class="fa fa-check"></i>Pre-requisitos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#horario"><i class="fa fa-check"></i>Horario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#materiales"><i class="fa fa-check"></i>Materiales</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#zoom"><i class="fa fa-check"></i>Zoom</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organizadores"><i class="fa fa-check"></i>Organizadores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#patrocinadores"><i class="fa fa-check"></i>Patrocinadores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#información-sesión-de-r"><i class="fa fa-check"></i>Información sesión de R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licencia"><i class="fa fa-check"></i>Licencia</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introducción a R y RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#patrocinadores-1"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html"><i class="fa fa-check"></i><b>2</b> Ejercicio usando <code>usethis</code>, <code>here</code> y <code>postcards</code></a>
<ul>
<li class="chapter" data-level="" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#patrocinadores-2"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><i class="fa fa-check"></i><b>3</b> Introducción a RNA-seq de célula única (scRNA-seq) con Bioconductor y al libro de OSCA</a>
<ul>
<li class="chapter" data-level="" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#patrocinadores-3"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html"><i class="fa fa-check"></i><b>4</b> Estructura e importe de datos</a>
<ul>
<li class="chapter" data-level="" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#patrocinadores-4"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-de-calidad.html"><a href="control-de-calidad.html"><i class="fa fa-check"></i><b>5</b> Control de calidad</a>
<ul>
<li class="chapter" data-level="" data-path="control-de-calidad.html"><a href="control-de-calidad.html#patrocinadores-5"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html"><i class="fa fa-check"></i><b>6</b> Normalización de datos</a>
<ul>
<li class="chapter" data-level="" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#patrocinadores-6"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="selección-de-genes.html"><a href="selección-de-genes.html"><i class="fa fa-check"></i><b>7</b> Selección de genes</a>
<ul>
<li class="chapter" data-level="" data-path="selección-de-genes.html"><a href="selección-de-genes.html#patrocinadores-7"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html"><i class="fa fa-check"></i><b>8</b> Reducción de dimensiones</a>
<ul>
<li class="chapter" data-level="8.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#diapositivas-de-peter-hickey"><i class="fa fa-check"></i><b>8.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="8.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#motivación"><i class="fa fa-check"></i><b>8.2</b> Motivación</a></li>
<li class="chapter" data-level="8.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#reducción-de-dimensionalidad"><i class="fa fa-check"></i><b>8.3</b> Reducción de dimensionalidad</a></li>
<li class="chapter" data-level="8.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#dataset-ilustrativo-zeisel"><i class="fa fa-check"></i><b>8.4</b> Dataset ilustrativo: Zeisel</a></li>
<li class="chapter" data-level="8.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#dataset-ilustrativo-10x-pbmc4k-no-filtradas"><i class="fa fa-check"></i><b>8.5</b> Dataset ilustrativo: 10x PBMC4k no filtradas</a></li>
<li class="chapter" data-level="8.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>8.6</b> Análisis de Componentes Principales</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#pca-aplicado-a-datos-de-scrna-seq"><i class="fa fa-check"></i><b>8.6.1</b> PCA aplicado a datos de scRNA-seq</a></li>
<li class="chapter" data-level="8.6.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#suposiciones-de-pca-aplicadas-a-los-datos-de-scrna-seq"><i class="fa fa-check"></i><b>8.6.2</b> Suposiciones de PCA aplicadas a los datos de scRNA-seq</a></li>
<li class="chapter" data-level="8.6.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#eligiendo-el-número-de-pcs"><i class="fa fa-check"></i><b>8.6.3</b> Eligiendo el número de PCs</a></li>
<li class="chapter" data-level="8.6.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#juntando-todo"><i class="fa fa-check"></i><b>8.6.4</b> Juntando todo</a></li>
<li class="chapter" data-level="8.6.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#usando-el-ruido-técnico"><i class="fa fa-check"></i><b>8.6.5</b> Usando el ruido técnico</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#reducción-de-dimensionalidad-para-visualización"><i class="fa fa-check"></i><b>8.7</b> Reducción de dimensionalidad para visualización</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#motivación-1"><i class="fa fa-check"></i><b>8.7.1</b> Motivación</a></li>
<li class="chapter" data-level="8.7.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualizando-con-pca"><i class="fa fa-check"></i><b>8.7.2</b> Visualizando con PCA</a></li>
<li class="chapter" data-level="8.7.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#retos-y-resumen-de-la-visualización-con-pca"><i class="fa fa-check"></i><b>8.7.3</b> Retos y resumen de la visualización con PCA</a></li>
<li class="chapter" data-level="8.7.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualización-con-t-sne"><i class="fa fa-check"></i><b>8.7.4</b> Visualización con t-SNE</a></li>
<li class="chapter" data-level="8.7.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualización-con-umap"><i class="fa fa-check"></i><b>8.7.5</b> Visualización con UMAP</a></li>
<li class="chapter" data-level="8.7.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#interpretando-las-gráficas"><i class="fa fa-check"></i><b>8.7.6</b> Interpretando las gráficas</a></li>
<li class="chapter" data-level="8.7.7" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#resumen-y-recomendaciones"><i class="fa fa-check"></i><b>8.7.7</b> Resumen y recomendaciones</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#donde-estamos"><i class="fa fa-check"></i><b>8.8</b> Donde estamos</a></li>
<li class="chapter" data-level="" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#patrocinadores-8"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#diapositivas-de-peter-hickey-1"><i class="fa fa-check"></i><b>9.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#dataset-ilustrativo-10x-pbmc4k-no-filtrado"><i class="fa fa-check"></i><b>9.2</b> Dataset ilustrativo: 10X PBMC4k no filtrado</a></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#motivación-2"><i class="fa fa-check"></i><b>9.3</b> Motivación</a></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#por-qué-no-realizamos-el-clustering-sobre-las-coordenadas-de-t-sneumap"><i class="fa fa-check"></i><b>9.4</b> ¿Por qué no realizamos el clustering sobre las coordenadas de t-SNE/UMAP?</a></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#cuál-es-el-verdadero-clustering"><i class="fa fa-check"></i><b>9.5</b> ¿Cuál es el verdadero clustering?</a></li>
<li class="chapter" data-level="9.6" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-grafos"><i class="fa fa-check"></i><b>9.6</b> Clustering basado en grafos</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="clustering.html"><a href="clustering.html#antecedentes"><i class="fa fa-check"></i><b>9.6.1</b> Antecedentes</a></li>
<li class="chapter" data-level="9.6.2" data-path="clustering.html"><a href="clustering.html#gráfica-de-los-k-vecinos-más-cercanos-k-nearest-neighbour--knn--graph"><i class="fa fa-check"></i><b>9.6.2</b> Gráfica de los <em>k</em> vecinos más cercanos (k-nearest neighbour -KNN- graph)</a></li>
<li class="chapter" data-level="9.6.3" data-path="clustering.html"><a href="clustering.html#gráfica-de-los-vecinos-más-próximos-compartidos-snn"><i class="fa fa-check"></i><b>9.6.3</b> Gráfica de los vecinos más próximos compartidos (SNN)</a></li>
<li class="chapter" data-level="9.6.4" data-path="clustering.html"><a href="clustering.html#gráfica-snn-con-pesos-en-las-aristas"><i class="fa fa-check"></i><b>9.6.4</b> Gráfica SNN con pesos en las aristas</a></li>
<li class="chapter" data-level="9.6.5" data-path="clustering.html"><a href="clustering.html#pasando-de-una-gráfica-snn-pesada-cluster-mediante-detección-de-comunidades"><i class="fa fa-check"></i><b>9.6.5</b> Pasando de una gráfica SNN pesada cluster mediante detección de comunidades</a></li>
<li class="chapter" data-level="9.6.6" data-path="clustering.html"><a href="clustering.html#resumen-de-clustering-basado-en-grafos"><i class="fa fa-check"></i><b>9.6.6</b> Resumen de clustering basado en grafos</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="clustering.html"><a href="clustering.html#implementación"><i class="fa fa-check"></i><b>9.7</b> Implementación</a></li>
<li class="chapter" data-level="9.8" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-grafos-1"><i class="fa fa-check"></i><b>9.8</b> Clustering basado en grafos</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="clustering.html"><a href="clustering.html#detalles-adicionales-del-ejemplo-previo"><i class="fa fa-check"></i><b>9.8.1</b> Detalles adicionales del ejemplo previo</a></li>
<li class="chapter" data-level="9.8.2" data-path="clustering.html"><a href="clustering.html#eligiendo-un-valor-de-k"><i class="fa fa-check"></i><b>9.8.2</b> Eligiendo un valor de <em>k</em></a></li>
<li class="chapter" data-level="9.8.3" data-path="clustering.html"><a href="clustering.html#estilo-seurat"><i class="fa fa-check"></i><b>9.8.3</b> Estilo Seurat</a></li>
<li class="chapter" data-level="9.8.4" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-un-grafo"><i class="fa fa-check"></i><b>9.8.4</b> Clustering basado en un grafo</a></li>
<li class="chapter" data-level="9.8.5" data-path="clustering.html"><a href="clustering.html#evaluando-la-separación-de-los-clusters"><i class="fa fa-check"></i><b>9.8.5</b> Evaluando la separación de los clusters</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="clustering.html"><a href="clustering.html#otros-métodos-de-clustering"><i class="fa fa-check"></i><b>9.9</b> Otros métodos de clustering</a></li>
<li class="chapter" data-level="9.10" data-path="clustering.html"><a href="clustering.html#evaluando-estabilidad-de-los-clusters"><i class="fa fa-check"></i><b>9.10</b> Evaluando estabilidad de los clusters</a></li>
<li class="chapter" data-level="9.11" data-path="clustering.html"><a href="clustering.html#subclustering"><i class="fa fa-check"></i><b>9.11</b> Subclustering</a></li>
<li class="chapter" data-level="9.12" data-path="clustering.html"><a href="clustering.html#resumen-y-recomendaciones-1"><i class="fa fa-check"></i><b>9.12</b> Resumen y recomendaciones</a></li>
<li class="chapter" data-level="9.13" data-path="clustering.html"><a href="clustering.html#donde-estamos-1"><i class="fa fa-check"></i><b>9.13</b> Donde estamos</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#patrocinadores-9"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html"><i class="fa fa-check"></i><b>10</b> Identificación de genes marcadores</a>
<ul>
<li class="chapter" data-level="" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#patrocinadores-10"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html"><i class="fa fa-check"></i><b>11</b> Anotación de clusters de células</a>
<ul>
<li class="chapter" data-level="" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#patrocinadores-11"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html"><i class="fa fa-check"></i><b>12</b> Análisis de expresión diferencial</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#patrocinadores-12"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html"><i class="fa fa-check"></i><b>13</b> Introducción a Seurat</a>
<ul>
<li class="chapter" data-level="" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#patrocinadores-13"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reducción-de-dimensiones" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Reducción de dimensiones</h1>
<p>Instructora: <a href="https://comunidadbioinfo.github.io/es/authors/lgomez/">Laura Gómez-Romero</a></p>
<div id="diapositivas-de-peter-hickey" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Diapositivas de Peter Hickey</h2>
<p>Contenido adaptado de: <a href="https://docs.google.com/presentation/d/12CjvQ1beZVeCcMQqD6ptzd9YUHbHOksvy3lt_rvWyRs/edit">aquí</a></p>
</div>
<div id="motivación" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Motivación</h2>
<p>El siguiente paso en el análisis de scRNA-seq usualmente consiste en identificar grupos de células “similares”</p>
<p>Por ejemplo: un análisis de clustering busca identificar células con un perfil transcriptómico similar al calcular distancias entre ellas</p>
<p>Si tuviéramos un dataset con dos genes podríamos hacer una gráfica de dos dimensiones para identificar clusters de células</p>
<div>
<p style="text-align:center;">
<img src="img/cluster.gif" width="200px">
</p>
</div>
<p>Pero… tenemos decenas de miles de genes : <strong>Reducción de dimensionalidad</strong></p>
</div>
<div id="reducción-de-dimensionalidad" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Reducción de dimensionalidad</h2>
<p>Es poible porque la expresión de diferentes genes estará correlacionada si estos genes son afectados por el mismo proceso biológico.</p>
<p>Por lo tanto, no necesitamos almacenar información independiente para genes individuales. Podemos comprimir móltiples “features” (genes) en una ónica dimensión.</p>
<p><strong>Ventajas:</strong></p>
<ul>
<li>Reduce trabajo computacional en análisis posteriores</li>
<li>Reduce el ruido al “promediar” mútiples genes obteniendo una representación mós precisa de los patrones en los datos</li>
<li>Permite una graficación efectiva en dos dimensiones</li>
</ul>
</div>
<div id="dataset-ilustrativo-zeisel" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Dataset ilustrativo: Zeisel</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="reducción-de-dimensiones.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scRNAseq)</span>
<span id="cb4-2"><a href="reducción-de-dimensiones.html#cb4-2" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">ZeiselBrainData</span>(<span class="at">ensembl =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Estudio de tipos celulares en el cerebro de ratón (oligodendrocitos, microglia, neuronas, etc) procesados con el sistema STRT-seq (similar a CEL-Seq)</p>
<p>Descripción <a href="https://osca.bioconductor.org/zeisel-mouse-brain-strt-seq.html">aquí</a></p>
<p><em>Zeisel, A. et al. Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq. Science 347, 1138-1142 (2015)</em></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="reducción-de-dimensiones.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quality control</span></span>
<span id="cb5-2"><a href="reducción-de-dimensiones.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb5-3"><a href="reducción-de-dimensiones.html#cb5-3" aria-hidden="true" tabindex="-1"></a>is.mito <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowData</span>(sce.zeisel)<span class="sc">$</span>featureType <span class="sc">==</span> <span class="st">&quot;mito&quot;</span>)</span>
<span id="cb5-4"><a href="reducción-de-dimensiones.html#cb5-4" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">perCellQCMetrics</span>(sce.zeisel,</span>
<span id="cb5-5"><a href="reducción-de-dimensiones.html#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsets =</span> <span class="fu">list</span>(<span class="at">Mt =</span> is.mito)</span>
<span id="cb5-6"><a href="reducción-de-dimensiones.html#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="reducción-de-dimensiones.html#cb5-7" aria-hidden="true" tabindex="-1"></a>qc <span class="ot">&lt;-</span> <span class="fu">quickPerCellQC</span>(stats,</span>
<span id="cb5-8"><a href="reducción-de-dimensiones.html#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_subsets =</span> <span class="fu">c</span>(<span class="st">&quot;altexps_ERCC_percent&quot;</span>, <span class="st">&quot;subsets_Mt_percent&quot;</span>)</span>
<span id="cb5-9"><a href="reducción-de-dimensiones.html#cb5-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-10"><a href="reducción-de-dimensiones.html#cb5-10" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> sce.zeisel[, <span class="sc">!</span>qc<span class="sc">$</span>discard]</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="reducción-de-dimensiones.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalization</span></span>
<span id="cb6-2"><a href="reducción-de-dimensiones.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb6-3"><a href="reducción-de-dimensiones.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb6-4"><a href="reducción-de-dimensiones.html#cb6-4" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">quickCluster</span>(sce.zeisel)</span>
<span id="cb6-5"><a href="reducción-de-dimensiones.html#cb6-5" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">computeSumFactors</span>(sce.zeisel,</span>
<span id="cb6-6"><a href="reducción-de-dimensiones.html#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster =</span> clusters</span>
<span id="cb6-7"><a href="reducción-de-dimensiones.html#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="reducción-de-dimensiones.html#cb6-8" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">logNormCounts</span>(sce.zeisel)</span>
<span id="cb6-9"><a href="reducción-de-dimensiones.html#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="reducción-de-dimensiones.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># variance-modelling</span></span>
<span id="cb6-11"><a href="reducción-de-dimensiones.html#cb6-11" aria-hidden="true" tabindex="-1"></a>dec.zeisel <span class="ot">&lt;-</span> <span class="fu">modelGeneVarWithSpikes</span>(</span>
<span id="cb6-12"><a href="reducción-de-dimensiones.html#cb6-12" aria-hidden="true" tabindex="-1"></a>    sce.zeisel,</span>
<span id="cb6-13"><a href="reducción-de-dimensiones.html#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ERCC&quot;</span></span>
<span id="cb6-14"><a href="reducción-de-dimensiones.html#cb6-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="dataset-ilustrativo-10x-pbmc4k-no-filtradas" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Dataset ilustrativo: 10x PBMC4k no filtradas</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="reducción-de-dimensiones.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiocFileCache)</span>
<span id="cb7-2"><a href="reducción-de-dimensiones.html#cb7-2" aria-hidden="true" tabindex="-1"></a>bfc <span class="ot">&lt;-</span> <span class="fu">BiocFileCache</span>()</span>
<span id="cb7-3"><a href="reducción-de-dimensiones.html#cb7-3" aria-hidden="true" tabindex="-1"></a>raw.path <span class="ot">&lt;-</span> <span class="fu">bfcrpath</span>(bfc, <span class="fu">file.path</span>(</span>
<span id="cb7-4"><a href="reducción-de-dimensiones.html#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;http://cf.10xgenomics.com/samples&quot;</span>,</span>
<span id="cb7-5"><a href="reducción-de-dimensiones.html#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot;</span></span>
<span id="cb7-6"><a href="reducción-de-dimensiones.html#cb7-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-7"><a href="reducción-de-dimensiones.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">untar</span>(raw.path, <span class="at">exdir =</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;pbmc4k&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="reducción-de-dimensiones.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DropletUtils)</span>
<span id="cb8-2"><a href="reducción-de-dimensiones.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb8-3"><a href="reducción-de-dimensiones.html#cb8-3" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;</span>)</span>
<span id="cb8-4"><a href="reducción-de-dimensiones.html#cb8-4" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">read10xCounts</span>(fname, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Dataset “Células mononucleares humanas de sangre periférica” de 10X Genomics</p>
<p>Descripción <a href="https://osca.bioconductor.org/unfiltered-human-pbmcs-10x-genomics.html">aquí</a></p>
<p><em>Zheng, G. X. Y. et al. Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017)</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="reducción-de-dimensiones.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gene-annotation</span></span>
<span id="cb9-2"><a href="reducción-de-dimensiones.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb9-3"><a href="reducción-de-dimensiones.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sce.pbmc) <span class="ot">&lt;-</span> <span class="fu">uniquifyFeatureNames</span>(</span>
<span id="cb9-4"><a href="reducción-de-dimensiones.html#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowData</span>(sce.pbmc)<span class="sc">$</span>ID, <span class="fu">rowData</span>(sce.pbmc)<span class="sc">$</span>Symbol</span>
<span id="cb9-5"><a href="reducción-de-dimensiones.html#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-6"><a href="reducción-de-dimensiones.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnsDb.Hsapiens.v86)</span>
<span id="cb9-7"><a href="reducción-de-dimensiones.html#cb9-7" aria-hidden="true" tabindex="-1"></a>location <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(EnsDb.Hsapiens.v86,</span>
<span id="cb9-8"><a href="reducción-de-dimensiones.html#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">keys =</span> <span class="fu">rowData</span>(sce.pbmc)<span class="sc">$</span>ID,</span>
<span id="cb9-9"><a href="reducción-de-dimensiones.html#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">column =</span> <span class="st">&quot;SEQNAME&quot;</span>, <span class="at">keytype =</span> <span class="st">&quot;GENEID&quot;</span></span>
<span id="cb9-10"><a href="reducción-de-dimensiones.html#cb9-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-11"><a href="reducción-de-dimensiones.html#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="reducción-de-dimensiones.html#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># cell-detection</span></span>
<span id="cb9-13"><a href="reducción-de-dimensiones.html#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb9-14"><a href="reducción-de-dimensiones.html#cb9-14" aria-hidden="true" tabindex="-1"></a>e.out <span class="ot">&lt;-</span> <span class="fu">emptyDrops</span>(<span class="fu">counts</span>(sce.pbmc))</span>
<span id="cb9-15"><a href="reducción-de-dimensiones.html#cb9-15" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> sce.pbmc[, <span class="fu">which</span>(e.out<span class="sc">$</span>FDR <span class="sc">&lt;=</span> <span class="fl">0.001</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="reducción-de-dimensiones.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quality-control</span></span>
<span id="cb10-2"><a href="reducción-de-dimensiones.html#cb10-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">perCellQCMetrics</span>(sce.pbmc,</span>
<span id="cb10-3"><a href="reducción-de-dimensiones.html#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsets =</span> <span class="fu">list</span>(<span class="at">Mito =</span> <span class="fu">which</span>(location <span class="sc">==</span> <span class="st">&quot;MT&quot;</span>))</span>
<span id="cb10-4"><a href="reducción-de-dimensiones.html#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-5"><a href="reducción-de-dimensiones.html#cb10-5" aria-hidden="true" tabindex="-1"></a>high.mito <span class="ot">&lt;-</span> <span class="fu">isOutlier</span>(stats<span class="sc">$</span>subsets_Mito_percent,</span>
<span id="cb10-6"><a href="reducción-de-dimensiones.html#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;higher&quot;</span></span>
<span id="cb10-7"><a href="reducción-de-dimensiones.html#cb10-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="reducción-de-dimensiones.html#cb10-8" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> sce.pbmc[, <span class="sc">!</span>high.mito]</span>
<span id="cb10-9"><a href="reducción-de-dimensiones.html#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="reducción-de-dimensiones.html#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># normalization</span></span>
<span id="cb10-11"><a href="reducción-de-dimensiones.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb10-12"><a href="reducción-de-dimensiones.html#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb10-13"><a href="reducción-de-dimensiones.html#cb10-13" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">quickCluster</span>(sce.pbmc)</span>
<span id="cb10-14"><a href="reducción-de-dimensiones.html#cb10-14" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">computeSumFactors</span>(sce.pbmc, <span class="at">cluster =</span> clusters)</span>
<span id="cb10-15"><a href="reducción-de-dimensiones.html#cb10-15" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">logNormCounts</span>(sce.pbmc)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="reducción-de-dimensiones.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance modelling</span></span>
<span id="cb11-2"><a href="reducción-de-dimensiones.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb11-3"><a href="reducción-de-dimensiones.html#cb11-3" aria-hidden="true" tabindex="-1"></a>dec.pbmc <span class="ot">&lt;-</span> <span class="fu">modelGeneVarByPoisson</span>(sce.pbmc)</span>
<span id="cb11-4"><a href="reducción-de-dimensiones.html#cb11-4" aria-hidden="true" tabindex="-1"></a>top.pbmc <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.pbmc, <span class="at">prop =</span> <span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="análisis-de-componentes-principales" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Análisis de Componentes Principales</h2>
<p>PCA es el arma principal de la reducción de dimensionalidad</p>
<p><strong>PCA descubre las combinaciones (lineales) de “features” que capturan la cantidad más grande de variación</strong></p>
<p>In PCA, la primer combinación lineal (componente principal) se elige tal que permite capturar la mayor varianza a través de las células. El siguiente PC se elige tal que es “ortogonal” al primero y captura la cantidad más grande de la variación restante, y así sucesivamente…</p>
<div id="pca-aplicado-a-datos-de-scrna-seq" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> PCA aplicado a datos de scRNA-seq</h3>
<p>Podemos realizar reducción de dimensionalidad al aplicar PCA en la matriz de cuentas transformadas (log-counts matrix) y restringiendo los análisis posteriores a los primeros PCs <strong>(top PCs)</strong></p>
<ul>
<li>Esto puede reducir nuestro dataset de 20,000 dimensiones a, digamos, 10, sin perder demasiada información</li>
<li>La técnica de PCA tiene muchas propiedades teóricas bien estudiadas.</li>
<li>Hay varias formas rápidas de realizar PCA en datasets grandes.</li>
</ul>
</div>
<div id="suposiciones-de-pca-aplicadas-a-los-datos-de-scrna-seq" class="section level3" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Suposiciones de PCA aplicadas a los datos de scRNA-seq</h3>
<ul>
<li>Los procesos biológicos afectan múltiples genes en una manera coordinada</li>
<li>Los primeros PCs probablemente representan la estructura biológica dado que más variación puede ser capturada considerando el comportamiento correlacionado de muchos genes</li>
<li>Se espera que el ruido técnico azaroso afecte cada gen independientemente</li>
</ul>
<p><strong>Consideración: Los primeros PCs capturarán “batch effects” (efectos de lote) que afectan muchos genes en una manera coordinada</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="reducción-de-dimensiones.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb12-2"><a href="reducción-de-dimensiones.html#cb12-2" aria-hidden="true" tabindex="-1"></a>top.zeisel <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.zeisel, <span class="at">n =</span> <span class="dv">2000</span>)</span>
<span id="cb12-3"><a href="reducción-de-dimensiones.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="reducción-de-dimensiones.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb12-5"><a href="reducción-de-dimensiones.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb12-6"><a href="reducción-de-dimensiones.html#cb12-6" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(sce.zeisel,</span>
<span id="cb12-7"><a href="reducción-de-dimensiones.html#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subset_row =</span> top.zeisel</span>
<span id="cb12-8"><a href="reducción-de-dimensiones.html#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Por default, <strong>runPCA()</strong> usa un método rápido aproximado que realiza simulaciones, por lo tanto, es necesario <em>‘configurar la semilla’</em> para obtener resultados reproducibles</p>
</div>
<div id="eligiendo-el-número-de-pcs" class="section level3" number="8.6.3">
<h3><span class="header-section-number">8.6.3</span> Eligiendo el número de PCs</h3>
<p><em>Esta elección en análoga a la elección del numero de HVGs. Elegir más PCs evitará descartar señal biológica a expensas de retener más ruido</em></p>
<ul>
<li>Es común seleccionar un número de PCs “razonable” pero <strong>arbitrario</strong> (10-50), continuar con el análisis y regresar para checar la robustez de los resultados en cierto rango de valores</li>
</ul>
<p>Ahora exploraremos algunas estrategias guiadas por los datos (data-driven) para hacer esta selección</p>
<div id="usando-el-punto-del-codo" class="section level4" number="8.6.3.1">
<h4><span class="header-section-number">8.6.3.1</span> Usando el punto del codo</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="reducción-de-dimensiones.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PCAtools)</span>
<span id="cb13-2"><a href="reducción-de-dimensiones.html#cb13-2" aria-hidden="true" tabindex="-1"></a>percent.var <span class="ot">&lt;-</span> <span class="fu">attr</span>(<span class="fu">reducedDim</span>(sce.zeisel), <span class="st">&quot;percentVar&quot;</span>)</span>
<span id="cb13-3"><a href="reducción-de-dimensiones.html#cb13-3" aria-hidden="true" tabindex="-1"></a>chosen.elbow <span class="ot">&lt;-</span> PCAtools<span class="sc">::</span><span class="fu">findElbowPoint</span>(percent.var)</span>
<span id="cb13-4"><a href="reducción-de-dimensiones.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(percent.var, <span class="at">xlab =</span> <span class="st">&quot;PC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Variance explained (%)&quot;</span>)</span>
<span id="cb13-5"><a href="reducción-de-dimensiones.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> chosen.elbow, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="480" /></p>
<p>Una heurística simple es elegir el número de PCs basado en el <strong>porcentaje de varianza explicado</strong> por PCs sucesivos</p>
</div>
<div id="basados-en-la-estructura-de-la-población" class="section level4" number="8.6.3.2">
<h4><span class="header-section-number">8.6.3.2</span> Basados en la estructura de la población</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="reducción-de-dimensiones.html#cb14-1" aria-hidden="true" tabindex="-1"></a>choices <span class="ot">&lt;-</span> <span class="fu">getClusteredPCs</span>(<span class="fu">reducedDim</span>(sce.zeisel))</span>
<span id="cb14-2"><a href="reducción-de-dimensiones.html#cb14-2" aria-hidden="true" tabindex="-1"></a>chosen.clusters <span class="ot">&lt;-</span> <span class="fu">metadata</span>(choices)<span class="sc">$</span>chosen</span></code></pre></div>
<p>Esta es una aproximación heurística más sofisticada que usa el número de clusters como un <em>proxy</em> del número de subpoblaciones</p>
<p>Supongamos que esperamos <em>d</em> subpoblaciones de células, en ese caso, necesitamos <em>d-1</em> dimensiones para garantizar la separación de todas las subpoblaciones</p>
<p>Pero… en un escenario real realmente no sabes cuántas poblaciones hay…</p>
<ul>
<li>Intenta con un rango para <em>d</em> y únicamente considera valores que produzcan a lo más <em>d+1</em> clusters</li>
<li>Cuando se seleccionan más clusters con menos dimensiones se produce ‘overclustering’</li>
<li>Elige una <em>d</em> que maximice el número de clusters sin caer en ‘overclustering’</li>
</ul>
<p><strong>Ventaja</strong>: Es una solución pragmática que soluciona el equilibrio sesgo-varianza en los análisis posteriores (especialmente clustering)</p>
<p><strong>Desventaja</strong>: Hace suposiciones fuertes sobre la naturaleza de las diferencias biológicas entre los clusters, y de hecho supone la existencia de clusters, los cuales podrían no existir en procesos biológicos como la diferenciación</p>
</div>
</div>
<div id="juntando-todo" class="section level3" number="8.6.4">
<h3><span class="header-section-number">8.6.4</span> Juntando todo</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="reducción-de-dimensiones.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb15-2"><a href="reducción-de-dimensiones.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and store the &#39;full&#39; set of PCs</span></span>
<span id="cb15-3"><a href="reducción-de-dimensiones.html#cb15-3" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(sce.zeisel, <span class="at">subset_row =</span> top.zeisel)</span>
<span id="cb15-4"><a href="reducción-de-dimensiones.html#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="reducción-de-dimensiones.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Can also select d and store the reduced set of PCs</span></span>
<span id="cb15-6"><a href="reducción-de-dimensiones.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># e.g., using the elbow point</span></span>
<span id="cb15-7"><a href="reducción-de-dimensiones.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">reducedDim</span>(sce.zeisel, <span class="st">&quot;PCA_elbow&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">reducedDim</span>(</span>
<span id="cb15-8"><a href="reducción-de-dimensiones.html#cb15-8" aria-hidden="true" tabindex="-1"></a>    sce.zeisel, <span class="st">&quot;PCA&quot;</span></span>
<span id="cb15-9"><a href="reducción-de-dimensiones.html#cb15-9" aria-hidden="true" tabindex="-1"></a>)[, <span class="dv">1</span><span class="sc">:</span>chosen.elbow]</span>
<span id="cb15-10"><a href="reducción-de-dimensiones.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># e.g., based on population structure</span></span>
<span id="cb15-11"><a href="reducción-de-dimensiones.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">reducedDim</span>(sce.zeisel, <span class="st">&quot;PCA_clusters&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">reducedDim</span>(</span>
<span id="cb15-12"><a href="reducción-de-dimensiones.html#cb15-12" aria-hidden="true" tabindex="-1"></a>    sce.zeisel, <span class="st">&quot;PCA&quot;</span></span>
<span id="cb15-13"><a href="reducción-de-dimensiones.html#cb15-13" aria-hidden="true" tabindex="-1"></a>)[, <span class="dv">1</span><span class="sc">:</span>chosen.clusters]</span></code></pre></div>
</div>
<div id="usando-el-ruido-técnico" class="section level3" number="8.6.5">
<h3><span class="header-section-number">8.6.5</span> Usando el ruido técnico</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="reducción-de-dimensiones.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb16-2"><a href="reducción-de-dimensiones.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111001001</span>)</span>
<span id="cb16-3"><a href="reducción-de-dimensiones.html#cb16-3" aria-hidden="true" tabindex="-1"></a>denoised.pbmc <span class="ot">&lt;-</span> <span class="fu">denoisePCA</span>(sce.pbmc,</span>
<span id="cb16-4"><a href="reducción-de-dimensiones.html#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">technical =</span> dec.pbmc, <span class="at">subset.row =</span> top.pbmc</span>
<span id="cb16-5"><a href="reducción-de-dimensiones.html#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Conserva todos los PCs hasta que el % de variación explicado alcance algun límite (por ejemplo, basado en la estimación de la variación técnica)</p>
<p><strong>denoisePCA()</strong> automáticamente selecciona el número de PCs</p>
<p>Por default, denoisePCA() realiza algunas simulaciones, por lo tanto necesitamos <em>‘configurar la semilla’</em> para obtener resultados reproducibles</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="reducción-de-dimensiones.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">reducedDim</span>(denoised.pbmc, <span class="st">&quot;PCA&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 3985    9</code></pre>
<p>La dimensionalidad del output es el límite inferior para el número de PCs requeridos para explicar toda la variación biológica. Lo que significa que cualquier número menor de PCs definitivamente descartaría algún aspecto de la señal biológica</p>
<p><strong>Esto no grantiza que los PCs retenidos capturen toda la señal biológica</strong></p>
<p><em>Esta técnica usualmente retiene más PCs que el método del punto del codo</em></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="reducción-de-dimensiones.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">001001001</span>)</span>
<span id="cb19-2"><a href="reducción-de-dimensiones.html#cb19-2" aria-hidden="true" tabindex="-1"></a>denoised.zeisel <span class="ot">&lt;-</span> <span class="fu">denoisePCA</span>(sce.zeisel,</span>
<span id="cb19-3"><a href="reducción-de-dimensiones.html#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">technical =</span> dec.zeisel, <span class="at">subset.row =</span> top.zeisel</span>
<span id="cb19-4"><a href="reducción-de-dimensiones.html#cb19-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-5"><a href="reducción-de-dimensiones.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">reducedDim</span>(denoised.zeisel))</span></code></pre></div>
<pre><code>## [1] 2815   50</code></pre>
<p><strong>scran::denoisePCA()</strong> internamente limita el numero de PCs, por default 5-50, para evitar la selección de excesivamente pocos PCs (cuando el ruido técnico es alto relativo al ruido biológico) o excesivamente muchos PCs (cuando el ruido técnico es demasiado bajo)</p>
<p><em>Los datos de cerebro de Zeisel están cerca de este límite superior</em></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="reducción-de-dimensiones.html#cb21-1" aria-hidden="true" tabindex="-1"></a>dec.pbmc2 <span class="ot">&lt;-</span> <span class="fu">modelGeneVar</span>(sce.pbmc)</span>
<span id="cb21-2"><a href="reducción-de-dimensiones.html#cb21-2" aria-hidden="true" tabindex="-1"></a>denoised.pbmc2 <span class="ot">&lt;-</span> <span class="fu">denoisePCA</span>(sce.pbmc,</span>
<span id="cb21-3"><a href="reducción-de-dimensiones.html#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">technical =</span> dec.pbmc2, <span class="at">subset.row =</span> top.pbmc</span>
<span id="cb21-4"><a href="reducción-de-dimensiones.html#cb21-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="reducción-de-dimensiones.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">reducedDim</span>(denoised.pbmc2))</span></code></pre></div>
<pre><code>## [1] 3985    5</code></pre>
<p><strong>scran::denoisePCA()</strong> tiende a funcionar mejor cuando la relación media-varianza refleja el ruiudo técnico verdadero, <em>i.e</em> estimado por <strong>scran::modelGeneVarByPoisson()</strong> o <strong>scran::modelGeneVarWithSpikes()</strong> en vez de <strong>scran::modelGeneVar()</strong></p>
<p><em>El dataset PBMC está cerca de este límite inferior</em></p>
</div>
</div>
<div id="reducción-de-dimensionalidad-para-visualización" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Reducción de dimensionalidad para visualización</h2>
<div id="motivación-1" class="section level3" number="8.7.1">
<h3><span class="header-section-number">8.7.1</span> Motivación</h3>
<p>Clustering y otros algoritmos operaran fácilmente sobre 10-50 (a lo más) PCs, pero ese número es aún demasiado para la visualización</p>
<p>Por lo tanto, necesitamos estrategias adicionales para la reducción de dimensionalidad si queremos visualizar los datos</p>
</div>
<div id="visualizando-con-pca" class="section level3" number="8.7.2">
<h3><span class="header-section-number">8.7.2</span> Visualizando con PCA</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="reducción-de-dimensiones.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel, <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="576" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="reducción-de-dimensiones.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel,</span>
<span id="cb24-2"><a href="reducción-de-dimensiones.html#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>,</span>
<span id="cb24-3"><a href="reducción-de-dimensiones.html#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour_by =</span> <span class="st">&quot;level1class&quot;</span></span>
<span id="cb24-4"><a href="reducción-de-dimensiones.html#cb24-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="576" /></p>
<p>PCA es una técnica lineal, por lo tanto, no es eficiente para comprimir diferencias en más de 2 dimensiones en los primeros 2 PCs</p>
</div>
<div id="retos-y-resumen-de-la-visualización-con-pca" class="section level3" number="8.7.3">
<h3><span class="header-section-number">8.7.3</span> Retos y resumen de la visualización con PCA</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="reducción-de-dimensiones.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel,</span>
<span id="cb25-2"><a href="reducción-de-dimensiones.html#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>,</span>
<span id="cb25-3"><a href="reducción-de-dimensiones.html#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncomponents =</span> <span class="dv">4</span>, <span class="at">colour_by =</span> <span class="st">&quot;level1class&quot;</span></span>
<span id="cb25-4"><a href="reducción-de-dimensiones.html#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="576" /></p>
<p><strong>Ventajas:</strong></p>
<ul>
<li>PCA es predecible y no introducirá estructura aritficial en los datos</li>
<li>Es deterministico y robusto a cambios pequeños en los valores de entrada</li>
</ul>
<p><strong>Desventajas:</strong></p>
<ul>
<li>Usualmente no es satisfactoria paara visualizar la naturaleza compleja de los datos de scRNA-seq</li>
</ul>
</div>
<div id="visualización-con-t-sne" class="section level3" number="8.7.4">
<h3><span class="header-section-number">8.7.4</span> Visualización con t-SNE</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="reducción-de-dimensiones.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">00101001101</span>)</span>
<span id="cb26-2"><a href="reducción-de-dimensiones.html#cb26-2" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">runTSNE</span>(sce.zeisel, <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>)</span>
<span id="cb26-3"><a href="reducción-de-dimensiones.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel, <span class="at">dimred =</span> <span class="st">&quot;TSNE&quot;</span>, <span class="at">colour_by =</span> <span class="st">&quot;level1class&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="480" /></p>
<p><em>t-stochastic neighbour embedding (t-SNE)</em> es la visualización por excelencia de datos de scRNA-seq. <strong>Intenta encontrar una representación (no-lineal) de los datos usando pocas dimensiones que preserve las distancias entre cada punto y sus vecinos en el espacio multi-dimensional</strong></p>
<div id="retos-de-la-visualización-con-t-sne" class="section level4" number="8.7.4.1">
<h4><span class="header-section-number">8.7.4.1</span> Retos de la visualización con t-SNE</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="reducción-de-dimensiones.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb27-2"><a href="reducción-de-dimensiones.html#cb27-2" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">runTSNE</span>(sce.zeisel,</span>
<span id="cb27-3"><a href="reducción-de-dimensiones.html#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>,</span>
<span id="cb27-4"><a href="reducción-de-dimensiones.html#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">perplexity =</span> <span class="dv">30</span></span>
<span id="cb27-5"><a href="reducción-de-dimensiones.html#cb27-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-6"><a href="reducción-de-dimensiones.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel,</span>
<span id="cb27-7"><a href="reducción-de-dimensiones.html#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;TSNE&quot;</span>,</span>
<span id="cb27-8"><a href="reducción-de-dimensiones.html#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour_by =</span> <span class="st">&quot;level1class&quot;</span></span>
<span id="cb27-9"><a href="reducción-de-dimensiones.html#cb27-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="576" /></p>
</div>
<div id="preguntas" class="section level4" number="8.7.4.2">
<h4><span class="header-section-number">8.7.4.2</span> Preguntas</h4>
<ul>
<li><p>¿Qué pasa si vuelves a correr <strong>runTSNE()</strong> sin especifica la semilla?</p></li>
<li><p>¿Qué pasa si especificas la semilla pero cambas el valor del parámetro <em>perplexity</em>?</p></li>
</ul>
</div>
<div id="continuando" class="section level4" number="8.7.4.3">
<h4><span class="header-section-number">8.7.4.3</span> Continuando</h4>
<ul>
<li>Baja perplejidad favorece la resolución de la estrucutura fina, posiblemente al grado de que la visualización parece rudio random.</li>
</ul>
<div>
<p style="text-align:center;">
<img src="img/tsne.png" width="800px">
</p>
</div>
<p>El siguiente <a href="http://distill.pub/2016/misread-tsne/">foro</a> discute la selección de parámetros para t-SNE con cierta profundidad</p>
<ul>
<li>No sobreinterpretes los resultados de t-SNE como un ‘mapa’ de las identidades de las células individuales</li>
<li>Componentes aleatorios y selección de parámetors cambiarán la visualización</li>
<li>La interpretación puede ser engañada por el tamaño y posición de los clusters</li>
<li>t-SNE infla clusters densos y comprime clusters escasos</li>
<li>t-SNE no está obligado a preservar las localizaciones relativas de clusters no-vecinos (no puedes interpretar distancias no locales)</li>
</ul>
<p><strong>Aún así: t-SNE es una herramienta probada para visualización general de datos de scRNA-seq y sigue siendo muy popular</strong></p>
</div>
</div>
<div id="visualización-con-umap" class="section level3" number="8.7.5">
<h3><span class="header-section-number">8.7.5</span> Visualización con UMAP</h3>
<p><em>Uniform manifold approximation and project (UMAP)</em> es una alternativa a t-SNE</p>
<p>Así como t-SNE, UMAP <strong>intenta encontrar una representación (no lineal) de pocas dimensiones de los datos que preserve las distancias entre cada puntos y sus vecinos en el espacio multi-dimensional</strong></p>
<p>t-SNE y UMAP están basados en diferentes teorías matemáticas</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="reducción-de-dimensiones.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1100101001</span>)</span>
<span id="cb28-2"><a href="reducción-de-dimensiones.html#cb28-2" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">runUMAP</span>(sce.zeisel, <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>)</span>
<span id="cb28-3"><a href="reducción-de-dimensiones.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel,</span>
<span id="cb28-4"><a href="reducción-de-dimensiones.html#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;UMAP&quot;</span>,</span>
<span id="cb28-5"><a href="reducción-de-dimensiones.html#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour_by =</span> <span class="st">&quot;level1class&quot;</span></span>
<span id="cb28-6"><a href="reducción-de-dimensiones.html#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="576" /></p>
<p>Comparado con t-SNE:</p>
<ul>
<li>UMAP tiende a tener clusters visualmente más compactos</li>
<li>Intenta preservar más de la estructura global que t-SNE</li>
<li>Tiende a ser más rápido que t-SNE, lo cual puede ser importante para datasets grandes. La diferencia desaprece cuando se aplican a PCs</li>
</ul>
<div id="retos-de-la-visualización-con-umap" class="section level4" number="8.7.5.1">
<h4><span class="header-section-number">8.7.5.1</span> Retos de la visualización con UMAP</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="reducción-de-dimensiones.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb29-2"><a href="reducción-de-dimensiones.html#cb29-2" aria-hidden="true" tabindex="-1"></a>sce.zeisel <span class="ot">&lt;-</span> <span class="fu">runUMAP</span>(sce.zeisel,</span>
<span id="cb29-3"><a href="reducción-de-dimensiones.html#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;PCA&quot;</span>,</span>
<span id="cb29-4"><a href="reducción-de-dimensiones.html#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_neighbors =</span> <span class="dv">15</span></span>
<span id="cb29-5"><a href="reducción-de-dimensiones.html#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="reducción-de-dimensiones.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plotReducedDim</span>(sce.zeisel,</span>
<span id="cb29-7"><a href="reducción-de-dimensiones.html#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimred =</span> <span class="st">&quot;UMAP&quot;</span>,</span>
<span id="cb29-8"><a href="reducción-de-dimensiones.html#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour_by =</span> <span class="st">&quot;level1class&quot;</span></span>
<span id="cb29-9"><a href="reducción-de-dimensiones.html#cb29-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
</div>
<div id="preguntas-1" class="section level4" number="8.7.5.2">
<h4><span class="header-section-number">8.7.5.2</span> Preguntas</h4>
<ul>
<li><p>¿Qué pasa si vuelves a correr <strong>runUMAP()</strong> sin especifica la semilla?</p></li>
<li><p>¿Qué pasa si especificas la semilla pero cambas el valor del parámetro <em>n_neighbors</em>?</p></li>
</ul>
</div>
<div id="continuando-1" class="section level4" number="8.7.5.3">
<h4><span class="header-section-number">8.7.5.3</span> Continuando</h4>
<div>
<p style="text-align:center;">
<img src="img/umap.png" width="800px">
</p>
</div>
<ul>
<li><p>Igual que para t-SNE, es necesario configurar una semilla y diferentes valores para los parámetros cambiarán la visualización</p></li>
<li><p>Si el valor para los parámetros <em>n_neighbors</em> o <em>min_dist</em> es demasiado bajo entonces el ruido aleatorio se interpretará como estructura de alta-resolución, si son demasiado altos entonces se perderá la estructura fina</p></li>
</ul>
<p><strong>TIP: Trata un rango de valores para cada parámetro para asegurarte de que no comprometen ninguna de las conclusiones derivadas de la gráfica UMAP</strong></p>
</div>
</div>
<div id="interpretando-las-gráficas" class="section level3" number="8.7.6">
<h3><span class="header-section-number">8.7.6</span> Interpretando las gráficas</h3>
<p><strong>Recuerda:</strong></p>
<ul>
<li><p>Reducción de dimensionalidad para la visualización de los datos necesariamente involucra descartar información y distorsionar las distancias entre las células</p></li>
<li><p>No sobre interpretes las gráficas bonitas</p></li>
</ul>
</div>
<div id="resumen-y-recomendaciones" class="section level3" number="8.7.7">
<h3><span class="header-section-number">8.7.7</span> Resumen y recomendaciones</h3>
<ul>
<li><p>Las gráficas de t-SNE y UMAP son herramientas diagnóstico importantes, por ejemplo: para checar si dos clusters son realmente subclusters vecinos o si un cluster puede ser dividido en más de un cluster</p></li>
<li><p>Es debatible cual visualización, t-SNE o UMAP, es más útil o estéticamente agradable.</p></li>
<li><p>Está bien elegir aquélla que funcione mejor para tu análisis (tomando en cuenta que tratarás la gráfica únicamente como una herramienta de visualización/diagnóstico y que no llegarás a ninguna conclusión fuerte basado únicamente en la gráfica )</p></li>
</ul>
</div>
</div>
<div id="donde-estamos" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Donde estamos</h2>
<div>
<p style="text-align:center;">
<img src="img/resumen.png" width="500px" heigth="400px">
</p>
</div>
</div>
<div id="patrocinadores-8" class="section level2 unnumbered">
<h2>Patrocinadores</h2>
<p>Agradecemos a nuestros patrocinadores:</p>
<p><a href="https://comunidadbioinfo.github.io/es/post/cs_and_s_event_fund_award/#.YJH-wbVKj8A"><img src="https://comunidadbioinfo.github.io/post/2021-01-27-cs_and_s_event_fund_award/spanish_cs_and_s_award.jpeg" width="400px" align="center"/></a></p>
<p><a href="https://www.r-consortium.org/"><img src="https://www.r-consortium.org/wp-content/uploads/sites/13/2016/09/RConsortium_Horizontal_Pantone.png" width="400px" align="center"/></a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="selección-de-genes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clustering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
