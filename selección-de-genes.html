<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Selección de genes | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor</title>
  <meta name="description" content="7 Selección de genes | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Selección de genes | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="ComunidadBioInfo/cdsb2021_scRNAseq" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Selección de genes | Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="icon_32.png" type="image/x-icon" />
<link rel="prev" href="normalización-de-datos.html"/>
<link rel="next" href="reducción-de-dimensiones.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del taller</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formato-del-curso-en-línea"><i class="fa fa-check"></i>Formato del curso: en línea</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#quién-es-nuestra-audiencia"><i class="fa fa-check"></i>¿Quién es nuestra audiencia?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#formulario-de-registro"><i class="fa fa-check"></i>Formulario de registro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#instructores"><i class="fa fa-check"></i>Instructores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ponentes-e-instructores-invitados"><i class="fa fa-check"></i>Ponentes e instructores invitados</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ayudantes"><i class="fa fa-check"></i>Ayudantes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#código-de-conducta"><i class="fa fa-check"></i>Código de Conducta</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requisitos"><i class="fa fa-check"></i>Pre-requisitos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#horario"><i class="fa fa-check"></i>Horario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#música-para-ejercicios"><i class="fa fa-check"></i>Música para ejercicios</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#materiales"><i class="fa fa-check"></i>Materiales</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#durante-el-curso"><i class="fa fa-check"></i>Durante el curso</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#fuentes"><i class="fa fa-check"></i>Fuentes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#zoom"><i class="fa fa-check"></i>Zoom</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organizadores"><i class="fa fa-check"></i>Organizadores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#patrocinadores"><i class="fa fa-check"></i>Patrocinadores</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#información-sesión-de-r"><i class="fa fa-check"></i>Información sesión de R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licencia"><i class="fa fa-check"></i>Licencia</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="inauguración-cdsb2021.html"><a href="inauguración-cdsb2021.html"><i class="fa fa-check"></i>Inauguración CDSB2021</a></li>
<li class="chapter" data-level="1" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introducción a R y RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#r"><i class="fa fa-check"></i><b>1.1</b> R</a></li>
<li class="chapter" data-level="1.2" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#github"><i class="fa fa-check"></i><b>1.2</b> GitHub</a></li>
<li class="chapter" data-level="1.3" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#rstudio"><i class="fa fa-check"></i><b>1.3</b> RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#material-del-curso"><i class="fa fa-check"></i><b>1.4</b> Material del curso</a></li>
<li class="chapter" data-level="1.5" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#detalles-de-la-sesión-de-r"><i class="fa fa-check"></i><b>1.5</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="introducción-a-r-y-rstudio.html"><a href="introducción-a-r-y-rstudio.html#patrocinadores-1"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html"><i class="fa fa-check"></i><b>2</b> Ejercicio usando <code>usethis</code>, <code>here</code> y <code>postcards</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#here"><i class="fa fa-check"></i><b>2.1</b> here</a></li>
<li class="chapter" data-level="2.2" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#usethis"><i class="fa fa-check"></i><b>2.2</b> usethis</a></li>
<li class="chapter" data-level="2.3" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#vinculando-rstudio-con-git-y-github"><i class="fa fa-check"></i><b>2.3</b> Vinculando RStudio con Git y GitHub</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#prerrequisitos"><i class="fa fa-check"></i><b>2.3.1</b> Prerrequisitos</a></li>
<li class="chapter" data-level="2.3.2" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#creando-token-de-acceso-personal-pat"><i class="fa fa-check"></i><b>2.3.2</b> Creando token de acceso personal (PAT)</a></li>
<li class="chapter" data-level="2.3.3" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#inicializar-repositorio-de-git-y-github"><i class="fa fa-check"></i><b>2.3.3</b> Inicializar repositorio de Git y Github</a></li>
<li class="chapter" data-level="2.3.4" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#probar-otros-comandos-de-gert"><i class="fa fa-check"></i><b>2.3.4</b> Probar otros comandos de <code>gert</code></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#ejercicio-postcards"><i class="fa fa-check"></i><b>2.4</b> Ejercicio postcards</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#crear-el-repositorio"><i class="fa fa-check"></i><b>2.4.1</b> Crear el repositorio</a></li>
<li class="chapter" data-level="2.4.2" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#modificar-y-subir-a-github-nuestro-postcard"><i class="fa fa-check"></i><b>2.4.2</b> Modificar y subir a github nuestro postcard</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#detalles-de-la-sesión-de-r-1"><i class="fa fa-check"></i><b>2.5</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="ejercicio-usando-usethis-here-y-postcards.html"><a href="ejercicio-usando-usethis-here-y-postcards.html#patrocinadores-2"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><i class="fa fa-check"></i><b>3</b> Introducción a RNA-seq de célula única (scRNA-seq) con Bioconductor y al libro de OSCA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#bioconductor"><i class="fa fa-check"></i><b>3.1</b> Bioconductor</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#equipos-y-consejos"><i class="fa fa-check"></i><b>3.1.1</b> Equipos y consejos</a></li>
<li class="chapter" data-level="3.1.2" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#encontrando-paquetes-de-bioconductor"><i class="fa fa-check"></i><b>3.1.2</b> Encontrando paquetes de Bioconductor</a></li>
<li class="chapter" data-level="3.1.3" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#estructura-de-un-paquete-de-bioc"><i class="fa fa-check"></i><b>3.1.3</b> Estructura de un paquete de BioC</a></li>
<li class="chapter" data-level="3.1.4" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#las-dos-ramas-de-bioconductor-release-y-devel"><i class="fa fa-check"></i><b>3.1.4</b> Las dos ramas de Bioconductor: release y devel</a></li>
<li class="chapter" data-level="3.1.5" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#cursos-y-eventos"><i class="fa fa-check"></i><b>3.1.5</b> Cursos y eventos</a></li>
<li class="chapter" data-level="3.1.6" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#comunidad"><i class="fa fa-check"></i><b>3.1.6</b> Comunidad</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca-1"><i class="fa fa-check"></i><b>3.2</b> Introducción a RNA-seq de célula única (scRNA-seq) con Bioconductor y al libro de OSCA</a></li>
<li class="chapter" data-level="3.3" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#detalles-de-la-sesión-de-r-2"><i class="fa fa-check"></i><b>3.3</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html"><a href="introducción-a-rna-seq-de-célula-única-scrna-seq-con-bioconductor-y-al-libro-de-osca.html#patrocinadores-3"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html"><i class="fa fa-check"></i><b>4</b> Estructura e importe de datos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#preprocesamiento-de-datos"><i class="fa fa-check"></i><b>4.1</b> Preprocesamiento de datos</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#cell-ranger"><i class="fa fa-check"></i><b>4.1.1</b> Cell Ranger</a></li>
<li class="chapter" data-level="4.1.2" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#scpipe"><i class="fa fa-check"></i><b>4.1.2</b> scPipe</a></li>
<li class="chapter" data-level="4.1.3" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#etc"><i class="fa fa-check"></i><b>4.1.3</b> Etc</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#estructura-de-singlecellexperiment"><i class="fa fa-check"></i><b>4.2</b> Estructura de <code>SingleCellExperiment</code></a></li>
<li class="chapter" data-level="4.3" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#ejercicio-1"><i class="fa fa-check"></i><b>4.3</b> Ejercicio 1</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#preguntas"><i class="fa fa-check"></i><b>4.3.1</b> Preguntas:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#breve-repaso-de-r"><i class="fa fa-check"></i><b>4.4</b> Breve repaso de R</a></li>
<li class="chapter" data-level="4.5" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#ejercicio-2"><i class="fa fa-check"></i><b>4.5</b> Ejercicio 2</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#respuestas"><i class="fa fa-check"></i><b>4.5.1</b> Respuestas</a></li>
<li class="chapter" data-level="4.5.2" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#extra"><i class="fa fa-check"></i><b>4.5.2</b> Extra</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#import-data"><i class="fa fa-check"></i><b>4.6</b> Import data</a></li>
<li class="chapter" data-level="4.7" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#detalles-de-la-sesión-de-r-3"><i class="fa fa-check"></i><b>4.7</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="estructura-e-importe-de-datos.html"><a href="estructura-e-importe-de-datos.html#patrocinadores-4"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-de-calidad.html"><a href="control-de-calidad.html"><i class="fa fa-check"></i><b>5</b> Control de calidad</a>
<ul>
<li class="chapter" data-level="5.1" data-path="control-de-calidad.html"><a href="control-de-calidad.html#diapositivas-de-peter-hickey"><i class="fa fa-check"></i><b>5.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="5.2" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-entendiendo-addpercellqc"><i class="fa fa-check"></i><b>5.2</b> Ejercicio: entendiendo addPerCellQC</a></li>
<li class="chapter" data-level="5.3" data-path="control-de-calidad.html"><a href="control-de-calidad.html#gráficas-sobre-medidas-de-control-de-calidad-qc"><i class="fa fa-check"></i><b>5.3</b> Gráficas sobre medidas de control de calidad (QC)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-gráficas-qc-ercc"><i class="fa fa-check"></i><b>5.3.1</b> Ejercicio: gráficas QC ERCC</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="control-de-calidad.html"><a href="control-de-calidad.html#eliminar-células-de-baja-calidad"><i class="fa fa-check"></i><b>5.4</b> Eliminar células de baja calidad</a></li>
<li class="chapter" data-level="5.5" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-filtrado-de-células"><i class="fa fa-check"></i><b>5.5</b> Ejercicio: filtrado de células</a></li>
<li class="chapter" data-level="5.6" data-path="control-de-calidad.html"><a href="control-de-calidad.html#datos-de-grun-et-al"><i class="fa fa-check"></i><b>5.6</b> Datos de Grun et al</a></li>
<li class="chapter" data-level="5.7" data-path="control-de-calidad.html"><a href="control-de-calidad.html#gráficas-de-qc-extra"><i class="fa fa-check"></i><b>5.7</b> Gráficas de QC extra</a></li>
<li class="chapter" data-level="5.8" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-ercc-grun-et-al"><i class="fa fa-check"></i><b>5.8</b> Ejercicio: ERCC Grun et al</a></li>
<li class="chapter" data-level="5.9" data-path="control-de-calidad.html"><a href="control-de-calidad.html#identificando-droplets-vacíos-con-datos-de-pbmc"><i class="fa fa-check"></i><b>5.9</b> Identificando droplets vacíos con datos de PBMC</a></li>
<li class="chapter" data-level="5.10" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-detección-de-droplets-vacíos"><i class="fa fa-check"></i><b>5.10</b> Ejercicio: detección de droplets vacíos</a></li>
<li class="chapter" data-level="5.11" data-path="control-de-calidad.html"><a href="control-de-calidad.html#filtrado-de-expresión-mitocondrial-adicional"><i class="fa fa-check"></i><b>5.11</b> Filtrado de expresión mitocondrial adicional</a></li>
<li class="chapter" data-level="5.12" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-avanzado"><i class="fa fa-check"></i><b>5.12</b> Ejercicio avanzado</a></li>
<li class="chapter" data-level="5.13" data-path="control-de-calidad.html"><a href="control-de-calidad.html#discusión-conviene-eliminar-datos"><i class="fa fa-check"></i><b>5.13</b> Discusión ¿Conviene eliminar datos?</a>
<ul>
<li class="chapter" data-level="5.13.1" data-path="control-de-calidad.html"><a href="control-de-calidad.html#un-nuevo-paquete-experimentsubset"><i class="fa fa-check"></i><b>5.13.1</b> Un nuevo paquete: ExperimentSubset</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="control-de-calidad.html"><a href="control-de-calidad.html#explorando-datos-de-forma-interactiva-con-isee"><i class="fa fa-check"></i><b>5.14</b> Explorando datos de forma interactiva con iSEE</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="control-de-calidad.html"><a href="control-de-calidad.html#ejercicio-isee-con-sce.416b"><i class="fa fa-check"></i><b>5.14.1</b> Ejercicio iSEE con sce.416b</a></li>
<li class="chapter" data-level="5.14.2" data-path="control-de-calidad.html"><a href="control-de-calidad.html#datos-de-libd-de-tran-et-al"><i class="fa fa-check"></i><b>5.14.2</b> Datos de LIBD de Tran et al</a></li>
<li class="chapter" data-level="5.14.3" data-path="control-de-calidad.html"><a href="control-de-calidad.html#más-detalles-de-isee"><i class="fa fa-check"></i><b>5.14.3</b> Más detalles de iSEE</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="control-de-calidad.html"><a href="control-de-calidad.html#detalles-de-la-sesión-de-r-4"><i class="fa fa-check"></i><b>5.15</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="control-de-calidad.html"><a href="control-de-calidad.html#patrocinadores-5"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html"><i class="fa fa-check"></i><b>6</b> Normalización de datos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#material"><i class="fa fa-check"></i><b>6.1</b> Material</a></li>
<li class="chapter" data-level="6.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#motivación"><i class="fa fa-check"></i><b>6.2</b> Motivación</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-conceptos-básicos"><i class="fa fa-check"></i><b>6.2.1</b> Ejercicio: Conceptos básicos</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#datos"><i class="fa fa-check"></i><b>6.3</b> Datos</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-qc"><i class="fa fa-check"></i><b>6.3.1</b> Ejercicio: QC</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#normalización-por-escalamiento-scaling-normalization"><i class="fa fa-check"></i><b>6.4</b> Normalización por escalamiento (scaling normalization)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#tamaño-de-biblioteca-library-size"><i class="fa fa-check"></i><b>6.4.1</b> Tamaño de biblioteca (<em>Library Size</em>)</a></li>
<li class="chapter" data-level="6.4.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-library-size"><i class="fa fa-check"></i><b>6.4.2</b> Ejercicio: <em>library Size</em></a></li>
<li class="chapter" data-level="6.4.3" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#puntos-finales"><i class="fa fa-check"></i><b>6.4.3</b> Puntos finales</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#normalización-por-decircunvolución-deconvolution"><i class="fa fa-check"></i><b>6.5</b> Normalización por decircunvolución (deconvolution)</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicios-deconvolution"><i class="fa fa-check"></i><b>6.5.1</b> Ejercicios: deconvolution</a></li>
<li class="chapter" data-level="6.5.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#puntos-finales-1"><i class="fa fa-check"></i><b>6.5.2</b> Puntos finales</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#transformación-logarítmica"><i class="fa fa-check"></i><b>6.6</b> Transformación logarítmica</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#motivación-1"><i class="fa fa-check"></i><b>6.6.1</b> Motivación</a></li>
<li class="chapter" data-level="6.6.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-transformación-logarítmica"><i class="fa fa-check"></i><b>6.6.2</b> Ejercicio: Transformación logarítmica</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#otras-normalizaciones"><i class="fa fa-check"></i><b>6.7</b> Otras normalizaciones</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#seurat"><i class="fa fa-check"></i><b>6.7.1</b> Seurat</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#notas-finales"><i class="fa fa-check"></i><b>6.8</b> Notas finales</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-conceptos-básicos-1"><i class="fa fa-check"></i><b>6.8.1</b> Ejercicio: Conceptos básicos</a></li>
<li class="chapter" data-level="6.8.2" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-qc-1"><i class="fa fa-check"></i><b>6.8.2</b> Ejercicio: QC</a></li>
<li class="chapter" data-level="6.8.3" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-library-size-1"><i class="fa fa-check"></i><b>6.8.3</b> Ejercicio: <em>library Size</em></a></li>
<li class="chapter" data-level="6.8.4" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicios-deconvolution-1"><i class="fa fa-check"></i><b>6.8.4</b> Ejercicios: deconvolution</a></li>
<li class="chapter" data-level="6.8.5" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#ejercicio-transformación-logarítmica-1"><i class="fa fa-check"></i><b>6.8.5</b> Ejercicio: Transformación logarítmica</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#adicionales"><i class="fa fa-check"></i><b>6.9</b> Adicionales</a></li>
<li class="chapter" data-level="6.10" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#agradecimientos"><i class="fa fa-check"></i><b>6.10</b> Agradecimientos</a></li>
<li class="chapter" data-level="6.11" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#detalles-de-la-sesión-de-r-5"><i class="fa fa-check"></i><b>6.11</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="normalización-de-datos.html"><a href="normalización-de-datos.html#patrocinadores-6"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="selección-de-genes.html"><a href="selección-de-genes.html"><i class="fa fa-check"></i><b>7</b> Selección de genes</a>
<ul>
<li class="chapter" data-level="7.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#diapositivas-de-peter-hickey-1"><i class="fa fa-check"></i><b>7.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="7.2" data-path="selección-de-genes.html"><a href="selección-de-genes.html#motivación-2"><i class="fa fa-check"></i><b>7.2</b> Motivación</a></li>
<li class="chapter" data-level="7.3" data-path="selección-de-genes.html"><a href="selección-de-genes.html#selección-de-features-genes"><i class="fa fa-check"></i><b>7.3</b> Selección de <em>features</em> (genes)</a></li>
<li class="chapter" data-level="7.4" data-path="selección-de-genes.html"><a href="selección-de-genes.html#dataset-ilustrativo-pbmc4k-10x-sin-filtrar"><i class="fa fa-check"></i><b>7.4</b> Dataset ilustrativo: PBMC4k 10X sin filtrar</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#descargar-datos"><i class="fa fa-check"></i><b>7.4.1</b> Descargar datos</a></li>
<li class="chapter" data-level="7.4.2" data-path="selección-de-genes.html"><a href="selección-de-genes.html#anotación"><i class="fa fa-check"></i><b>7.4.2</b> Anotación</a></li>
<li class="chapter" data-level="7.4.3" data-path="selección-de-genes.html"><a href="selección-de-genes.html#control-de-calidad-1"><i class="fa fa-check"></i><b>7.4.3</b> Control de calidad</a></li>
<li class="chapter" data-level="7.4.4" data-path="selección-de-genes.html"><a href="selección-de-genes.html#preguntas-de-repaso"><i class="fa fa-check"></i><b>7.4.4</b> Preguntas de repaso</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="selección-de-genes.html"><a href="selección-de-genes.html#dataset-ilustrativo-416b"><i class="fa fa-check"></i><b>7.5</b> Dataset ilustrativo: 416B</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#preguntas-de-repaso-1"><i class="fa fa-check"></i><b>7.5.1</b> Preguntas de repaso</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="selección-de-genes.html"><a href="selección-de-genes.html#cuantificando-la-varianza-por-gen"><i class="fa fa-check"></i><b>7.6</b> Cuantificando la varianza por gen</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#varianza-de-los-log-counts"><i class="fa fa-check"></i><b>7.6.1</b> Varianza de los <em>log-counts</em></a></li>
<li class="chapter" data-level="7.6.2" data-path="selección-de-genes.html"><a href="selección-de-genes.html#enfoque-simple"><i class="fa fa-check"></i><b>7.6.2</b> Enfoque simple</a></li>
<li class="chapter" data-level="7.6.3" data-path="selección-de-genes.html"><a href="selección-de-genes.html#un-enfoque-más-sofisticado"><i class="fa fa-check"></i><b>7.6.3</b> Un enfoque más sofisticado</a></li>
<li class="chapter" data-level="7.6.4" data-path="selección-de-genes.html"><a href="selección-de-genes.html#supuestos"><i class="fa fa-check"></i><b>7.6.4</b> Supuestos</a></li>
<li class="chapter" data-level="7.6.5" data-path="selección-de-genes.html"><a href="selección-de-genes.html#visualizando-la-media-y-varianza"><i class="fa fa-check"></i><b>7.6.5</b> Visualizando la media y varianza</a></li>
<li class="chapter" data-level="7.6.6" data-path="selección-de-genes.html"><a href="selección-de-genes.html#ordenando-genes-interesantes"><i class="fa fa-check"></i><b>7.6.6</b> Ordenando genes interesantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="selección-de-genes.html"><a href="selección-de-genes.html#coeficiente-de-variación-de-las-cuentas"><i class="fa fa-check"></i><b>7.7</b> Coeficiente de variación de las cuentas</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#coeficiente-de-variación"><i class="fa fa-check"></i><b>7.7.1</b> Coeficiente de variación</a></li>
<li class="chapter" data-level="7.7.2" data-path="selección-de-genes.html"><a href="selección-de-genes.html#visualizando-el-coeficiente-de-variación"><i class="fa fa-check"></i><b>7.7.2</b> Visualizando el coeficiente de variación</a></li>
<li class="chapter" data-level="7.7.3" data-path="selección-de-genes.html"><a href="selección-de-genes.html#genes-por-coeficiente-de-variación"><i class="fa fa-check"></i><b>7.7.3</b> Genes por coeficiente de variación</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="selección-de-genes.html"><a href="selección-de-genes.html#varianza-de-los-log-counts-vs-coeficiente-de-variación"><i class="fa fa-check"></i><b>7.8</b> Varianza de los <em>log-counts</em> vs coeficiente de variación</a></li>
<li class="chapter" data-level="7.9" data-path="selección-de-genes.html"><a href="selección-de-genes.html#cuantificando-el-ruido-técnico"><i class="fa fa-check"></i><b>7.9</b> Cuantificando el ruido técnico</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#en-la-presencia-de-spike-ins"><i class="fa fa-check"></i><b>7.9.1</b> En la presencia de spike-ins</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="selección-de-genes.html"><a href="selección-de-genes.html#en-la-ausencia-de-spike-ins"><i class="fa fa-check"></i><b>7.10</b> En la ausencia de spike-ins</a></li>
<li class="chapter" data-level="7.11" data-path="selección-de-genes.html"><a href="selección-de-genes.html#recordemos-propiedades-de-los-datos-de-sce.416b"><i class="fa fa-check"></i><b>7.11</b> Recordemos propiedades de los datos de sce.416b</a></li>
<li class="chapter" data-level="7.12" data-path="selección-de-genes.html"><a href="selección-de-genes.html#considerando-factores-experimentales"><i class="fa fa-check"></i><b>7.12</b> Considerando factores experimentales</a></li>
<li class="chapter" data-level="7.13" data-path="selección-de-genes.html"><a href="selección-de-genes.html#seleccionando-genes-altamante-variables-high-variable-genes-hvgs"><i class="fa fa-check"></i><b>7.13</b> Seleccionando genes altamante variables (high-variable genes, HVGs)</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#seleccionando-hvgs-sobre-la-métrica-de-varianza"><i class="fa fa-check"></i><b>7.13.1</b> Seleccionando HVGs sobre la métrica de varianza</a></li>
<li class="chapter" data-level="7.13.2" data-path="selección-de-genes.html"><a href="selección-de-genes.html#seleccionando-hvgs-de-acuerdo-a-su-significancia-estadística"><i class="fa fa-check"></i><b>7.13.2</b> Seleccionando HVGs de acuerdo a su significancia estadística</a></li>
<li class="chapter" data-level="7.13.3" data-path="selección-de-genes.html"><a href="selección-de-genes.html#seleccionando-genes-por-arriba-de-la-tendencia-media-varianza"><i class="fa fa-check"></i><b>7.13.3</b> Seleccionando genes por arriba de la tendencia media-varianza</a></li>
<li class="chapter" data-level="7.13.4" data-path="selección-de-genes.html"><a href="selección-de-genes.html#ejercicio-dibujando-los-hvgs"><i class="fa fa-check"></i><b>7.13.4</b> EJERCICIO: Dibujando los HVGs</a></li>
<li class="chapter" data-level="7.13.5" data-path="selección-de-genes.html"><a href="selección-de-genes.html#seleccionando-genes-de-interés-a-priori"><i class="fa fa-check"></i><b>7.13.5</b> Seleccionando genes de interés <em>a priori</em></a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="selección-de-genes.html"><a href="selección-de-genes.html#poniendo-todo-junto"><i class="fa fa-check"></i><b>7.14</b> Poniendo todo junto</a>
<ul>
<li class="chapter" data-level="7.14.1" data-path="selección-de-genes.html"><a href="selección-de-genes.html#quedándonos-sólo-con-los-hgvs"><i class="fa fa-check"></i><b>7.14.1</b> Quedándonos sólo con los HGVs</a></li>
<li class="chapter" data-level="7.14.2" data-path="selección-de-genes.html"><a href="selección-de-genes.html#especificando-los-hgvs"><i class="fa fa-check"></i><b>7.14.2</b> Especificando los HGVs</a></li>
<li class="chapter" data-level="7.14.3" data-path="selección-de-genes.html"><a href="selección-de-genes.html#witchcraft-brujería"><i class="fa fa-check"></i><b>7.14.3</b> Witchcraft (Brujería)</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="selección-de-genes.html"><a href="selección-de-genes.html#resumen-y-recomendaciones"><i class="fa fa-check"></i><b>7.15</b> Resumen y recomendaciones</a></li>
<li class="chapter" data-level="7.16" data-path="selección-de-genes.html"><a href="selección-de-genes.html#recomendaciones-para-empezar"><i class="fa fa-check"></i><b>7.16</b> Recomendaciones para empezar</a></li>
<li class="chapter" data-level="7.17" data-path="selección-de-genes.html"><a href="selección-de-genes.html#detalles-de-la-sesión-de-r-6"><i class="fa fa-check"></i><b>7.17</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="selección-de-genes.html"><a href="selección-de-genes.html#patrocinadores-7"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html"><i class="fa fa-check"></i><b>8</b> Reducción de dimensiones</a>
<ul>
<li class="chapter" data-level="8.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#diapositivas-de-peter-hickey-2"><i class="fa fa-check"></i><b>8.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="8.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#motivación-3"><i class="fa fa-check"></i><b>8.2</b> Motivación</a></li>
<li class="chapter" data-level="8.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#reducción-de-dimensionalidad"><i class="fa fa-check"></i><b>8.3</b> Reducción de dimensionalidad</a></li>
<li class="chapter" data-level="8.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#dataset-ilustrativo-zeisel"><i class="fa fa-check"></i><b>8.4</b> Dataset ilustrativo: Zeisel</a></li>
<li class="chapter" data-level="8.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#dataset-ilustrativo-10x-pbmc4k-no-filtradas"><i class="fa fa-check"></i><b>8.5</b> Dataset ilustrativo: 10x PBMC4k no filtradas</a></li>
<li class="chapter" data-level="8.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#análisis-de-componentes-principales"><i class="fa fa-check"></i><b>8.6</b> Análisis de Componentes Principales</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#pca-aplicado-a-datos-de-scrna-seq"><i class="fa fa-check"></i><b>8.6.1</b> PCA aplicado a datos de scRNA-seq</a></li>
<li class="chapter" data-level="8.6.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#suposiciones-de-pca-aplicadas-a-los-datos-de-scrna-seq"><i class="fa fa-check"></i><b>8.6.2</b> Suposiciones de PCA aplicadas a los datos de scRNA-seq</a></li>
<li class="chapter" data-level="8.6.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#eligiendo-el-número-de-pcs"><i class="fa fa-check"></i><b>8.6.3</b> Eligiendo el número de PCs</a></li>
<li class="chapter" data-level="8.6.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#juntando-todo"><i class="fa fa-check"></i><b>8.6.4</b> Juntando todo</a></li>
<li class="chapter" data-level="8.6.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#ejercicio"><i class="fa fa-check"></i><b>8.6.5</b> EJERCICIO</a></li>
<li class="chapter" data-level="8.6.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#usando-el-ruido-técnico"><i class="fa fa-check"></i><b>8.6.6</b> Usando el ruido técnico</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#reducción-de-dimensionalidad-para-visualización"><i class="fa fa-check"></i><b>8.7</b> Reducción de dimensionalidad para visualización</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#motivación-4"><i class="fa fa-check"></i><b>8.7.1</b> Motivación</a></li>
<li class="chapter" data-level="8.7.2" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualizando-con-pca"><i class="fa fa-check"></i><b>8.7.2</b> Visualizando con PCA</a></li>
<li class="chapter" data-level="8.7.3" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#retos-y-resumen-de-la-visualización-con-pca"><i class="fa fa-check"></i><b>8.7.3</b> Retos y resumen de la visualización con PCA</a></li>
<li class="chapter" data-level="8.7.4" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualización-con-t-sne"><i class="fa fa-check"></i><b>8.7.4</b> Visualización con t-SNE</a></li>
<li class="chapter" data-level="8.7.5" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#visualización-con-umap"><i class="fa fa-check"></i><b>8.7.5</b> Visualización con UMAP</a></li>
<li class="chapter" data-level="8.7.6" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#interpretando-las-gráficas"><i class="fa fa-check"></i><b>8.7.6</b> Interpretando las gráficas</a></li>
<li class="chapter" data-level="8.7.7" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#resumen-y-recomendaciones-1"><i class="fa fa-check"></i><b>8.7.7</b> Resumen y recomendaciones</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#donde-estamos"><i class="fa fa-check"></i><b>8.8</b> Donde estamos</a></li>
<li class="chapter" data-level="8.9" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#detalles-de-la-sesión-de-r-7"><i class="fa fa-check"></i><b>8.9</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="reducción-de-dimensiones.html"><a href="reducción-de-dimensiones.html#patrocinadores-8"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#dataset-ilustrativo-10x-pbmc4k-no-filtrado"><i class="fa fa-check"></i><b>9.1</b> Dataset ilustrativo: 10X PBMC4k no filtrado</a></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#motivación-5"><i class="fa fa-check"></i><b>9.2</b> Motivación</a></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#por-qué-no-realizamos-el-clustering-sobre-las-coordenadas-de-t-sneumap"><i class="fa fa-check"></i><b>9.3</b> ¿Por qué no realizamos el clustering sobre las coordenadas de t-SNE/UMAP?</a></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#cuál-es-el-verdadero-clustering"><i class="fa fa-check"></i><b>9.4</b> ¿Cuál es el verdadero clustering?</a></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#clustering-basado-en-grafos"><i class="fa fa-check"></i><b>9.5</b> Clustering basado en grafos</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="clustering.html"><a href="clustering.html#antecedentes"><i class="fa fa-check"></i><b>9.5.1</b> Antecedentes</a></li>
<li class="chapter" data-level="9.5.2" data-path="clustering.html"><a href="clustering.html#gráfica-de-los-k-vecinos-más-cercanos-k-nearest-neighbour--knn--graph"><i class="fa fa-check"></i><b>9.5.2</b> Gráfica de los <em>k</em> vecinos más cercanos (k-nearest neighbour -KNN- graph)</a></li>
<li class="chapter" data-level="9.5.3" data-path="clustering.html"><a href="clustering.html#gráfica-de-los-vecinos-más-próximos-compartidos-snn"><i class="fa fa-check"></i><b>9.5.3</b> Gráfica de los vecinos más próximos compartidos (SNN)</a></li>
<li class="chapter" data-level="9.5.4" data-path="clustering.html"><a href="clustering.html#gráfica-snn-con-pesos-en-las-aristas"><i class="fa fa-check"></i><b>9.5.4</b> Gráfica SNN con pesos en las aristas</a></li>
<li class="chapter" data-level="9.5.5" data-path="clustering.html"><a href="clustering.html#obteniendo-comunidades-a-partir-de-una-gráfica-snn-pesada-mediante-un-algoritmo-de-clustering"><i class="fa fa-check"></i><b>9.5.5</b> Obteniendo comunidades a partir de una gráfica SNN pesada mediante un algoritmo de clustering</a></li>
<li class="chapter" data-level="9.5.6" data-path="clustering.html"><a href="clustering.html#resumen-de-clustering-basado-en-grafos"><i class="fa fa-check"></i><b>9.5.6</b> Resumen de clustering basado en grafos</a></li>
<li class="chapter" data-level="9.5.7" data-path="clustering.html"><a href="clustering.html#detalles-a-considerar-en-la-implementación"><i class="fa fa-check"></i><b>9.5.7</b> Detalles a considerar en la implementación</a></li>
<li class="chapter" data-level="9.5.8" data-path="clustering.html"><a href="clustering.html#implementación"><i class="fa fa-check"></i><b>9.5.8</b> Implementación</a></li>
<li class="chapter" data-level="9.5.9" data-path="clustering.html"><a href="clustering.html#eligiendo-un-valor-de-k"><i class="fa fa-check"></i><b>9.5.9</b> Eligiendo un valor de <em>k</em></a></li>
<li class="chapter" data-level="9.5.10" data-path="clustering.html"><a href="clustering.html#una-implementación-diferente-estilo-seurat"><i class="fa fa-check"></i><b>9.5.10</b> Una implementación diferente: estilo Seurat</a></li>
<li class="chapter" data-level="9.5.11" data-path="clustering.html"><a href="clustering.html#detalles-de-las-implementaciones-más-comunes"><i class="fa fa-check"></i><b>9.5.11</b> Detalles de las implementaciones más comunes</a></li>
<li class="chapter" data-level="9.5.12" data-path="clustering.html"><a href="clustering.html#otras-implementaciones"><i class="fa fa-check"></i><b>9.5.12</b> Otras implementaciones</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="clustering.html"><a href="clustering.html#evaluando-la-separación-de-los-clusters"><i class="fa fa-check"></i><b>9.6</b> Evaluando la separación de los clusters</a></li>
<li class="chapter" data-level="9.7" data-path="clustering.html"><a href="clustering.html#otros-métodos-de-clustering"><i class="fa fa-check"></i><b>9.7</b> Otros métodos de clustering</a></li>
<li class="chapter" data-level="9.8" data-path="clustering.html"><a href="clustering.html#evaluando-la-estabilidad-de-los-clusters"><i class="fa fa-check"></i><b>9.8</b> Evaluando la estabilidad de los clusters</a></li>
<li class="chapter" data-level="9.9" data-path="clustering.html"><a href="clustering.html#subclustering"><i class="fa fa-check"></i><b>9.9</b> Subclustering</a></li>
<li class="chapter" data-level="9.10" data-path="clustering.html"><a href="clustering.html#resumen-y-recomendaciones-2"><i class="fa fa-check"></i><b>9.10</b> Resumen y recomendaciones</a></li>
<li class="chapter" data-level="9.11" data-path="clustering.html"><a href="clustering.html#donde-estamos-1"><i class="fa fa-check"></i><b>9.11</b> Donde estamos</a></li>
<li class="chapter" data-level="9.12" data-path="clustering.html"><a href="clustering.html#detalles-de-la-sesión-de-r-8"><i class="fa fa-check"></i><b>9.12</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="clustering.html"><a href="clustering.html#patrocinadores-9"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html"><i class="fa fa-check"></i><b>10</b> Identificación de genes marcadores</a>
<ul>
<li class="chapter" data-level="10.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#diapositivas-de-peter-hickey-3"><i class="fa fa-check"></i><b>10.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="10.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#motivación-6"><i class="fa fa-check"></i><b>10.2</b> Motivación</a></li>
<li class="chapter" data-level="10.3" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#dataset-ilustrativo-pbmc4k-10x-sin-filtrar-1"><i class="fa fa-check"></i><b>10.3</b> Dataset ilustrativo: PBMC4k 10X sin filtrar</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#descargar-datos-1"><i class="fa fa-check"></i><b>10.3.1</b> Descargar datos</a></li>
<li class="chapter" data-level="10.3.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#anotación-1"><i class="fa fa-check"></i><b>10.3.2</b> Anotación</a></li>
<li class="chapter" data-level="10.3.3" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#control-de-calidad-2"><i class="fa fa-check"></i><b>10.3.3</b> Control de calidad</a></li>
<li class="chapter" data-level="10.3.4" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#genes-variables"><i class="fa fa-check"></i><b>10.3.4</b> Genes variables</a></li>
<li class="chapter" data-level="10.3.5" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#reducción-de-dimensiones-1"><i class="fa fa-check"></i><b>10.3.5</b> Reducción de dimensiones</a></li>
<li class="chapter" data-level="10.3.6" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#clustering-1"><i class="fa fa-check"></i><b>10.3.6</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#motivación---continuación"><i class="fa fa-check"></i><b>10.4</b> Motivación - continuación</a></li>
<li class="chapter" data-level="10.5" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#prueba-t-modificada-de-welch-pareada"><i class="fa fa-check"></i><b>10.5</b> Prueba t modificada de Welch pareada</a></li>
<li class="chapter" data-level="10.6" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#ejemplo-ilustrativo-cd3e-como-gen-marcador-en-el-dataset-pbmc4k-10x"><i class="fa fa-check"></i><b>10.6</b> Ejemplo ilustrativo: CD3E como gen marcador en el dataset PBMC4k 10X</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#pruebas-pareadas"><i class="fa fa-check"></i><b>10.6.1</b> Pruebas pareadas</a></li>
<li class="chapter" data-level="10.6.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#combinando-comparaciones-del-gen-cd3e-para-el-clúster-1"><i class="fa fa-check"></i><b>10.6.2</b> Combinando comparaciones del gen CD3E para el clúster 1</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#aplicación-estándar"><i class="fa fa-check"></i><b>10.7</b> Aplicación estándar</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#explorando-los-resultados"><i class="fa fa-check"></i><b>10.7.1</b> Explorando los resultados</a></li>
<li class="chapter" data-level="10.7.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#con-un-heatmap"><i class="fa fa-check"></i><b>10.7.2</b> Con un heatmap</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#usando-el-log-fold-change"><i class="fa fa-check"></i><b>10.8</b> Usando el <em>log-fold change</em></a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#sin-espeficiar-el-lfc"><i class="fa fa-check"></i><b>10.8.1</b> Sin espeficiar el lfc</a></li>
<li class="chapter" data-level="10.8.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#especificando-el-lfc"><i class="fa fa-check"></i><b>10.8.2</b> Especificando el lfc</a></li>
<li class="chapter" data-level="10.8.3" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#heatmap"><i class="fa fa-check"></i><b>10.8.3</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#encontrando-marcadores-específicos-de-clústeres"><i class="fa fa-check"></i><b>10.9</b> Encontrando marcadores específicos de clústeres</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#proscons-de-los-genes-marcadores-específicos-de-los-clústeres"><i class="fa fa-check"></i><b>10.9.1</b> Pros/cons de los genes marcadores específicos de los clústeres</a></li>
<li class="chapter" data-level="10.9.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#findmarkers-con-pval.type-some"><i class="fa fa-check"></i><b>10.9.2</b> findMarkers con pval.type some</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#pruebas-alternas"><i class="fa fa-check"></i><b>10.10</b> Pruebas alternas</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#motivación-7"><i class="fa fa-check"></i><b>10.10.1</b> Motivación</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#prueba-de-rangos-de-wilcoxon"><i class="fa fa-check"></i><b>10.11</b> Prueba de rangos de Wilcoxon</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#findmarkers-para-wilcoxon"><i class="fa fa-check"></i><b>10.11.1</b> findMarkers para Wilcoxon</a></li>
<li class="chapter" data-level="10.11.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#heatmap-de-genes-marcadores-con-wilcoxon"><i class="fa fa-check"></i><b>10.11.2</b> Heatmap de genes marcadores con Wilcoxon</a></li>
<li class="chapter" data-level="10.11.3" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#resumen-de-la-prueba-de-rangos-de-wilcoxon"><i class="fa fa-check"></i><b>10.11.3</b> Resumen de la prueba de rangos de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#prueba-binomial"><i class="fa fa-check"></i><b>10.12</b> Prueba binomial</a>
<ul>
<li class="chapter" data-level="10.12.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#findmarkers-para-binomial"><i class="fa fa-check"></i><b>10.12.1</b> findMarkers para binomial</a></li>
<li class="chapter" data-level="10.12.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#visualizando-genes-marcadores-de-la-prueba-bionomial"><i class="fa fa-check"></i><b>10.12.2</b> Visualizando genes marcadores de la prueba bionomial</a></li>
<li class="chapter" data-level="10.12.3" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#resumen-de-la-prueba-binomial"><i class="fa fa-check"></i><b>10.12.3</b> Resumen de la prueba binomial</a></li>
</ul></li>
<li class="chapter" data-level="10.13" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#métodos-de-expresión-diferencial-personalizados"><i class="fa fa-check"></i><b>10.13</b> Métodos de expresión diferencial personalizados</a></li>
<li class="chapter" data-level="10.14" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#problemas-estadísticos"><i class="fa fa-check"></i><b>10.14</b> Problemas estadísticos</a>
<ul>
<li class="chapter" data-level="10.14.1" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#invalidez-de-p-values"><i class="fa fa-check"></i><b>10.14.1</b> Invalidez de P-values</a></li>
<li class="chapter" data-level="10.14.2" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#naturaleza-de-la-replicación"><i class="fa fa-check"></i><b>10.14.2</b> Naturaleza de la replicación</a></li>
<li class="chapter" data-level="10.14.3" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#comentarios-adicionales"><i class="fa fa-check"></i><b>10.14.3</b> Comentarios adicionales</a></li>
</ul></li>
<li class="chapter" data-level="10.15" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#resumen-y-recomendaciones-3"><i class="fa fa-check"></i><b>10.15</b> Resumen y recomendaciones</a></li>
<li class="chapter" data-level="10.16" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#detalles-de-la-sesión-de-r-9"><i class="fa fa-check"></i><b>10.16</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="identificación-de-genes-marcadores.html"><a href="identificación-de-genes-marcadores.html#patrocinadores-10"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html"><i class="fa fa-check"></i><b>11</b> Anotación de clusters de células</a>
<ul>
<li class="chapter" data-level="11.1" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#diapositivas-de-peter-hickey-4"><i class="fa fa-check"></i><b>11.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="11.2" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#motivación-8"><i class="fa fa-check"></i><b>11.2</b> Motivación</a></li>
<li class="chapter" data-level="11.3" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#dataset-ilustrativo-pbmc4k-10x-sin-filtrar-2"><i class="fa fa-check"></i><b>11.3</b> Dataset ilustrativo: PBMC4k 10X sin filtrar</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#anotación-2"><i class="fa fa-check"></i><b>11.3.1</b> Anotación</a></li>
<li class="chapter" data-level="11.3.2" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#control-de-calidad-3"><i class="fa fa-check"></i><b>11.3.2</b> Control de calidad</a></li>
<li class="chapter" data-level="11.3.3" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#genes-variables-1"><i class="fa fa-check"></i><b>11.3.3</b> Genes variables</a></li>
<li class="chapter" data-level="11.3.4" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#reducción-de-dimensiones-2"><i class="fa fa-check"></i><b>11.3.4</b> Reducción de dimensiones</a></li>
<li class="chapter" data-level="11.3.5" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#clustering-2"><i class="fa fa-check"></i><b>11.3.5</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#asignando-las-etiquetas-celulares-a-partir-de-los-datos-de-referencia"><i class="fa fa-check"></i><b>11.4</b> Asignando las etiquetas celulares a partir de los datos de referencia</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#visión-general"><i class="fa fa-check"></i><b>11.4.1</b> Visión general</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#singler"><i class="fa fa-check"></i><b>11.5</b> SingleR</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#singler-incluye-varias-referencias"><i class="fa fa-check"></i><b>11.5.1</b> SingleR incluye varias referencias</a></li>
<li class="chapter" data-level="11.5.2" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#usando-las-referencias"><i class="fa fa-check"></i><b>11.5.2</b> Usando las referencias</a></li>
<li class="chapter" data-level="11.5.3" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#usando-las-referencias-integradas"><i class="fa fa-check"></i><b>11.5.3</b> Usando las referencias integradas</a></li>
<li class="chapter" data-level="11.5.4" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#podado-de-etiquetas-label-pruning"><i class="fa fa-check"></i><b>11.5.4</b> Podado de etiquetas (Label pruning)</a></li>
<li class="chapter" data-level="11.5.5" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#identificando-los-genes-con-anotación-dirigida"><i class="fa fa-check"></i><b>11.5.5</b> Identificando los genes con anotación dirigida</a></li>
<li class="chapter" data-level="11.5.6" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#comparando-las-etiquetas-con-los-clústeres"><i class="fa fa-check"></i><b>11.5.6</b> Comparando las etiquetas con los clústeres</a></li>
<li class="chapter" data-level="11.5.7" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#voilà"><i class="fa fa-check"></i><b>11.5.7</b> Voilà</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#resumen-de-la-anotación-basada-en-una-referencia-e.g.-singler"><i class="fa fa-check"></i><b>11.6</b> Resumen de la anotación basada en una referencia (e.g., SingleR)</a></li>
<li class="chapter" data-level="11.7" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#asignando-las-etiquetas-de-tipos-celulares-a-partir-de-marcadores"><i class="fa fa-check"></i><b>11.7</b> Asignando las etiquetas de tipos celulares a partir de marcadores</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#gene-set-enrichment-analysis"><i class="fa fa-check"></i><b>11.7.1</b> Gene set enrichment analysis</a></li>
<li class="chapter" data-level="11.7.2" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#calculando-las-actividades-de-los-conjuntos-de-genes"><i class="fa fa-check"></i><b>11.7.2</b> Calculando las actividades de los conjuntos de genes</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#resumen-y-recomendaciones-4"><i class="fa fa-check"></i><b>11.8</b> Resumen y recomendaciones</a></li>
<li class="chapter" data-level="11.9" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#detalles-de-la-sesión-de-r-10"><i class="fa fa-check"></i><b>11.9</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="anotación-de-clusters-de-células.html"><a href="anotación-de-clusters-de-células.html#patrocinadores-11"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html"><i class="fa fa-check"></i><b>12</b> Análisis de expresión diferencial</a>
<ul>
<li class="chapter" data-level="12.1" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#diapositivas-de-peter-hickey-5"><i class="fa fa-check"></i><b>12.1</b> Diapositivas de Peter Hickey</a></li>
<li class="chapter" data-level="12.2" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#motivación-9"><i class="fa fa-check"></i><b>12.2</b> Motivación</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#dos-categorías-de-análisis"><i class="fa fa-check"></i><b>12.2.1</b> Dos categorías de análisis</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#datos-de-ejemplo"><i class="fa fa-check"></i><b>12.3</b> Datos de ejemplo</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#descarguemos-los-datos-de-ejemplo"><i class="fa fa-check"></i><b>12.3.1</b> Descarguemos los datos de ejemplo</a></li>
<li class="chapter" data-level="12.3.2" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#procesamiento"><i class="fa fa-check"></i><b>12.3.2</b> Procesamiento</a></li>
<li class="chapter" data-level="12.3.3" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#exploremos-los-datos-de-ejemplo"><i class="fa fa-check"></i><b>12.3.3</b> Exploremos los datos de ejemplo</a></li>
<li class="chapter" data-level="12.3.4" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#nuestros-clusters-vs-los-originales"><i class="fa fa-check"></i><b>12.3.4</b> Nuestros clusters vs los originales</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#análisis-de-expresión-diferencial-1"><i class="fa fa-check"></i><b>12.4</b> Análisis de expresión diferencial</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#pseudo-bulking"><i class="fa fa-check"></i><b>12.4.1</b> Pseudo-bulking</a></li>
<li class="chapter" data-level="12.4.2" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#convertir-a-un-objeto-nuevo"><i class="fa fa-check"></i><b>12.4.2</b> Convertir a un objeto nuevo</a></li>
<li class="chapter" data-level="12.4.3" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#pre-procesamiento"><i class="fa fa-check"></i><b>12.4.3</b> Pre-procesamiento</a></li>
<li class="chapter" data-level="12.4.4" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#modelo-estadístico"><i class="fa fa-check"></i><b>12.4.4</b> Modelo estadístico</a></li>
<li class="chapter" data-level="12.4.5" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#de-forma-sencilla"><i class="fa fa-check"></i><b>12.4.5</b> De forma sencilla</a></li>
<li class="chapter" data-level="12.4.6" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#ejercicios-1"><i class="fa fa-check"></i><b>12.4.6</b> Ejercicios</a></li>
<li class="chapter" data-level="12.4.7" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#respuestas-1"><i class="fa fa-check"></i><b>12.4.7</b> Respuestas</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#análisis-de-abundancia-diferencial"><i class="fa fa-check"></i><b>12.5</b> Análisis de abundancia diferencial</a></li>
<li class="chapter" data-level="12.6" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#comentarios-sobre-la-interpretación"><i class="fa fa-check"></i><b>12.6</b> Comentarios sobre la interpretación</a></li>
<li class="chapter" data-level="12.7" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#detalles-de-la-sesión-de-r-11"><i class="fa fa-check"></i><b>12.7</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="análisis-de-expresión-diferencial.html"><a href="análisis-de-expresión-diferencial.html#patrocinadores-12"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html"><i class="fa fa-check"></i><b>13</b> Introducción a Seurat</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#diapositivas"><i class="fa fa-check"></i><b>13.1</b> Diapositivas</a></li>
<li class="chapter" data-level="13.2" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#una-perspectiva-diferente"><i class="fa fa-check"></i><b>13.2</b> Una perspectiva diferente</a></li>
<li class="chapter" data-level="13.3" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#kick-start"><i class="fa fa-check"></i><b>13.3</b> Kick-start</a></li>
<li class="chapter" data-level="13.4" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#quality-control"><i class="fa fa-check"></i><b>13.4</b> Quality Control</a></li>
<li class="chapter" data-level="13.5" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#normalización"><i class="fa fa-check"></i><b>13.5</b> Normalización</a></li>
<li class="chapter" data-level="13.6" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#detección-de-genes-caractersticas-altamente-variables"><i class="fa fa-check"></i><b>13.6</b> Detección de genes (caractersticas) altamente variables</a></li>
<li class="chapter" data-level="13.7" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#escalar-los-datos"><i class="fa fa-check"></i><b>13.7</b> Escalar los datos</a></li>
<li class="chapter" data-level="13.8" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#reducción-dimensional-lineal"><i class="fa fa-check"></i><b>13.8</b> Reducción dimensional lineal</a></li>
<li class="chapter" data-level="13.9" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#determinar-la-dimensionalidad-del-conjunto-de-datos"><i class="fa fa-check"></i><b>13.9</b> Determinar la dimensionalidad del conjunto de datos</a></li>
<li class="chapter" data-level="13.10" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#clustering-3"><i class="fa fa-check"></i><b>13.10</b> Clustering</a></li>
<li class="chapter" data-level="13.11" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#reducción-dimensional-no-lineal-umaptsne"><i class="fa fa-check"></i><b>13.11</b> Reducción dimensional no lineal (UMAP/tSNE)</a></li>
<li class="chapter" data-level="13.12" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#caracteristicas-diferencialmente-expresadas-biomarcadores-de-los-clusters"><i class="fa fa-check"></i><b>13.12</b> Caracteristicas diferencialmente expresadas (biomarcadores de los clusters)</a></li>
<li class="chapter" data-level="13.13" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#assigning-cell-type-identity-to-clusters"><i class="fa fa-check"></i><b>13.13</b> Assigning cell type identity to clusters</a></li>
<li class="chapter" data-level="13.14" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#guardar-resultados"><i class="fa fa-check"></i><b>13.14</b> Guardar Resultados</a></li>
<li class="chapter" data-level="13.15" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#detalles-de-la-sesión-de-r-12"><i class="fa fa-check"></i><b>13.15</b> Detalles de la sesión de R</a></li>
<li class="chapter" data-level="" data-path="introducción-a-seurat.html"><a href="introducción-a-seurat.html#patrocinadores-13"><i class="fa fa-check"></i>Patrocinadores</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Análisis de datos transcriptómicos de célula única (scRNA-seq) con R y Bioconductor</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="selección-de-genes" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Selección de genes</h1>
<ul>
<li>Instructora: <a href="http://Yalbibalderas.github.io/"><strong>Yalbi I. Balderas-Martínez</strong></a></li>
<li>Instructora: <a href="https://comunidadbioinfo.github.io/es/authors/lgomez/"><strong>Laura Gómez-Romero</strong></a></li>
</ul>
<div id="diapositivas-de-peter-hickey-1" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Diapositivas de Peter Hickey</h2>
<p>Ver las diapositivas originales <a href="https://docs.google.com/presentation/d/19J2FyjKlBQdAkku4Oa6UZ6SA-Y4P7AEKCRIbEQWA9ho/edit#slide=id.ga100bba375887aa_0">aquí</a></p>
</div>
<div id="motivación-2" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Motivación</h2>
<ul>
<li><p>Usualmente usamos datos scRNA-seq para caracterizar la heterogeneidad entre células</p></li>
<li><p>Para hacer esto, usamos métodos como el clustering y la reducción de dimensionalidad</p></li>
<li><p>Esto involucra resumir las diferencias por gen en una sola medida de (dis)similitud entre un par de células</p></li>
<li><p><strong>¿Cuáles genes deberíamos usar para calcular esta medida de (dis)similitud?</strong></p></li>
</ul>
</div>
<div id="selección-de-features-genes" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Selección de <em>features</em> (genes)</h2>
<p>La elección de los <em>features</em> tiene un mayor impacto en qué tan similares decidimos que son las células</p>
<ul>
<li>➕ <em>Features</em> que contienen información útil biológica</li>
<li>➖ <em>Features</em> que contienen ruido aleatorio</li>
<li>👉 Efectos laterales al reducir la dimensionalidad de los datos</li>
</ul>
<p>Deseamos seleccionar los <strong>genes altamente variables</strong> (High Variable Genes <strong>HVGs</strong>). Genes con una variación incrementada en comparación con otros genes que están siendo afectados por ruido técnico u otra variación biológica que no es de nuestro interés.</p>
</div>
<div id="dataset-ilustrativo-pbmc4k-10x-sin-filtrar" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Dataset ilustrativo: PBMC4k 10X sin filtrar</h2>
<div id="descargar-datos" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Descargar datos</h3>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="selección-de-genes.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Usemos datos de pbmc4k</span></span>
<span id="cb383-2"><a href="selección-de-genes.html#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BiocFileCache)</span>
<span id="cb383-3"><a href="selección-de-genes.html#cb383-3" aria-hidden="true" tabindex="-1"></a>bfc <span class="ot">&lt;-</span> <span class="fu">BiocFileCache</span>()</span>
<span id="cb383-4"><a href="selección-de-genes.html#cb383-4" aria-hidden="true" tabindex="-1"></a>raw.path <span class="ot">&lt;-</span> <span class="fu">bfcrpath</span>(bfc, <span class="fu">file.path</span>(</span>
<span id="cb383-5"><a href="selección-de-genes.html#cb383-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;http://cf.10xgenomics.com/samples&quot;</span>,</span>
<span id="cb383-6"><a href="selección-de-genes.html#cb383-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cell-exp/2.1.0/pbmc4k/pbmc4k_raw_gene_bc_matrices.tar.gz&quot;</span></span>
<span id="cb383-7"><a href="selección-de-genes.html#cb383-7" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb383-8"><a href="selección-de-genes.html#cb383-8" aria-hidden="true" tabindex="-1"></a><span class="fu">untar</span>(raw.path, <span class="at">exdir =</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;pbmc4k&quot;</span>))</span>
<span id="cb383-9"><a href="selección-de-genes.html#cb383-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb383-10"><a href="selección-de-genes.html#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DropletUtils)</span>
<span id="cb383-11"><a href="selección-de-genes.html#cb383-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb383-12"><a href="selección-de-genes.html#cb383-12" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;pbmc4k/raw_gene_bc_matrices/GRCh38&quot;</span>)</span>
<span id="cb383-13"><a href="selección-de-genes.html#cb383-13" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">read10xCounts</span>(fname, <span class="at">col.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb383-14"><a href="selección-de-genes.html#cb383-14" aria-hidden="true" tabindex="-1"></a>sce.pbmc</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 33694 737280 
## metadata(1): Samples
## assays(1): counts
## rownames(33694): ENSG00000243485 ENSG00000237613 ... ENSG00000277475
##   ENSG00000268674
## rowData names(2): ID Symbol
## colnames(737280): AAACCTGAGAAACCAT-1 AAACCTGAGAAACCGC-1 ...
##   TTTGTCATCTTTAGTC-1 TTTGTCATCTTTCCTC-1
## colData names(2): Sample Barcode
## reducedDimNames(0):
## mainExpName: NULL
## altExpNames(0):</code></pre>
<p>Dataset “Células mononucleares humanas de sangre periférica” de 10X Genomics</p>
<p>Descripción <a href="https://osca.bioconductor.org/unfiltered-human-pbmcs-10x-genomics.html">aquí</a> <a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
</div>
<div id="anotación" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Anotación</h3>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="selección-de-genes.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Anotación de los genes</span></span>
<span id="cb385-2"><a href="selección-de-genes.html#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb385-3"><a href="selección-de-genes.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sce.pbmc) <span class="ot">&lt;-</span> <span class="fu">uniquifyFeatureNames</span>(</span>
<span id="cb385-4"><a href="selección-de-genes.html#cb385-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowData</span>(sce.pbmc)<span class="sc">$</span>ID, <span class="fu">rowData</span>(sce.pbmc)<span class="sc">$</span>Symbol</span>
<span id="cb385-5"><a href="selección-de-genes.html#cb385-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb385-6"><a href="selección-de-genes.html#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EnsDb.Hsapiens.v86)</span>
<span id="cb385-7"><a href="selección-de-genes.html#cb385-7" aria-hidden="true" tabindex="-1"></a>location <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(EnsDb.Hsapiens.v86,</span>
<span id="cb385-8"><a href="selección-de-genes.html#cb385-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">keys =</span> <span class="fu">rowData</span>(sce.pbmc)<span class="sc">$</span>ID,</span>
<span id="cb385-9"><a href="selección-de-genes.html#cb385-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">column =</span> <span class="st">&quot;SEQNAME&quot;</span>, <span class="at">keytype =</span> <span class="st">&quot;GENEID&quot;</span></span>
<span id="cb385-10"><a href="selección-de-genes.html#cb385-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb385-11"><a href="selección-de-genes.html#cb385-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-12"><a href="selección-de-genes.html#cb385-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Detección de _droplets_ con células</span></span>
<span id="cb385-13"><a href="selección-de-genes.html#cb385-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb385-14"><a href="selección-de-genes.html#cb385-14" aria-hidden="true" tabindex="-1"></a>e.out <span class="ot">&lt;-</span> <span class="fu">emptyDrops</span>(<span class="fu">counts</span>(sce.pbmc))</span>
<span id="cb385-15"><a href="selección-de-genes.html#cb385-15" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> sce.pbmc[, <span class="fu">which</span>(e.out<span class="sc">$</span>FDR <span class="sc">&lt;=</span> <span class="fl">0.001</span>)]</span></code></pre></div>
</div>
<div id="control-de-calidad-1" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Control de calidad</h3>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="selección-de-genes.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Control de calidad</span></span>
<span id="cb386-2"><a href="selección-de-genes.html#cb386-2" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">perCellQCMetrics</span>(sce.pbmc,</span>
<span id="cb386-3"><a href="selección-de-genes.html#cb386-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsets =</span> <span class="fu">list</span>(<span class="at">Mito =</span> <span class="fu">which</span>(location <span class="sc">==</span> <span class="st">&quot;MT&quot;</span>))</span>
<span id="cb386-4"><a href="selección-de-genes.html#cb386-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb386-5"><a href="selección-de-genes.html#cb386-5" aria-hidden="true" tabindex="-1"></a>high.mito <span class="ot">&lt;-</span> <span class="fu">isOutlier</span>(stats<span class="sc">$</span>subsets_Mito_percent,</span>
<span id="cb386-6"><a href="selección-de-genes.html#cb386-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;higher&quot;</span></span>
<span id="cb386-7"><a href="selección-de-genes.html#cb386-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb386-8"><a href="selección-de-genes.html#cb386-8" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> sce.pbmc[, <span class="sc">!</span>high.mito]</span>
<span id="cb386-9"><a href="selección-de-genes.html#cb386-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-10"><a href="selección-de-genes.html#cb386-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalización de los datos</span></span>
<span id="cb386-11"><a href="selección-de-genes.html#cb386-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb386-12"><a href="selección-de-genes.html#cb386-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb386-13"><a href="selección-de-genes.html#cb386-13" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">quickCluster</span>(sce.pbmc)</span>
<span id="cb386-14"><a href="selección-de-genes.html#cb386-14" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">computeSumFactors</span>(sce.pbmc, <span class="at">cluster =</span> clusters)</span>
<span id="cb386-15"><a href="selección-de-genes.html#cb386-15" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">logNormCounts</span>(sce.pbmc)</span></code></pre></div>
</div>
<div id="preguntas-de-repaso" class="section level3" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Preguntas de repaso</h3>
<ul>
<li>¿Cómo determinamos cuáles eran los genes mitocondriales? <a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></li>
<li>¿Cómo decidimos filtrar las células? <a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></li>
<li>¿Puedes explicar como normalizamos los datos? <a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></li>
</ul>
</div>
</div>
<div id="dataset-ilustrativo-416b" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Dataset ilustrativo: 416B</h2>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="selección-de-genes.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scRNAseq)</span>
<span id="cb387-2"><a href="selección-de-genes.html#cb387-2" aria-hidden="true" tabindex="-1"></a>sce<span class="fl">.416</span>b <span class="ot">&lt;-</span> <span class="fu">LunSpikeInData</span>(<span class="at">which =</span> <span class="st">&quot;416b&quot;</span>)</span>
<span id="cb387-3"><a href="selección-de-genes.html#cb387-3" aria-hidden="true" tabindex="-1"></a>sce<span class="fl">.416</span>b<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(sce<span class="fl">.416</span>b<span class="sc">$</span>block)</span></code></pre></div>
<p>Línea celular de células mieloides progenitoras inmortalizadas de ratón usando SmartSeq2
<a href="https://osca.bioconductor.org/lun-416b-cell-line-smart-seq2.html">https://osca.bioconductor.org/lun-416b-cell-line-smart-seq2.html</a> <a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a></p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="selección-de-genes.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gene-annotation</span></span>
<span id="cb388-2"><a href="selección-de-genes.html#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AnnotationHub)</span>
<span id="cb388-3"><a href="selección-de-genes.html#cb388-3" aria-hidden="true" tabindex="-1"></a>ens.mm.v97 <span class="ot">&lt;-</span> <span class="fu">AnnotationHub</span>()[[<span class="st">&quot;AH73905&quot;</span>]]</span>
<span id="cb388-4"><a href="selección-de-genes.html#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rowData</span>(sce<span class="fl">.416</span>b)<span class="sc">$</span>ENSEMBL <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sce<span class="fl">.416</span>b)</span>
<span id="cb388-5"><a href="selección-de-genes.html#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rowData</span>(sce<span class="fl">.416</span>b)<span class="sc">$</span>SYMBOL <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(ens.mm.v97,</span>
<span id="cb388-6"><a href="selección-de-genes.html#cb388-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">keys =</span> <span class="fu">rownames</span>(sce<span class="fl">.416</span>b),</span>
<span id="cb388-7"><a href="selección-de-genes.html#cb388-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">keytype =</span> <span class="st">&quot;GENEID&quot;</span>, <span class="at">column =</span> <span class="st">&quot;SYMBOL&quot;</span></span>
<span id="cb388-8"><a href="selección-de-genes.html#cb388-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb388-9"><a href="selección-de-genes.html#cb388-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rowData</span>(sce<span class="fl">.416</span>b)<span class="sc">$</span>SEQNAME <span class="ot">&lt;-</span> <span class="fu">mapIds</span>(ens.mm.v97,</span>
<span id="cb388-10"><a href="selección-de-genes.html#cb388-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">keys =</span> <span class="fu">rownames</span>(sce<span class="fl">.416</span>b),</span>
<span id="cb388-11"><a href="selección-de-genes.html#cb388-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">keytype =</span> <span class="st">&quot;GENEID&quot;</span>, <span class="at">column =</span> <span class="st">&quot;SEQNAME&quot;</span></span>
<span id="cb388-12"><a href="selección-de-genes.html#cb388-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb388-13"><a href="selección-de-genes.html#cb388-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb388-14"><a href="selección-de-genes.html#cb388-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sce<span class="fl">.416</span>b) <span class="ot">&lt;-</span> <span class="fu">uniquifyFeatureNames</span>(</span>
<span id="cb388-15"><a href="selección-de-genes.html#cb388-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowData</span>(sce<span class="fl">.416</span>b)<span class="sc">$</span>ENSEMBL,</span>
<span id="cb388-16"><a href="selección-de-genes.html#cb388-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowData</span>(sce<span class="fl">.416</span>b)<span class="sc">$</span>SYMBOL</span>
<span id="cb388-17"><a href="selección-de-genes.html#cb388-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="selección-de-genes.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quality-control</span></span>
<span id="cb389-2"><a href="selección-de-genes.html#cb389-2" aria-hidden="true" tabindex="-1"></a>mito <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rowData</span>(sce<span class="fl">.416</span>b)<span class="sc">$</span>SEQNAME <span class="sc">==</span> <span class="st">&quot;MT&quot;</span>)</span>
<span id="cb389-3"><a href="selección-de-genes.html#cb389-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">perCellQCMetrics</span>(sce<span class="fl">.416</span>b, <span class="at">subsets =</span> <span class="fu">list</span>(<span class="at">Mt =</span> mito))</span>
<span id="cb389-4"><a href="selección-de-genes.html#cb389-4" aria-hidden="true" tabindex="-1"></a>qc <span class="ot">&lt;-</span> <span class="fu">quickPerCellQC</span>(stats,</span>
<span id="cb389-5"><a href="selección-de-genes.html#cb389-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_subsets =</span> <span class="fu">c</span>(<span class="st">&quot;subsets_Mt_percent&quot;</span>, <span class="st">&quot;altexps_ERCC_percent&quot;</span>),</span>
<span id="cb389-6"><a href="selección-de-genes.html#cb389-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">batch =</span> sce<span class="fl">.416</span>b<span class="sc">$</span>block</span>
<span id="cb389-7"><a href="selección-de-genes.html#cb389-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb389-8"><a href="selección-de-genes.html#cb389-8" aria-hidden="true" tabindex="-1"></a>sce<span class="fl">.416</span>b <span class="ot">&lt;-</span> sce<span class="fl">.416</span>b[, <span class="sc">!</span>qc<span class="sc">$</span>discard]</span>
<span id="cb389-9"><a href="selección-de-genes.html#cb389-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-10"><a href="selección-de-genes.html#cb389-10" aria-hidden="true" tabindex="-1"></a><span class="co"># normalization</span></span>
<span id="cb389-11"><a href="selección-de-genes.html#cb389-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb389-12"><a href="selección-de-genes.html#cb389-12" aria-hidden="true" tabindex="-1"></a>sce<span class="fl">.416</span>b <span class="ot">&lt;-</span> <span class="fu">computeSumFactors</span>(sce<span class="fl">.416</span>b)</span>
<span id="cb389-13"><a href="selección-de-genes.html#cb389-13" aria-hidden="true" tabindex="-1"></a>sce<span class="fl">.416</span>b <span class="ot">&lt;-</span> <span class="fu">logNormCounts</span>(sce<span class="fl">.416</span>b)</span></code></pre></div>
<div id="preguntas-de-repaso-1" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Preguntas de repaso</h3>
<ul>
<li>¿Cómo determinamos cuáles eran los genes mitocondriales?</li>
<li>¿Cómo decidimos filtrar las células</li>
<li>¿Puedes explicar cómo normalizamos los datos?</li>
</ul>
</div>
</div>
<div id="cuantificando-la-varianza-por-gen" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Cuantificando la varianza por gen</h2>
<div id="varianza-de-los-log-counts" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Varianza de los <em>log-counts</em></h3>
<p>El enfoque más simple para cuantificar la variación <em>per-feature</em> es simplemente calcular la varianza de los <em>log-counts</em></p>
<ul>
<li>➕ Selección del <em>feature</em> basado en los <em>log-counts</em> (que serán usadas en los análisis más adelante)</li>
<li>⚠️ La transformación log no logra la estabilización de la varianza perfecta, así que se requiere modelar la relación de la varianza-media de los <em>features</em>.</li>
</ul>
</div>
<div id="enfoque-simple" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Enfoque simple</h3>
<ol style="list-style-type: decimal">
<li>Calcular la varianza de los <em>log-counts</em> para cada gen (ignorando grupos experimentales)</li>
<li>Ordenar los genes del más-al-menos variable</li>
</ol>
</div>
<div id="un-enfoque-más-sofisticado" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Un enfoque más sofisticado</h3>
<ol style="list-style-type: decimal">
<li>Calcular la varianza de los <em>log-counts</em> para cada gen (ignorando grupos experimentales)</li>
<li>Modelar la relación entre la media y la varianza de los <em>log-counts</em> para estimar la variación <em>técnica</em></li>
<li>Estimar la varianza <em>biológica</em> sustrayendo la varianza <em>técnica</em> de la varianza total</li>
<li>Ordenar los genes de la variable de mayor-a-menor biológicamente</li>
</ol>
</div>
<div id="supuestos" class="section level3" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Supuestos</h3>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="selección-de-genes.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza de las log-counts</span></span>
<span id="cb390-2"><a href="selección-de-genes.html#cb390-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scran)</span>
<span id="cb390-3"><a href="selección-de-genes.html#cb390-3" aria-hidden="true" tabindex="-1"></a>dec.pbmc <span class="ot">&lt;-</span> <span class="fu">modelGeneVar</span>(sce.pbmc)</span></code></pre></div>
<ul>
<li>🤓 El supuesto es que a cualquier abundancia dada, la abundancia de los perfiles de expresión de la mayoría de los genes están dominados por el ruido aleatorio <em>técnico</em></li>
<li>🤓 Por lo consiguiente, una tendencia representa un estimado del ruido técnico como una función de la abundancia</li>
<li>🤓 Podemos entonces descomponer la varianza total de cada gen en un componente <em>técnico</em> y uno <em>biológico</em></li>
<li>🤓 Genes con una gran varianza <em>biológica</em> son considerados interesantes</li>
</ul>
</div>
<div id="visualizando-la-media-y-varianza" class="section level3" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> Visualizando la media y varianza</h3>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="selección-de-genes.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualicemos la relación entre la media y la varianza</span></span>
<span id="cb391-2"><a href="selección-de-genes.html#cb391-2" aria-hidden="true" tabindex="-1"></a>fit.pbmc <span class="ot">&lt;-</span> <span class="fu">metadata</span>(dec.pbmc)</span>
<span id="cb391-3"><a href="selección-de-genes.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.pbmc<span class="sc">$</span>mean, fit.pbmc<span class="sc">$</span>var,</span>
<span id="cb391-4"><a href="selección-de-genes.html#cb391-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Mean of log-expression&quot;</span>,</span>
<span id="cb391-5"><a href="selección-de-genes.html#cb391-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Variance of log-expression&quot;</span></span>
<span id="cb391-6"><a href="selección-de-genes.html#cb391-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb391-7"><a href="selección-de-genes.html#cb391-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(fit.pbmc<span class="sc">$</span><span class="fu">trend</span>(x), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="07-seleccion_genes_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div id="ejercicios" class="section level4" number="7.6.5.1">
<h4><span class="header-section-number">7.6.5.1</span> Ejercicios</h4>
<ul>
<li>¿Qué tipo de objeto nos regresó <code>modelGeneVar()</code>? <a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a></li>
<li>¿<code>dec.pbmc</code> es una tabla? ¿O contiene mayor información? <a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a></li>
<li>¿Qué tipo de objeto es <code>fit.pbmc</code> y que objetos con nombres contiene? <a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a></li>
<li>¿Qué tipo de objeto es <code>fit.pbmc$trend</code>? <a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a></li>
<li>¿Donde podemos encontrar más detalles de esta función? <a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a></li>
</ul>
</div>
</div>
<div id="ordenando-genes-interesantes" class="section level3" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> Ordenando genes interesantes</h3>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="selección-de-genes.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenemos por los genes más interesantes para checar</span></span>
<span id="cb392-2"><a href="selección-de-genes.html#cb392-2" aria-hidden="true" tabindex="-1"></a><span class="co"># los datos</span></span>
<span id="cb392-3"><a href="selección-de-genes.html#cb392-3" aria-hidden="true" tabindex="-1"></a>dec.pbmc[<span class="fu">order</span>(dec.pbmc<span class="sc">$</span>bio, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span></code></pre></div>
<pre><code>## DataFrame with 33694 rows and 6 columns
##              mean     total      tech       bio      p.value          FDR
##         &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;    &lt;numeric&gt;    &lt;numeric&gt;
## LYZ       1.95605   5.05854  0.835343   4.22320 1.10538e-270 2.17417e-266
## S100A9    1.93416   4.53551  0.835439   3.70007 2.71043e-208 7.61593e-205
## S100A8    1.69961   4.41084  0.824342   3.58650 4.31581e-201 9.43197e-198
## HLA-DRA   2.09785   3.75174  0.831239   2.92050 5.93950e-132 4.86767e-129
## CD74      2.90176   3.36879  0.793188   2.57560 4.83937e-113 2.50488e-110
## ...           ...       ...       ...       ...          ...          ...
## TMSB4X    6.08142  0.441718  0.679215 -0.237497     0.992447            1
## PTMA      3.82978  0.486454  0.731275 -0.244821     0.990002            1
## HLA-B     4.50032  0.486130  0.739577 -0.253447     0.991376            1
## EIF1      3.23488  0.482869  0.768946 -0.286078     0.995135            1
## B2M       5.95196  0.314948  0.654228 -0.339280     0.999843            1</code></pre>
</div>
</div>
<div id="coeficiente-de-variación-de-las-cuentas" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Coeficiente de variación de las cuentas</h2>
<p>El coeficiente de variación de las cuentas al cuadrado (CV<sup>2</sup>) es una alternativa a la varianza de los <em>log-counts</em></p>
<ul>
<li><p>👉 Se calcula usando las cuentas en lugar de los <em>log-counts</em></p></li>
<li><p>🤓 CV es el <em>ratio</em> de la desviación estándar a la media y está muy relacionada con el parámetro de <em>dispersión</em> de la distribución binomial negativa usada en edgeR y DESeq2</p></li>
</ul>
<div id="coeficiente-de-variación" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> Coeficiente de variación</h3>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="selección-de-genes.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coeficiente de variación</span></span>
<span id="cb394-2"><a href="selección-de-genes.html#cb394-2" aria-hidden="true" tabindex="-1"></a>dec.cv2.pbmc <span class="ot">&lt;-</span> <span class="fu">modelGeneCV2</span>(sce.pbmc)</span></code></pre></div>
<ul>
<li>🤓 Modela la relación de la media de la varianza cuando se considera la relevancia de cada gen</li>
<li>🤓 Asume que la mayoría de los genes contienen ruido aleatorio y que la tendencia captura la mayoría de la variación técnica</li>
<li>🤓 Genes con un gran CV<sup>2</sup> que se desvían fuertemente de la tendencia es probable que representen genes afectados por la estructura biológica</li>
<li>🤓 Usa la tasa (en lugar de la diferencia) del CV<sup>2</sup> a la tendencia</li>
</ul>
</div>
<div id="visualizando-el-coeficiente-de-variación" class="section level3" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> Visualizando el coeficiente de variación</h3>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="selección-de-genes.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualicemos la relación con la media</span></span>
<span id="cb395-2"><a href="selección-de-genes.html#cb395-2" aria-hidden="true" tabindex="-1"></a>fit.cv2.pbmc <span class="ot">&lt;-</span> <span class="fu">metadata</span>(dec.cv2.pbmc)</span>
<span id="cb395-3"><a href="selección-de-genes.html#cb395-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.cv2.pbmc<span class="sc">$</span>mean, fit.cv2.pbmc<span class="sc">$</span>cv2,</span>
<span id="cb395-4"><a href="selección-de-genes.html#cb395-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">log =</span> <span class="st">&quot;xy&quot;</span></span>
<span id="cb395-5"><a href="selección-de-genes.html#cb395-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb395-6"><a href="selección-de-genes.html#cb395-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(fit.cv2.pbmc<span class="sc">$</span><span class="fu">trend</span>(x),</span>
<span id="cb395-7"><a href="selección-de-genes.html#cb395-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb395-8"><a href="selección-de-genes.html#cb395-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb395-9"><a href="selección-de-genes.html#cb395-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="07-seleccion_genes_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="genes-por-coeficiente-de-variación" class="section level3" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> Genes por coeficiente de variación</h3>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="selección-de-genes.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenemos por los genes más interesantes para checar</span></span>
<span id="cb396-2"><a href="selección-de-genes.html#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="co"># los datos</span></span>
<span id="cb396-3"><a href="selección-de-genes.html#cb396-3" aria-hidden="true" tabindex="-1"></a>dec.cv2.pbmc[<span class="fu">order</span>(dec.cv2.pbmc<span class="sc">$</span>ratio,</span>
<span id="cb396-4"><a href="selección-de-genes.html#cb396-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">decreasing =</span> <span class="cn">TRUE</span></span>
<span id="cb396-5"><a href="selección-de-genes.html#cb396-5" aria-hidden="true" tabindex="-1"></a>), ]</span></code></pre></div>
<pre><code>## DataFrame with 33694 rows and 6 columns
##                 mean     total     trend     ratio   p.value       FDR
##            &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## PPBP       2.2437397   132.364  0.803689   164.696         0         0
## PRTFDC1    0.0658743  3197.564 20.266829   157.773         0         0
## HIST1H2AC  1.3731487   175.035  1.176934   148.721         0         0
## FAM81B     0.0477082  3654.419 27.902078   130.973         0         0
## PF4        1.8333127   109.451  0.935484   116.999         0         0
## ...              ...       ...       ...       ...       ...       ...
## AC023491.2         0       NaN       Inf       NaN       NaN       NaN
## AC233755.2         0       NaN       Inf       NaN       NaN       NaN
## AC233755.1         0       NaN       Inf       NaN       NaN       NaN
## AC213203.1         0       NaN       Inf       NaN       NaN       NaN
## FAM231B            0       NaN       Inf       NaN       NaN       NaN</code></pre>
</div>
</div>
<div id="varianza-de-los-log-counts-vs-coeficiente-de-variación" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Varianza de los <em>log-counts</em> vs coeficiente de variación</h2>
<p><strong>Generalmente se usa la varianza de los <em>log-counts</em></strong></p>
<ul>
<li>Ambas son medidas efectivas para cuantificar la variación en la expresión génica</li>
<li>CV<sup>2</sup> tiende a tener otorgar rangos altos a genes altamente variables (HGVs) con bajos niveles de expresión
<ul>
<li>Éstos son dirigidos por una sobreregulación en subpoblaciones raras</li>
<li>Puede asignar un alto rango a genes que no son de nuestro interés con varianza baja absoluta<br />
</li>
</ul></li>
<li>La variación descrita por el CV<sup>2</sup> de las cuentas es menos relevante para los procedimientos que operan en los <em>log-counts</em></li>
</ul>
</div>
<div id="cuantificando-el-ruido-técnico" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Cuantificando el ruido técnico</h2>
<ul>
<li><p>Previamente, ajustamos una línea de tendencia a todos los genes endógenos y asumimos que la mayoría de los genes no están dominados por ruido técnico</p></li>
<li><p>En la práctica, todos los genes expresados tienen algún nivel de variabilidad biológica diferente de cero (e.g., transcriptional bursting)</p></li>
<li><p>Esto sugiere que nuestros estimados de los componentes técnicos estarán inflados probablemente</p></li>
<li><p>👉 Es mejor que pensemos estos estimados como una variación <em>técnica</em> más la variación biológica que no es interesante</p></li>
<li><p>🤔 Pero que tal si un grupo de genes a una abundancia particular es afectado por un proceso biológico?
E.g., fuerte sobre regulación de genes específicos de un tipo celular podrían conllevar a un enriquecimiento de HVGs en abundancias altas. Esto inflaría la tendencia y compromete la detección de los genes relevantes</p></li>
</ul>
<p><strong>¿Cómo podemos evitar este problema?</strong></p>
<p>Podemos revisar dos enfoques:</p>
<ol style="list-style-type: decimal">
<li>Cuando tenemos spike-ins</li>
<li>Cuando no tenemos spike-ins</li>
</ol>
<div id="en-la-presencia-de-spike-ins" class="section level3" number="7.9.1">
<h3><span class="header-section-number">7.9.1</span> En la presencia de spike-ins</h3>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="selección-de-genes.html#cb398-1" aria-hidden="true" tabindex="-1"></a>dec.spike<span class="fl">.416</span>b <span class="ot">&lt;-</span> <span class="fu">modelGeneVarWithSpikes</span>(</span>
<span id="cb398-2"><a href="selección-de-genes.html#cb398-2" aria-hidden="true" tabindex="-1"></a>    sce<span class="fl">.416</span>b,</span>
<span id="cb398-3"><a href="selección-de-genes.html#cb398-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ERCC&quot;</span></span>
<span id="cb398-4"><a href="selección-de-genes.html#cb398-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb398-5"><a href="selección-de-genes.html#cb398-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordering by most interesting genes for</span></span>
<span id="cb398-6"><a href="selección-de-genes.html#cb398-6" aria-hidden="true" tabindex="-1"></a><span class="co"># inspection.</span></span>
<span id="cb398-7"><a href="selección-de-genes.html#cb398-7" aria-hidden="true" tabindex="-1"></a>dec.spike<span class="fl">.416</span>b[<span class="fu">order</span>(dec.spike<span class="fl">.416</span>b<span class="sc">$</span>bio,</span>
<span id="cb398-8"><a href="selección-de-genes.html#cb398-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">decreasing =</span> <span class="cn">TRUE</span></span>
<span id="cb398-9"><a href="selección-de-genes.html#cb398-9" aria-hidden="true" tabindex="-1"></a>), ]</span></code></pre></div>
<pre><code>## DataFrame with 46604 rows and 6 columns
##               mean     total      tech       bio      p.value          FDR
##          &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;    &lt;numeric&gt;    &lt;numeric&gt;
## Lyz2       6.61097   13.8497   1.57131   12.2784 1.48993e-186 1.54156e-183
## Ccl9       6.67846   13.1869   1.50035   11.6866 2.21856e-185 2.19979e-182
## Top2a      5.81024   14.1787   2.54776   11.6310  3.80016e-65  1.13040e-62
## Cd200r3    4.83180   15.5613   4.22984   11.3314  9.46221e-24  6.08574e-22
## Ccnb2      5.97776   13.1393   2.30177   10.8375  3.68706e-69  1.20193e-66
## ...            ...       ...       ...       ...          ...          ...
## Rpl5-ps2   3.60625  0.612623   6.32853  -5.71590     0.999616     0.999726
## Gm11942    3.38768  0.798570   6.51473  -5.71616     0.999459     0.999726
## Gm12816    2.91276  0.838670   6.57364  -5.73497     0.999422     0.999726
## Gm13623    2.72844  0.708071   6.45448  -5.74641     0.999544     0.999726
## Rps12l1    3.15420  0.746615   6.59332  -5.84670     0.999522     0.999726</code></pre>
<ul>
<li>👉 Ajusta la tendencia solo con los spike-ins (que deberían estar afectados solamente por variación técnica)</li>
</ul>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="selección-de-genes.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec.spike<span class="fl">.416</span>b<span class="sc">$</span>mean, dec.spike<span class="fl">.416</span>b<span class="sc">$</span>total,</span>
<span id="cb400-2"><a href="selección-de-genes.html#cb400-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Mean of log-expression&quot;</span>,</span>
<span id="cb400-3"><a href="selección-de-genes.html#cb400-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Variance of log-expression&quot;</span></span>
<span id="cb400-4"><a href="selección-de-genes.html#cb400-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb400-5"><a href="selección-de-genes.html#cb400-5" aria-hidden="true" tabindex="-1"></a>fit.spike<span class="fl">.416</span>b <span class="ot">&lt;-</span> <span class="fu">metadata</span>(dec.spike<span class="fl">.416</span>b)</span>
<span id="cb400-6"><a href="selección-de-genes.html#cb400-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(fit.spike<span class="fl">.416</span>b<span class="sc">$</span>mean, fit.spike<span class="fl">.416</span>b<span class="sc">$</span>var,</span>
<span id="cb400-7"><a href="selección-de-genes.html#cb400-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span></span>
<span id="cb400-8"><a href="selección-de-genes.html#cb400-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb400-9"><a href="selección-de-genes.html#cb400-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(fit.spike<span class="fl">.416</span>b<span class="sc">$</span><span class="fu">trend</span>(x),</span>
<span id="cb400-10"><a href="selección-de-genes.html#cb400-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb400-11"><a href="selección-de-genes.html#cb400-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb400-12"><a href="selección-de-genes.html#cb400-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="07-seleccion_genes_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="en-la-ausencia-de-spike-ins" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> En la ausencia de spike-ins</h2>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="selección-de-genes.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0010101</span>)</span>
<span id="cb401-2"><a href="selección-de-genes.html#cb401-2" aria-hidden="true" tabindex="-1"></a>dec.pois.pbmc <span class="ot">&lt;-</span> <span class="fu">modelGeneVarByPoisson</span>(sce.pbmc)</span>
<span id="cb401-3"><a href="selección-de-genes.html#cb401-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordering by most interesting genes for inspection.</span></span>
<span id="cb401-4"><a href="selección-de-genes.html#cb401-4" aria-hidden="true" tabindex="-1"></a>dec.pois.pbmc[<span class="fu">order</span>(dec.pois.pbmc<span class="sc">$</span>bio, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span></code></pre></div>
<pre><code>## DataFrame with 33694 rows and 6 columns
##              mean     total      tech        bio   p.value       FDR
##         &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;
## LYZ       1.95605   5.05854  0.631190    4.42735         0         0
## S100A9    1.93416   4.53551  0.635102    3.90040         0         0
## S100A8    1.69961   4.41084  0.671491    3.73935         0         0
## HLA-DRA   2.09785   3.75174  0.604448    3.14730         0         0
## CD74      2.90176   3.36879  0.444928    2.92386         0         0
## ...           ...       ...       ...        ...       ...       ...
## ATP5J    0.614027  0.454754  0.502701 -0.0479473  0.943718  1.000000
## NEDD8    0.841407  0.561295  0.609895 -0.0486003  0.907530  0.997441
## NDUFA1   0.860049  0.560222  0.616330 -0.0561074  0.935049  1.000000
## SAP18    0.763057  0.515764  0.578890 -0.0631264  0.965173  1.000000
## SUMO2    1.359514  0.619811  0.693247 -0.0734360  0.960991  1.000000</code></pre>
<ul>
<li>👉 Realiza algunas asunciones estadísticas acerca del ruido</li>
<li>🤓 Las cuentas UMI típicamente muestran una variación cercana a Poisson si solo consideramos ruido técnico de la preparación de las librerías y la secuenciación</li>
<li>⚠️ modelGeneVarByPoisson() realiza simulaciones, por lo que necesitamos “ajustar la “semilla” para obtener resultados reproducibles</li>
<li>🤓 modelGeneVarByPoisson() pueden también simular una variación binomial negativa (variación de Poisson sobredispersada)</li>
</ul>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="selección-de-genes.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dec.pois.pbmc<span class="sc">$</span>mean, dec.pois.pbmc<span class="sc">$</span>total,</span>
<span id="cb403-2"><a href="selección-de-genes.html#cb403-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">&quot;Mean of log-expression&quot;</span>,</span>
<span id="cb403-3"><a href="selección-de-genes.html#cb403-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Variance of log-expression&quot;</span></span>
<span id="cb403-4"><a href="selección-de-genes.html#cb403-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb403-5"><a href="selección-de-genes.html#cb403-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">metadata</span>(dec.pois.pbmc)<span class="sc">$</span><span class="fu">trend</span>(x),</span>
<span id="cb403-6"><a href="selección-de-genes.html#cb403-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span></span>
<span id="cb403-7"><a href="selección-de-genes.html#cb403-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="07-seleccion_genes_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<ul>
<li>🤓 La línea de tendencia basada puramente en ruido técnico tiende a producir componentes “biológicos” más grandes por los genes altamente expresados, que frecuentemente incluyen los genes “house-keeping”</li>
<li>🤔 Necesitas considerar si tales genes son “interesantes” o no en tu dataset de interés</li>
</ul>
</div>
<div id="recordemos-propiedades-de-los-datos-de-sce.416b" class="section level2" number="7.11">
<h2><span class="header-section-number">7.11</span> Recordemos propiedades de los datos de sce.416b</h2>
<p>Este dataset consiste de células de una línea celular de células inmortalizadas mieloides progenitoras de ratón utilizando SmartSeq2</p>
<p>Una cantidad constante de spike-in ERCC RNA se agregó a cada lisado celular antes de la prepatación de la librería</p>
<p>Descripción <a href="https://osca.bioconductor.org/lun-416b-cell-line-smart-seq2.html">aquí</a></p>
<p><em>Lun, A. T. L., Calero-Nieto, F. J., Haim-Vilmovsky, L., Göttgens, B. &amp; Marioni, J. C. Assessing the reliability of spike-in normalization for analyses of single-cell RNA sequencing data. Genome Res. 27, 1795–1806 (2017)</em></p>
</div>
<div id="considerando-factores-experimentales" class="section level2" number="7.12">
<h2><span class="header-section-number">7.12</span> Considerando factores experimentales</h2>
<ul>
<li>Los datos que contienen múltiples <em>batches</em> muy seguido presentan <strong>efecto de bloque</strong> que pueden crear HGVs artificiales</li>
<li>Se debe identificar los HGVs en cada <em>batch</em> y combinarlos en una única lista de HGVs</li>
</ul>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="selección-de-genes.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando la variacion por bloque</span></span>
<span id="cb404-2"><a href="selección-de-genes.html#cb404-2" aria-hidden="true" tabindex="-1"></a>dec.block<span class="fl">.416</span>b <span class="ot">&lt;-</span> <span class="fu">modelGeneVarWithSpikes</span>(sce<span class="fl">.416</span>b,</span>
<span id="cb404-3"><a href="selección-de-genes.html#cb404-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;ERCC&quot;</span>,</span>
<span id="cb404-4"><a href="selección-de-genes.html#cb404-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">block =</span> sce<span class="fl">.416</span>b<span class="sc">$</span>block</span>
<span id="cb404-5"><a href="selección-de-genes.html#cb404-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb404-6"><a href="selección-de-genes.html#cb404-6" aria-hidden="true" tabindex="-1"></a>dec.block<span class="fl">.416</span>b[<span class="fu">order</span>(</span>
<span id="cb404-7"><a href="selección-de-genes.html#cb404-7" aria-hidden="true" tabindex="-1"></a>    dec.block<span class="fl">.416</span>b<span class="sc">$</span>bio,</span>
<span id="cb404-8"><a href="selección-de-genes.html#cb404-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">decreasing =</span> <span class="cn">TRUE</span></span>
<span id="cb404-9"><a href="selección-de-genes.html#cb404-9" aria-hidden="true" tabindex="-1"></a>), ]</span></code></pre></div>
<pre><code>## DataFrame with 46604 rows and 7 columns
##               mean     total      tech       bio      p.value          FDR
##          &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;    &lt;numeric&gt;    &lt;numeric&gt;
## Lyz2       6.61235   13.8619   1.58416   12.2777  0.00000e+00  0.00000e+00
## Ccl9       6.67841   13.2599   1.44553   11.8143  0.00000e+00  0.00000e+00
## Top2a      5.81275   14.0192   2.74571   11.2734 3.89855e-137 8.43398e-135
## Cd200r3    4.83305   15.5909   4.31892   11.2719  1.17783e-54  7.00721e-53
## Ccnb2      5.97999   13.0256   2.46647   10.5591 1.20380e-151 2.98405e-149
## ...            ...       ...       ...       ...          ...          ...
## Gm12816    2.91299  0.842574   6.67730  -5.83472     0.999989     0.999999
## Gm5786     2.90717  0.879485   6.71686  -5.83738     0.999994     0.999999
## Rpl9-ps4   3.26421  0.807057   6.64932  -5.84226     0.999988     0.999999
## Gm13623    2.72788  0.700296   6.63875  -5.93845     0.999998     0.999999
## Rps12l1    3.15425  0.750775   6.70033  -5.94955     0.999995     0.999999
##                                                          per.block
##                                                        &lt;DataFrame&gt;
## Lyz2       6.35652:13.3748:2.08227:...:6.86819:14.3490:1.08605:...
## Ccl9       6.68726:13.0778:1.65923:...:6.66956:13.4420:1.23184:...
## Top2a      5.34891:17.5972:3.91642:...:6.27659:10.4411:1.57501:...
## Cd200r3    4.60115:15.7870:5.55587:...:5.06496:15.3948:3.08197:...
## Ccnb2      5.56701:15.4150:3.46931:...:6.39298:10.6362:1.46362:...
## ...                                                            ...
## Gm12816  2.86995:0.624143:7.43036:...:2.95604:1.061004:5.92424:...
## Gm5786   2.96006:0.902872:7.49911:...:2.85427:0.856098:5.93462:...
## Rpl9-ps4 3.60690:0.543276:7.36805:...:2.92151:1.070839:5.93058:...
## Gm13623  2.83129:0.852901:7.39442:...:2.62447:0.547692:5.88308:...
## Rps12l1  3.14399:0.716670:7.57246:...:3.16452:0.784881:5.82819:...</code></pre>
<p>Al calcular tendencias específicas por batch se tomarán en cuenta las diferencias en la relación media-varianza entre batches</p>
<p>Se deben obtener estimados de los componentes biológico y técnico para cada gene específicos de cada batch, los cuales se promedian entre los batches para crear una única lista de HVGs</p>
<div class="figure">
<img src="img/experimental-factor.png" alt="Factor experimental." width="100%" />
<p class="caption">
Factor experimental.
</p>
</div>
</div>
<div id="seleccionando-genes-altamante-variables-high-variable-genes-hvgs" class="section level2" number="7.13">
<h2><span class="header-section-number">7.13</span> Seleccionando genes altamante variables (high-variable genes, HVGs)</h2>
<p>Hasta ahora hemos ordenado los genes del más al menos <strong>interesantemente variable</strong></p>
<p><em>¿Qué tanto debemos de bajar en la lista para seleccionar nuestros HVGs?</em></p>
<p>Para responder esta pregunta debemos tomar en cuenta lo siguiente: elegir un subset más grande:</p>
<ul>
<li>Reduce el riesgo de desechar señal biológica</li>
<li>Incrementa el ruido por la inclusión de genes irrelevantes</li>
</ul>
<p>Es difícil determinar el balance óptimo porque el rudio en un contexto podría ser una señal útil en otro contexto</p>
<p>Discutiremos algunas estrategias para seleccionar HVGs</p>
<div id="seleccionando-hvgs-sobre-la-métrica-de-varianza" class="section level3" number="7.13.1">
<h3><span class="header-section-number">7.13.1</span> Seleccionando HVGs sobre la métrica de varianza</h3>
<p>La estrategia más simple es seleccionar los <strong>top-X genes</strong> con los valores más grandes para la métrica relevante de varianza, <em>por ejemplo, la varianza biológica más grande calculada con <code>scran::modelGeneVar()</code></em></p>
<p><strong>Pro</strong>: El usuario puede controlar directamente el número de HVGs</p>
<p><strong>Contra</strong>: ¿Qué valor de X se debe usar?</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="selección-de-genes.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with modelGeneVar() output</span></span>
<span id="cb406-2"><a href="selección-de-genes.html#cb406-2" aria-hidden="true" tabindex="-1"></a>hvg.pbmc.var <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.pbmc, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb406-3"><a href="selección-de-genes.html#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg.pbmc.var)</span></code></pre></div>
<pre><code>##  chr [1:1000] &quot;LYZ&quot; &quot;S100A9&quot; &quot;S100A8&quot; &quot;HLA-DRA&quot; &quot;CD74&quot; &quot;CST3&quot; &quot;TYROBP&quot; ...</code></pre>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="selección-de-genes.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with modelGeneVarWithSpikes() output</span></span>
<span id="cb408-2"><a href="selección-de-genes.html#cb408-2" aria-hidden="true" tabindex="-1"></a>hvg<span class="fl">.416</span>b.var <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.spike<span class="fl">.416</span>b, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb408-3"><a href="selección-de-genes.html#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg<span class="fl">.416</span>b.var)</span></code></pre></div>
<pre><code>##  chr [1:1000] &quot;Lyz2&quot; &quot;Ccl9&quot; &quot;Top2a&quot; &quot;Cd200r3&quot; &quot;Ccnb2&quot; &quot;Gm10736&quot; &quot;Hbb-bt&quot; ...</code></pre>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="selección-de-genes.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also works with modelGeneCV2() but note `var.field`</span></span>
<span id="cb410-2"><a href="selección-de-genes.html#cb410-2" aria-hidden="true" tabindex="-1"></a>hvg.pbmc.cv2 <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.cv2.pbmc,</span>
<span id="cb410-3"><a href="selección-de-genes.html#cb410-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">var.field =</span> <span class="st">&quot;ratio&quot;</span>, <span class="at">n =</span> <span class="dv">1000</span></span>
<span id="cb410-4"><a href="selección-de-genes.html#cb410-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb410-5"><a href="selección-de-genes.html#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg.pbmc.cv2)</span></code></pre></div>
<pre><code>##  chr [1:1000] &quot;PPBP&quot; &quot;PRTFDC1&quot; &quot;HIST1H2AC&quot; &quot;FAM81B&quot; &quot;PF4&quot; &quot;GNG11&quot; ...</code></pre>
<div id="estrategias-para-seleccionar-x" class="section level4" number="7.13.1.1">
<h4><span class="header-section-number">7.13.1.1</span> Estrategias para seleccionar X</h4>
<p>Asume que, por ejemplo, no más del 5% de los genes están diferencialmente expresados entre las células de nuestra población:</p>
<ul>
<li><em>Establece X como el 5% de los genes</em></li>
</ul>
<p>Normalmente no conocemos el número de genes diferencialmente expresados desde antes, por lo tanto, solo hemos cambiado un número arbitrario por otro número arbitrario</p>
<p><strong>RECOMENDACIÓN</strong>: Si decides utilizar los top-X HGVs, elige un valor de X y procede con el resto del análisis con la intención de regresar más adelante y probar otros valores, en vez de dedicarle mucho esfuerzo a encontrar el valor óptimo</p>
</div>
</div>
<div id="seleccionando-hvgs-de-acuerdo-a-su-significancia-estadística" class="section level3" number="7.13.2">
<h3><span class="header-section-number">7.13.2</span> Seleccionando HVGs de acuerdo a su significancia estadística</h3>
<p>Establece un límite fijo en alguna métrica de significancia estadística. Por ejemplo: algunos de los métodos reportan un p-valor para cada gene, entonces selecciona todos los genes con un p-valor ajustado menor que 0.05</p>
<p><strong>Recuerda que las pruebas estadísticas siempre dependen del tamaño de la muestra</strong></p>
<p><strong>Ventajas:</strong>
* Fácil de implementar
* Menos predecible que la estrategia de los top-X</p>
<p><strong>Desventajas:</strong>
* Podría priorizar genes con significancia estadística fuerte en vez de significancia biológica fuerte</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="selección-de-genes.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with modelGeneVar() output</span></span>
<span id="cb412-2"><a href="selección-de-genes.html#cb412-2" aria-hidden="true" tabindex="-1"></a>hvg.pbmc.var<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.pbmc, <span class="at">fdr.threshold =</span> <span class="fl">0.05</span>)</span>
<span id="cb412-3"><a href="selección-de-genes.html#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg.pbmc.var<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  chr [1:813] &quot;LYZ&quot; &quot;S100A9&quot; &quot;S100A8&quot; &quot;HLA-DRA&quot; &quot;CD74&quot; &quot;CST3&quot; &quot;TYROBP&quot; ...</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="selección-de-genes.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with modelGeneVarWithSpikes() output</span></span>
<span id="cb414-2"><a href="selección-de-genes.html#cb414-2" aria-hidden="true" tabindex="-1"></a>hvg<span class="fl">.416</span>b.var<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.spike<span class="fl">.416</span>b,</span>
<span id="cb414-3"><a href="selección-de-genes.html#cb414-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fdr.threshold =</span> <span class="fl">0.05</span></span>
<span id="cb414-4"><a href="selección-de-genes.html#cb414-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb414-5"><a href="selección-de-genes.html#cb414-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg<span class="fl">.416</span>b.var<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  chr [1:2568] &quot;Lyz2&quot; &quot;Ccl9&quot; &quot;Top2a&quot; &quot;Cd200r3&quot; &quot;Ccnb2&quot; &quot;Gm10736&quot; &quot;Hbb-bt&quot; ...</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="selección-de-genes.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also works with modelGeneCV2() but note `var.field`</span></span>
<span id="cb416-2"><a href="selección-de-genes.html#cb416-2" aria-hidden="true" tabindex="-1"></a>hvg.pbmc.cv2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.cv2.pbmc,</span>
<span id="cb416-3"><a href="selección-de-genes.html#cb416-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">var.field =</span> <span class="st">&quot;ratio&quot;</span>, <span class="at">fdr.threshold =</span> <span class="fl">0.05</span></span>
<span id="cb416-4"><a href="selección-de-genes.html#cb416-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb416-5"><a href="selección-de-genes.html#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg.pbmc.cv2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  chr [1:1972] &quot;PPBP&quot; &quot;PRTFDC1&quot; &quot;HIST1H2AC&quot; &quot;FAM81B&quot; &quot;PF4&quot; &quot;GNG11&quot; ...</code></pre>
</div>
<div id="seleccionando-genes-por-arriba-de-la-tendencia-media-varianza" class="section level3" number="7.13.3">
<h3><span class="header-section-number">7.13.3</span> Seleccionando genes por arriba de la tendencia media-varianza</h3>
<p>Selecciona todos los genes con <strong>una varianza biológica positiva</strong></p>
<p>Este es un extremo del equilibrio sesgo-varianza que minimiza el sesgo con el costo de maximizar el ruido</p>
<p>Si seguimos esta aproximación, estamos:</p>
<ul>
<li>Dándole a la estructura secundaria de la población una oportunidad de manifestarse</li>
<li>Capturando más ruido, lo cual puede reducir la resolución de poblaciones bien separadas enmascarando la señal secundaria que intentamos preservar</li>
</ul>
<p>Funciona mejor si tenemos datasets altamente heterogeneos que contienen muchos tipos celulares diferentes</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="selección-de-genes.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with modelGeneVar() output</span></span>
<span id="cb418-2"><a href="selección-de-genes.html#cb418-2" aria-hidden="true" tabindex="-1"></a>hvg.pbmc.var<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.pbmc, <span class="at">var.threshold =</span> <span class="dv">0</span>)</span>
<span id="cb418-3"><a href="selección-de-genes.html#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg.pbmc.var<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  chr [1:12745] &quot;LYZ&quot; &quot;S100A9&quot; &quot;S100A8&quot; &quot;HLA-DRA&quot; &quot;CD74&quot; &quot;CST3&quot; &quot;TYROBP&quot; ...</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="selección-de-genes.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Works with modelGeneVarWithSpikes() output</span></span>
<span id="cb420-2"><a href="selección-de-genes.html#cb420-2" aria-hidden="true" tabindex="-1"></a>hvg<span class="fl">.416</span>b.var<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.spike<span class="fl">.416</span>b,</span>
<span id="cb420-3"><a href="selección-de-genes.html#cb420-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">var.threshold =</span> <span class="dv">0</span></span>
<span id="cb420-4"><a href="selección-de-genes.html#cb420-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb420-5"><a href="selección-de-genes.html#cb420-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg<span class="fl">.416</span>b.var<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  chr [1:11087] &quot;Lyz2&quot; &quot;Ccl9&quot; &quot;Top2a&quot; &quot;Cd200r3&quot; &quot;Ccnb2&quot; &quot;Gm10736&quot; &quot;Hbb-bt&quot; ...</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="selección-de-genes.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also works with modelGeneCV2() but note `var.field` and</span></span>
<span id="cb422-2"><a href="selección-de-genes.html#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="co"># value of `var.threshold`</span></span>
<span id="cb422-3"><a href="selección-de-genes.html#cb422-3" aria-hidden="true" tabindex="-1"></a>hvg.pbmc.cv2<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.cv2.pbmc,</span>
<span id="cb422-4"><a href="selección-de-genes.html#cb422-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">var.field =</span> <span class="st">&quot;ratio&quot;</span>, <span class="at">var.threshold =</span> <span class="dv">1</span></span>
<span id="cb422-5"><a href="selección-de-genes.html#cb422-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb422-6"><a href="selección-de-genes.html#cb422-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(hvg.pbmc.cv2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  chr [1:1972] &quot;PPBP&quot; &quot;PRTFDC1&quot; &quot;HIST1H2AC&quot; &quot;FAM81B&quot; &quot;PF4&quot; &quot;GNG11&quot; ...</code></pre>
</div>
<div id="ejercicio-dibujando-los-hvgs" class="section level3" number="7.13.4">
<h3><span class="header-section-number">7.13.4</span> EJERCICIO: Dibujando los HVGs</h3>
<p>Para este ejercicio tendrás que repetir la gráfica que muestra la tendencia de la relación media-varianza (ejeX: media de la expresión, ejeY: varianza de la expresión) incluyendo la línea de tendencia obtenida con alguna de las funciones vistas en la primer parte de la clase (modelGeneVar, modelGeneVarWithSpikes, modelGeneCV2). En esta gráfica, deberás colorear los puntos que corresponden a los HGVs obtenidos con algunos de los enfoques revisados</p>
<p><strong>RESPUESTA</strong></p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="selección-de-genes.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.pbmc<span class="sc">$</span>mean, fit.pbmc<span class="sc">$</span>var,</span>
<span id="cb424-2"><a href="selección-de-genes.html#cb424-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Mean of log-expression&quot;</span>,</span>
<span id="cb424-3"><a href="selección-de-genes.html#cb424-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Variance of log-expression&quot;</span></span>
<span id="cb424-4"><a href="selección-de-genes.html#cb424-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb424-5"><a href="selección-de-genes.html#cb424-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(fit.pbmc<span class="sc">$</span>mean[hvg.pbmc.var], fit.pbmc<span class="sc">$</span>var[hvg.pbmc.var], <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb424-6"><a href="selección-de-genes.html#cb424-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(fit.pbmc<span class="sc">$</span><span class="fu">trend</span>(x), <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="07-seleccion_genes_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="seleccionando-genes-de-interés-a-priori" class="section level3" number="7.13.5">
<h3><span class="header-section-number">7.13.5</span> Seleccionando genes de interés <em>a priori</em></h3>
<p>Una estrategia contundente es usar sets predefinidos de genes de interés. No hay vergüenza en aprovechar el conocimiento biológivo previo</p>
<p>Sin embargo, limita nuestra capacidad de descubrir aspectos nuevos o inesperados de la variación. Por lo tanto, considera esta como una estrategia complementaria a otros tipo de estrategias de selección de HGVs</p>
<p>También podrías eliminar listas pre-definidas de genes:</p>
<ul>
<li>Genes de proteínas ribosomales o genes mitocondriales son conocidos por encontrarse dentro de los genes <em>más variables</em> y por interferir con análisis posteriores</li>
</ul>
<p>Sin embargo, tampoco hay que pecar de prevacido, espera a que estos genes demuestren ser problemáticos para removerlos</p>
</div>
</div>
<div id="poniendo-todo-junto" class="section level2" number="7.14">
<h2><span class="header-section-number">7.14</span> Poniendo todo junto</h2>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="selección-de-genes.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elegimos el 10% de los genes con con componente biologico de variacion mayor</span></span>
<span id="cb425-2"><a href="selección-de-genes.html#cb425-2" aria-hidden="true" tabindex="-1"></a>dec.pbmc <span class="ot">&lt;-</span> <span class="fu">modelGeneVar</span>(sce.pbmc)</span>
<span id="cb425-3"><a href="selección-de-genes.html#cb425-3" aria-hidden="true" tabindex="-1"></a>chosen <span class="ot">&lt;-</span> <span class="fu">getTopHVGs</span>(dec.pbmc, <span class="at">prop =</span> <span class="fl">0.1</span>)</span>
<span id="cb425-4"><a href="selección-de-genes.html#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(chosen)</span></code></pre></div>
<pre><code>##  chr [1:1274] &quot;LYZ&quot; &quot;S100A9&quot; &quot;S100A8&quot; &quot;HLA-DRA&quot; &quot;CD74&quot; &quot;CST3&quot; &quot;TYROBP&quot; ...</code></pre>
<p>Después de esto tenemos varias opciones para imponer nuestra selección de HGVs durante el resto del análisis:</p>
<ol style="list-style-type: decimal">
<li>Hacer un subset de SCE para quedarnos únicamente con los HGVs</li>
<li>Especificar los HGVs en funciones posteriores</li>
<li>Magia (altExps)</li>
</ol>
<div id="quedándonos-sólo-con-los-hgvs" class="section level3" number="7.14.1">
<h3><span class="header-section-number">7.14.1</span> Quedándonos sólo con los HGVs</h3>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="selección-de-genes.html#cb427-1" aria-hidden="true" tabindex="-1"></a>sce.pbmc.hvg <span class="ot">&lt;-</span> sce.pbmc[chosen, ]</span>
<span id="cb427-2"><a href="selección-de-genes.html#cb427-2" aria-hidden="true" tabindex="-1"></a>sce.pbmc.hvg</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 1274 3985 
## metadata(1): Samples
## assays(2): counts logcounts
## rownames(1274): LYZ S100A9 ... TNNT1 TMEM55A
## rowData names(2): ID Symbol
## colnames(3985): AAACCTGAGAAGGCCT-1 AAACCTGAGACAGACC-1 ...
##   TTTGTCAGTTAAGACA-1 TTTGTCATCCCAAGAT-1
## colData names(3): Sample Barcode sizeFactor
## reducedDimNames(0):
## mainExpName: NULL
## altExpNames(0):</code></pre>
<p><strong>PRO:</strong> Te aseguras de que los métodos posteriores <strong>sólo</strong> usen estos genes para sus cálculos</p>
<p><strong>CONTRA:</strong> Los genes no-HGVs son eliminados del nuevo objeto <em>SingleCellExperiment</em>, lo cual hace menos conveniente la interrogación del dataset completo sobre genes que no son HGVs</p>
</div>
<div id="especificando-los-hgvs" class="section level3" number="7.14.2">
<h3><span class="header-section-number">7.14.2</span> Especificando los HGVs</h3>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="selección-de-genes.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of specifying HVGs in a downstream function</span></span>
<span id="cb429-2"><a href="selección-de-genes.html#cb429-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing PCA only on the chosen HVGs.</span></span>
<span id="cb429-3"><a href="selección-de-genes.html#cb429-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scater)</span>
<span id="cb429-4"><a href="selección-de-genes.html#cb429-4" aria-hidden="true" tabindex="-1"></a>sce.pbmc <span class="ot">&lt;-</span> <span class="fu">runPCA</span>(sce.pbmc, <span class="at">subset_row =</span> chosen)</span>
<span id="cb429-5"><a href="selección-de-genes.html#cb429-5" aria-hidden="true" tabindex="-1"></a>sce.pbmc</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 33694 3985 
## metadata(1): Samples
## assays(2): counts logcounts
## rownames(33694): RP11-34P13.3 FAM138A ... AC213203.1 FAM231B
## rowData names(2): ID Symbol
## colnames(3985): AAACCTGAGAAGGCCT-1 AAACCTGAGACAGACC-1 ...
##   TTTGTCAGTTAAGACA-1 TTTGTCATCCCAAGAT-1
## colData names(3): Sample Barcode sizeFactor
## reducedDimNames(1): PCA
## mainExpName: NULL
## altExpNames(0):</code></pre>
<p>Mantiene el objeto <em>SingleCellExperiment</em> original y especifica los genes para usar en funciones posteriores mediante un argumento adicional como <strong>subset_row</strong></p>
<p><strong>PRO:</strong> Es útil si el análisis usa varios conjuntos de HGVs en diferentes pasos</p>
<p><strong>CONTRA:</strong> Podría ser inconveniente especificar repetidamente el mismo conjunto de HGVs en diferentes pasos</p>
</div>
<div id="witchcraft-brujería" class="section level3" number="7.14.3">
<h3><span class="header-section-number">7.14.3</span> Witchcraft (Brujería)</h3>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="selección-de-genes.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the full SCE to the subsetted data SCE</span></span>
<span id="cb431-2"><a href="selección-de-genes.html#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="fu">altExp</span>(sce.pbmc.hvg, <span class="st">&quot;original&quot;</span>) <span class="ot">&lt;-</span> sce.pbmc</span>
<span id="cb431-3"><a href="selección-de-genes.html#cb431-3" aria-hidden="true" tabindex="-1"></a>sce.pbmc.hvg</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 1274 3985 
## metadata(1): Samples
## assays(2): counts logcounts
## rownames(1274): LYZ S100A9 ... TNNT1 TMEM55A
## rowData names(2): ID Symbol
## colnames(3985): AAACCTGAGAAGGCCT-1 AAACCTGAGACAGACC-1 ...
##   TTTGTCAGTTAAGACA-1 TTTGTCATCCCAAGAT-1
## colData names(3): Sample Barcode sizeFactor
## reducedDimNames(0):
## mainExpName: NULL
## altExpNames(1): original</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="selección-de-genes.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">altExp</span>(sce.pbmc.hvg, <span class="st">&quot;original&quot;</span>)</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 33694 3985 
## metadata(1): Samples
## assays(2): counts logcounts
## rownames(33694): RP11-34P13.3 FAM138A ... AC213203.1 FAM231B
## rowData names(2): ID Symbol
## colnames(3985): AAACCTGAGAAGGCCT-1 AAACCTGAGACAGACC-1 ...
##   TTTGTCAGTTAAGACA-1 TTTGTCATCCCAAGAT-1
## colData names(3): Sample Barcode sizeFactor
## reducedDimNames(1): PCA
## mainExpName: NULL
## altExpNames(0):</code></pre>
<p>Utilizando el sistema de “experimento alternartivo” en la clase <em>SingleCellExperiment</em></p>
<p><strong>PRO:</strong> Evita algunos problemas a largo plazo cuando el dataset original no está sincronizado con el conjunto filtrado por HVGs</p>
<p><strong>CONTRA:</strong> Ralentiza todos los análisis subsecuentes</p>
</div>
</div>
<div id="resumen-y-recomendaciones" class="section level2" number="7.15">
<h2><span class="header-section-number">7.15</span> Resumen y recomendaciones</h2>
<ul>
<li>Es fácil atorarse en este paso debido a la variedad de opciones disponibles</li>
<li>Elige un conjunto de HVGs y continúa con el análisis, <strong>recuerda regresar para probar la robustez de tus resultados usando una forma diferente para seleccionar los HVGs</strong></li>
<li>Si tienes spike-ins, trata de usarlos. No obstante, recuerda que los spike-ins no pueden capturar todas las fuentes de variación técnica</li>
</ul>
</div>
<div id="recomendaciones-para-empezar" class="section level2" number="7.16">
<h2><span class="header-section-number">7.16</span> Recomendaciones para empezar</h2>
<p>Para CEL-Seq2:</p>
<ul>
<li><code>scran::modelGeneVarWithSpikes()</code></li>
</ul>
<p>Para 10X:</p>
<ul>
<li><code>scran::modelGeneVarByPoisson()</code></li>
</ul>
<p>Si quieres irte por el lado de conservar demasiados genes:</p>
<ul>
<li><code>scran::getTopHVGs(dec, var.threshold=0)</code></li>
</ul>
<p>Y realiza una comparación rápida con, por lo menos, el top-1000 HVGs</p>
<p>Regresa al paso de selección de HVG para <strong>eliminar genes problemáticos</strong> tantas veces como sea necesario</p>
</div>
<div id="detalles-de-la-sesión-de-r-6" class="section level2" number="7.17">
<h2><span class="header-section-number">7.17</span> Detalles de la sesión de R</h2>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="selección-de-genes.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Información de la sesión de R</span></span>
<span id="cb435-2"><a href="selección-de-genes.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2021-08-13 19:07:05 UTC&quot;</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="selección-de-genes.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proc.time</span>()</span></code></pre></div>
<pre><code>##    user  system elapsed 
## 164.936   4.620 173.053</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="selección-de-genes.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">120</span>)</span>
<span id="cb439-2"><a href="selección-de-genes.html#cb439-2" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
##  setting  value                       
##  version  R version 4.1.0 (2021-05-18)
##  os       Ubuntu 20.04.2 LTS          
##  system   x86_64, linux-gnu           
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  ctype    en_US.UTF-8                 
##  tz       UTC                         
##  date     2021-08-13                  
## 
## ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
##  package                * version  date       lib source        
##  AnnotationDbi          * 1.54.1   2021-06-08 [1] Bioconductor  
##  AnnotationFilter       * 1.16.0   2021-05-19 [1] Bioconductor  
##  AnnotationHub          * 3.0.1    2021-06-20 [1] Bioconductor  
##  assertthat               0.2.1    2019-03-21 [1] RSPM (R 4.1.0)
##  beachmat                 2.8.0    2021-05-19 [1] Bioconductor  
##  beeswarm                 0.4.0    2021-06-01 [1] RSPM (R 4.1.0)
##  Biobase                * 2.52.0   2021-05-19 [1] Bioconductor  
##  BiocFileCache          * 2.0.0    2021-05-19 [1] Bioconductor  
##  BiocGenerics           * 0.38.0   2021-05-19 [1] Bioconductor  
##  BiocIO                   1.2.0    2021-05-19 [1] Bioconductor  
##  BiocManager              1.30.16  2021-06-15 [1] RSPM (R 4.1.0)
##  BiocNeighbors            1.10.0   2021-05-19 [1] Bioconductor  
##  BiocParallel             1.26.1   2021-07-04 [1] Bioconductor  
##  BiocSingular             1.8.1    2021-06-08 [1] Bioconductor  
##  BiocVersion              3.13.1   2021-03-19 [2] Bioconductor  
##  biomaRt                  2.48.2   2021-07-01 [1] Bioconductor  
##  Biostrings               2.60.2   2021-08-05 [1] Bioconductor  
##  bit                      4.0.4    2020-08-04 [1] RSPM (R 4.1.0)
##  bit64                    4.0.5    2020-08-30 [1] RSPM (R 4.1.0)
##  bitops                   1.0-7    2021-04-24 [1] RSPM (R 4.1.0)
##  blob                     1.2.2    2021-07-23 [1] RSPM (R 4.1.0)
##  bluster                  1.2.1    2021-05-27 [1] Bioconductor  
##  bookdown                 0.22     2021-04-22 [1] RSPM (R 4.1.0)
##  bslib                    0.2.5.1  2021-05-18 [1] RSPM (R 4.1.0)
##  cachem                   1.0.5    2021-05-15 [2] RSPM (R 4.1.0)
##  cli                      3.0.1    2021-07-17 [2] RSPM (R 4.1.0)
##  cluster                  2.1.2    2021-04-17 [3] CRAN (R 4.1.0)
##  colorspace               2.0-2    2021-06-24 [1] RSPM (R 4.1.0)
##  crayon                   1.4.1    2021-02-08 [2] RSPM (R 4.1.0)
##  curl                     4.3.2    2021-06-23 [2] RSPM (R 4.1.0)
##  DBI                      1.1.1    2021-01-15 [1] RSPM (R 4.1.0)
##  dbplyr                 * 2.1.1    2021-04-06 [1] RSPM (R 4.1.0)
##  DelayedArray             0.18.0   2021-05-19 [1] Bioconductor  
##  DelayedMatrixStats       1.14.2   2021-08-08 [1] Bioconductor  
##  digest                   0.6.27   2020-10-24 [2] RSPM (R 4.1.0)
##  dplyr                    1.0.7    2021-06-18 [1] RSPM (R 4.1.0)
##  dqrng                    0.3.0    2021-05-01 [1] RSPM (R 4.1.0)
##  DropletUtils           * 1.12.2   2021-07-22 [1] Bioconductor  
##  edgeR                    3.34.0   2021-05-19 [1] Bioconductor  
##  ellipsis                 0.3.2    2021-04-29 [2] RSPM (R 4.1.0)
##  EnsDb.Hsapiens.v86     * 2.99.0   2021-07-29 [1] Bioconductor  
##  ensembldb              * 2.16.4   2021-08-05 [1] Bioconductor  
##  evaluate                 0.14     2019-05-28 [2] RSPM (R 4.1.0)
##  ExperimentHub            2.0.0    2021-05-19 [1] Bioconductor  
##  fansi                    0.5.0    2021-05-25 [2] RSPM (R 4.1.0)
##  fastmap                  1.1.0    2021-01-25 [2] RSPM (R 4.1.0)
##  filelock                 1.0.2    2018-10-05 [1] RSPM (R 4.1.0)
##  generics                 0.1.0    2020-10-31 [1] RSPM (R 4.1.0)
##  GenomeInfoDb           * 1.28.1   2021-07-01 [1] Bioconductor  
##  GenomeInfoDbData         1.2.6    2021-07-29 [1] Bioconductor  
##  GenomicAlignments        1.28.0   2021-05-19 [1] Bioconductor  
##  GenomicFeatures        * 1.44.0   2021-05-19 [1] Bioconductor  
##  GenomicRanges          * 1.44.0   2021-05-19 [1] Bioconductor  
##  ggbeeswarm               0.6.0    2017-08-07 [1] RSPM (R 4.1.0)
##  ggplot2                * 3.3.5    2021-06-25 [1] RSPM (R 4.1.0)
##  glue                     1.4.2    2020-08-27 [2] RSPM (R 4.1.0)
##  gridExtra                2.3      2017-09-09 [1] RSPM (R 4.1.0)
##  gtable                   0.3.0    2019-03-25 [1] RSPM (R 4.1.0)
##  HDF5Array                1.20.0   2021-05-19 [1] Bioconductor  
##  highr                    0.9      2021-04-16 [2] RSPM (R 4.1.0)
##  hms                      1.1.0    2021-05-17 [1] RSPM (R 4.1.0)
##  htmltools                0.5.1.1  2021-01-22 [1] RSPM (R 4.1.0)
##  httpuv                   1.6.1    2021-05-07 [1] RSPM (R 4.1.0)
##  httr                     1.4.2    2020-07-20 [2] RSPM (R 4.1.0)
##  igraph                   1.2.6    2020-10-06 [1] RSPM (R 4.1.0)
##  interactiveDisplayBase   1.30.0   2021-05-19 [1] Bioconductor  
##  IRanges                * 2.26.0   2021-05-19 [1] Bioconductor  
##  irlba                    2.3.3    2019-02-05 [1] RSPM (R 4.1.0)
##  jquerylib                0.1.4    2021-04-26 [1] RSPM (R 4.1.0)
##  jsonlite                 1.7.2    2020-12-09 [2] RSPM (R 4.1.0)
##  KEGGREST                 1.32.0   2021-05-19 [1] Bioconductor  
##  knitr                    1.33     2021-04-24 [2] RSPM (R 4.1.0)
##  later                    1.2.0    2021-04-23 [1] RSPM (R 4.1.0)
##  lattice                  0.20-44  2021-05-02 [3] CRAN (R 4.1.0)
##  lazyeval                 0.2.2    2019-03-15 [1] RSPM (R 4.1.0)
##  lifecycle                1.0.0    2021-02-15 [2] RSPM (R 4.1.0)
##  limma                    3.48.3   2021-08-10 [1] Bioconductor  
##  locfit                   1.5-9.4  2020-03-25 [1] RSPM (R 4.1.0)
##  magrittr                 2.0.1    2020-11-17 [2] RSPM (R 4.1.0)
##  Matrix                 * 1.3-4    2021-06-01 [3] RSPM (R 4.1.0)
##  MatrixGenerics         * 1.4.2    2021-08-08 [1] Bioconductor  
##  matrixStats            * 0.60.0   2021-07-26 [1] RSPM (R 4.1.0)
##  memoise                  2.0.0    2021-01-26 [2] RSPM (R 4.1.0)
##  metapod                  1.0.0    2021-05-19 [1] Bioconductor  
##  mime                     0.11     2021-06-23 [2] RSPM (R 4.1.0)
##  munsell                  0.5.0    2018-06-12 [1] RSPM (R 4.1.0)
##  pillar                   1.6.2    2021-07-29 [2] RSPM (R 4.1.0)
##  pkgconfig                2.0.3    2019-09-22 [2] RSPM (R 4.1.0)
##  png                      0.1-7    2013-12-03 [1] RSPM (R 4.1.0)
##  prettyunits              1.1.1    2020-01-24 [2] RSPM (R 4.1.0)
##  progress                 1.2.2    2019-05-16 [1] RSPM (R 4.1.0)
##  promises                 1.2.0.1  2021-02-11 [1] RSPM (R 4.1.0)
##  ProtGenerics             1.24.0   2021-05-19 [1] Bioconductor  
##  purrr                    0.3.4    2020-04-17 [2] RSPM (R 4.1.0)
##  R.methodsS3              1.8.1    2020-08-26 [1] RSPM (R 4.1.0)
##  R.oo                     1.24.0   2020-08-26 [1] RSPM (R 4.1.0)
##  R.utils                  2.10.1   2020-08-26 [1] RSPM (R 4.1.0)
##  R6                       2.5.0    2020-10-28 [2] RSPM (R 4.1.0)
##  rappdirs                 0.3.3    2021-01-31 [2] RSPM (R 4.1.0)
##  Rcpp                     1.0.7    2021-07-07 [2] RSPM (R 4.1.0)
##  RCurl                    1.98-1.3 2021-03-16 [1] RSPM (R 4.1.0)
##  restfulr                 0.0.13   2017-08-06 [1] RSPM (R 4.1.0)
##  rhdf5                    2.36.0   2021-05-19 [1] Bioconductor  
##  rhdf5filters             1.4.0    2021-05-19 [1] Bioconductor  
##  Rhdf5lib                 1.14.2   2021-07-06 [1] Bioconductor  
##  rjson                    0.2.20   2018-06-08 [1] RSPM (R 4.1.0)
##  rlang                    0.4.11   2021-04-30 [2] RSPM (R 4.1.0)
##  rmarkdown                2.10     2021-08-06 [1] RSPM (R 4.1.0)
##  Rsamtools                2.8.0    2021-05-19 [1] Bioconductor  
##  RSQLite                  2.2.7    2021-04-22 [1] RSPM (R 4.1.0)
##  rsvd                     1.0.5    2021-04-16 [1] RSPM (R 4.1.0)
##  rtracklayer              1.52.0   2021-05-19 [1] Bioconductor  
##  S4Vectors              * 0.30.0   2021-05-19 [1] Bioconductor  
##  sass                     0.4.0    2021-05-12 [1] RSPM (R 4.1.0)
##  ScaledMatrix             1.0.0    2021-05-19 [1] Bioconductor  
##  scales                   1.1.1    2020-05-11 [1] RSPM (R 4.1.0)
##  scater                 * 1.20.1   2021-06-15 [1] Bioconductor  
##  scran                  * 1.20.1   2021-05-24 [1] Bioconductor  
##  scRNAseq               * 2.6.1    2021-05-25 [1] Bioconductor  
##  scuttle                * 1.2.1    2021-08-05 [1] Bioconductor  
##  sessioninfo              1.1.1    2018-11-05 [2] RSPM (R 4.1.0)
##  shiny                    1.6.0    2021-01-25 [1] RSPM (R 4.1.0)
##  SingleCellExperiment   * 1.14.1   2021-05-21 [1] Bioconductor  
##  sparseMatrixStats        1.4.2    2021-08-08 [1] Bioconductor  
##  statmod                  1.4.36   2021-05-10 [1] RSPM (R 4.1.0)
##  stringi                  1.7.3    2021-07-16 [2] RSPM (R 4.1.0)
##  stringr                  1.4.0    2019-02-10 [2] RSPM (R 4.1.0)
##  SummarizedExperiment   * 1.22.0   2021-05-19 [1] Bioconductor  
##  tibble                   3.1.3    2021-07-23 [2] RSPM (R 4.1.0)
##  tidyselect               1.1.1    2021-04-30 [1] RSPM (R 4.1.0)
##  utf8                     1.2.2    2021-07-24 [2] RSPM (R 4.1.0)
##  vctrs                    0.3.8    2021-04-29 [2] RSPM (R 4.1.0)
##  vipor                    0.4.5    2017-03-22 [1] RSPM (R 4.1.0)
##  viridis                  0.6.1    2021-05-11 [1] RSPM (R 4.1.0)
##  viridisLite              0.4.0    2021-04-13 [1] RSPM (R 4.1.0)
##  withr                    2.4.2    2021-04-18 [2] RSPM (R 4.1.0)
##  xfun                     0.25     2021-08-06 [2] RSPM (R 4.1.0)
##  XML                      3.99-0.6 2021-03-16 [1] RSPM (R 4.1.0)
##  xml2                     1.3.2    2020-04-23 [2] RSPM (R 4.1.0)
##  xtable                   1.8-4    2019-04-21 [1] RSPM (R 4.1.0)
##  XVector                  0.32.0   2021-05-19 [1] Bioconductor  
##  yaml                     2.2.1    2020-02-01 [2] RSPM (R 4.1.0)
##  zlibbioc                 1.38.0   2021-05-19 [1] Bioconductor  
## 
## [1] /__w/_temp/Library
## [2] /usr/local/lib/R/site-library
## [3] /usr/local/lib/R/library</code></pre>
</div>
<div id="patrocinadores-7" class="section level2 unnumbered">
<h2>Patrocinadores</h2>
<p>Agradecemos a nuestros patrocinadores:</p>
<p><a href="https://comunidadbioinfo.github.io/es/post/cs_and_s_event_fund_award/#.YJH-wbVKj8A"><img src="https://comunidadbioinfo.github.io/post/2021-01-27-cs_and_s_event_fund_award/spanish_cs_and_s_award.jpeg" width="400px" align="center"/></a></p>
<p><a href="https://www.r-consortium.org/"><img src="https://www.r-consortium.org/wp-content/uploads/sites/13/2016/09/RConsortium_Horizontal_Pantone.png" width="400px" align="center"/></a></p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>Zheng, G. X. Y. et al. Massively parallel digital transcriptional profiling of single cells. Nat. Commun. 8, 14049 (2017).<a href="selección-de-genes.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>Usando Ensembl v86 para humano<a href="selección-de-genes.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>Usamos los resultados de <code>emptyDrops()</code> con un límite de 0.1% FDR y el filtro de 3 desviaciones sobre la mediana (MAD) en la expresión mitocondrial.<a href="selección-de-genes.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>Encontramos unos clusters rápidos para las célulasy usamos esa información para calcular los factores de tamaño.<a href="selección-de-genes.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Lun, A. T. L., Calero-Nieto, F. J., Haim-Vilmovsky, L., Göttgens, B. &amp; Marioni, J. C. Assessing the reliability of spike-in normalization for analyses of single-cell RNA sequencing data. Genome Res. 27, 1795–1806 (2017)).<a href="selección-de-genes.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Es un <code>DFrame</code><a href="selección-de-genes.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>No, contiene más información dentro de <code>metadata(dec.pbmc)</code><a href="selección-de-genes.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p><code>class(metadata(dec.pbmc))</code> y <code>sapply(metadata(dec.pbmc), class)</code><a href="selección-de-genes.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Una función<a href="selección-de-genes.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Checa <code>?fitTrendVar</code> y si quieres también checa el código fuente (para mí es muy útil este paso) <a href="https://github.com/MarioniLab/scran/blob/master/R/fitTrendVar.R" class="uri">https://github.com/MarioniLab/scran/blob/master/R/fitTrendVar.R</a><a href="selección-de-genes.html#fnref20" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="normalización-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reducción-de-dimensiones.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
